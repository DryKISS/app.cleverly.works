"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3762],{16951:function(n,e,t){t.d(e,{k:function(){return Z}});var i=t(26042),r=t(69396),o=t(85893),a=t(45697),s=t(42283),c=t(79665),d=t(76600),u=t(9270),l=t(62140),m=t(49501),p=t(55563),f=t(6710),y=t(95103),g=t(16310),h=(0,g.Ry)().shape({name:(0,g.Z_)(),invoicingEntity:(0,g.Z_)(),addressLine1:(0,g.Z_)().required(),addressLine2:(0,g.Z_)(),addressLine3:(0,g.Z_)(),city:(0,g.Z_)().required(),postCode:(0,g.Z_)().matches("^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9][A-Za-z]?))))\\s?[0-9][A-Za-z]{2})$|^([AC-FHKNPRTV-Y]\\d{2}|D6W)\\s[0-9AC-FHKNPRTV-Y]{4}$").required(),county:(0,g.Z_)(),countryId:(0,g.Z_)().required()}),v=t(31113),x=t(98521),Z=function(n){var e=n.defaultValues,t=n.onSubmit,a=n.type,g=(0,s.cI)({defaultValues:(0,i.Z)({},e),resolver:(0,c.S)(h)}),Z=g.control,b=g.errors,j=g.handleSubmit,_={control:Z,errors:b,register:g.register};return(0,o.jsxs)(d.Z,{id:"offCanvasForm",handleSubmit:j(t),children:[(0,o.jsxs)(u.Z,{children:[(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(m.Z,{label:"Address name",children:(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"name"}))})}),"invoice"===a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(m.Z,{label:"invoicing email",children:(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"invoicingEmail",type:"email"}))})}),(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(m.Z,{label:"Invoicing entity",children:(0,o.jsx)(f.Z,(0,r.Z)((0,i.Z)({},_),{name:"invoicingEntity",rows:4}))})})]}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(m.Z,{label:"Address Line 1",children:(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"addressLine1"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(m.Z,{label:"Address Line 2",children:(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"addressLine2"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(m.Z,{label:"Address Line 3",children:(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"addressLine3"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(m.Z,{label:"City",children:(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"city"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(m.Z,{label:"Post Code",children:(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"postCode"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(m.Z,{label:"County",children:(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"county"}))})}),(0,o.jsx)(l.Z,{md:6,children:(0,o.jsx)(m.Z,{label:"Country",children:(0,o.jsx)(y.Z,(0,r.Z)((0,i.Z)({},_),{name:"countryId",options:x.O}))})})]}),(0,o.jsx)(u.Z,{justify:"end",children:(0,o.jsx)(l.Z,{md:12,children:(0,o.jsx)(v.H,{content:"Submit",type:"submit"})})}),(null==e?void 0:e.id)&&(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"id",type:"hidden"})),(null==e?void 0:e.meta)&&(0,o.jsx)(p.Z,(0,r.Z)((0,i.Z)({},_),{name:"meta",type:"hidden"}))]})};Z.propTypes={defaultValues:a.object,onCancel:a.func.isRequired,onSubmit:a.func.isRequired,type:a.string}},32791:function(n,e,t){t.d(e,{H:function(){return q}});var i=t(47568),r=t(14924),o=t(828),a=t(29815),s=t(97582),c=t(85893),d=t(67294),u=t(45697),l=t(6812),m=t(50319),p=t(22666),f=t(33006),y=t(15214),g=t(26042),h=t(68956),v=t(49501),x=t(62047),Z=t(51466),b=t(2931),j=t(55843),_=t(16540),I=t(31113),A=t(16951),w=t(74492),$=function(n){var e,t=n.addresses,r=n.entity,a=n.entityId,u=(n.id,n.loading),l=n.onSelected,f=n.refetch,y=n.selectable,$=n.selected,C=n.type,S=n.editable,q=(0,w.a)(),P=(0,d.useState)(1),L=P[0],N=P[1],U=(0,o.Z)((0,m.D)(p.BO,{onCompleted:function(){q.close(),f()}}),1)[0],k=(0,o.Z)((0,m.D)(p._r,{onCompleted:function(){q.close(),f()}}),1)[0],M=function(n,e){l(n,e)},T=(e=(0,i.Z)(function(n){var e,t,i,o,c;return(0,s.__generator)(this,function(s){switch(s.label){case 0:return(e=n).countryId||(e.countryId=1),t={address:e},[4,window.fetch("".concat("https://aws.cleverly.works","/google/maps/geocode"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(t)}).then(function(n){return n.json()})];case 1:if(i=s.sent(),n.id?e.meta=(0,g.Z)({invoicingEmail:n.invoicingEmail},n.meta):e.meta={invoicingEmail:n.invoicingEmail},delete e.invoicingEmail,(null==(o=(null==i?void 0:i.coordinates)||null)?void 0:o.lat)&&(null==o?void 0:o.lng)&&(e.geo={type:"Point",coordinates:[o.lng,o.lat]}),!n.id)return[3,3];return c=parseInt(n.id),[4,k({variables:{id:c,changes:e}})];case 2:return s.sent(),[3,5];case 3:return e.Address_Entities={data:{entity:r,entityId:a,status:"active"}},[4,U({variables:{objects:[e]}})];case 4:s.sent(),s.label=5;case 5:return[2]}})}),function(n){return e.apply(this,arguments)}),R=function(n){q.close()},z=function(n){var e,i={},r=t.find(function(e){return e.id===n.id}),o=r?r.address:null;o&&(i.id=o.id,i.invoicingEmail=null===(e=o.meta)||void 0===e?void 0:e.invoicingEmail,i.invoicingEntity=o.invoicingEntity,i.name=o.name,i.addressLine1=o.addressLine1,i.addressLine2=o.addressLine2,i.addressLine3=o.addressLine3,i.city=o.city,i.postCode=o.postCode,i.county=o.county,i.countryId=o.countryId),q.show({content:(0,c.jsx)(A.k,{defaultValues:i,onCancel:R,onSubmit:T,type:C}),title:o?"Edit address":"invoice"===C?"Add new invoice address":"Add new address",submit:!1})},E=[{hidden:!0},{hidden:!y||!S,text:"Select"},{text:"Address"},{hidden:"invoice"!==C,text:"Email"},{formatter:h.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:function(n,e){return z(e)},tooltip:"Edit"}],text:"Actions",hidden:!S}],F=(null==t?void 0:t.map(function(n,e){var t,i=n.address;return{id:n.id,select:function(){return(0,c.jsx)(v.Z,{children:(0,c.jsx)(x.Z,{context:"secondary",onToggle:function(n){return M(i.id,n)},size:"sm",toggled:Number($)===i.id})})},address:function(){var n;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Z.Z,{content:null==i?void 0:i.name,size:"md"}),(0,c.jsx)(b.Z,{country:(null===(n=i.country)||void 0===n?void 0:n.name)||"",line1:i.addressLine1,town:i.city})]})},email:(null===(t=i.meta)||void 0===t?void 0:t.invoicingEmail)||"-",actions:""}}))||[];return(0,c.jsxs)(c.Fragment,{children:[S&&(0,c.jsx)(I.H,{content:"Add new address",handleClick:z}),(0,c.jsx)(j.Z,{marginBottom:"xs"}),(0,c.jsx)(_.Z,{columns:E,loading:u,pagination:!0,paginationProps:{currentPage:L,onPageChange:function(n){N(n)},onPageSizeChange:function(){},pageCount:Math.ceil((null==F?void 0:F.length)/50),perPage:50},rows:null==F?void 0:F.slice((L-1)*50,50*L)})]})};$.propTypes={addresses:u.array.isRequired,entity:u.string.isRequired,entityId:u.number.isRequired,id:u.number,loading:u.bool.isRequired,onSelected:u.func.isRequired,refetch:u.func.isRequired,selectable:u.bool.isRequired,selected:u.number,type:u.string},$.defaultProps={addresses:[],selectable:!1,selected:""};var C=t(26535),S=t(74944),q=function(n){var e,t,u,g,h=n.addressId,v=n.entity,x=n.entityId,Z=n.id,b=n.onSubmit,j=n.type,_=(0,d.useState)(h||null),I=_[0],A=_[1],w=(0,d.useState)(!1),q=w[0],P=w[1],L=(0,d.useState)(null),N=L[0],U=L[1],k=(0,C.DM)(j),M=(0,C.VJ)(v),T=(0,(0,S.x)().hasRole)("customer"),R=(0,l.a)(M,{variables:{id:x}}),z=R.loading,E=R.data,F=(void 0===E?{item:null}:E).item,D=R.refetch,H=(0,o.Z)((0,m.D)(p.x0,{onCompleted:function(n){b&&b(n)}}),1)[0],O=(0,o.Z)((0,m.D)(p.y8,{onCompleted:function(n){b&&b(n)}}),1)[0],G=[];F&&(F.addresses&&G.push.apply(G,(0,a.Z)(F.addresses)),F.accounts&&(null===(e=F.accounts[0])||void 0===e?void 0:null===(t=e.account)||void 0===t?void 0:t.addresses)&&F.accounts[0].account.addresses.forEach(function(n){G.find(function(e){return e.address.id===n.address.id})||G.push(n)}));var V,B=(g=(0,i.Z)(function(n,e){return(0,s.__generator)(this,function(t){switch(t.label){case 0:if(U(!1),P(!1),!e)return[3,2];return A(parseInt(n)),[4,J(parseInt(n))];case 1:return t.sent(),[3,3];case 2:P(!0),t.label=3;case 3:return[2]}})}),function(n,e){return g.apply(this,arguments)}),J=(V=(0,i.Z)(function(n){var e,t,i,o,a;return(0,s.__generator)(this,function(o){switch(o.label){case 0:if(!(I!==n))return[3,5];if(e=null,t=null,G.forEach(function(i){i.address.id===n&&(e=i.entity,t=i.id)}),!(t&&e===v))return[3,2];return i={id:parseInt(t),changes:(0,r.Z)({},j,!0),whereOld:(0,r.Z)({entityId:{_eq:x}},j,{_eq:!0}),changesOld:(0,r.Z)({},j,!1)},[4,O({variables:i})];case 1:return o.sent(),U(!0),[3,4];case 2:return a={objects:[(0,r.Z)({addressId:parseInt(n),entity:v,entityId:x,status:"active"},j,!0)],whereOld:(0,r.Z)({entityId:{_eq:x}},j,{_eq:!0}),changesOld:(0,r.Z)({},j,!1)},[4,H({variables:a})];case 3:o.sent(),U(!0),o.label=4;case 4:return[3,6];case 5:b&&b(null),o.label=6;case 6:return[2]}})}),function(n){return V.apply(this,arguments)});return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(f.Z,{tag:"h4",content:k}),N&&(0,c.jsx)(y.Z,{content:"Selection saved.",context:"primary"}),q&&(0,c.jsx)(y.Z,{content:"You should select at least one address.",context:"info"}),(0,c.jsx)($,{addresses:G,entity:v,entityId:x,id:Z,loading:z,refetch:D,selectable:!0,selected:I,type:j,onSelected:B,editable:!T})]})};q.propTypes={addressId:u.number,entity:u.string.isRequired,entityId:u.number.isRequired,id:u.number,onSubmit:u.func.isRequired,type:u.string.isRequired}},19611:function(n,e,t){t.d(e,{f:function(){return j}});var i=t(85893),r=t(45697),o=t(98209),a=t(16551),s=t(77439),c=t(11585),d=t(93517),u=t(86036),l=t(51466),m=t(2931),p=t(26535),f=t(32791),y=t(74492),g=t(7297),h=t(10367),v=t(60120);function x(){var n=(0,g.Z)(["\n  cursor: pointer;\n  text-decoration: none;\n"]);return x=function(){return n},n}var Z=function(n){var e=n.propertyId,t=n.propertyName,r=(0,y.a)(),o=function(){r.show({title:"Property information",content:(0,i.jsx)(v.w,{propertyId:e,toggleShow:r.close})})};return(0,i.jsx)(b,{onClick:o,children:t})},b=h.ZP.a.withConfig({displayName:"property-link__StyledLink",componentId:"sc-92d1e45-0"})(x()),j=function(n){var e=n.access,t=n.address,r=n.edit,g=n.entity,h=n.entityId,v=n.id,x=n.name,b=n.open,j=n.refetch,_=n.showMap,I=n.showLink,A=n.title,w=n.type,$=(0,y.a)(),C=function(n){n&&j&&j()},S=function(n){n.stopPropagation(),$.show({content:(0,i.jsx)(f.H,{entity:g,entityId:h,id:v,onSubmit:C,addressId:t.id,type:w}),submit:!1,title:"Manage addresses"})},q=(0,p.UC)(t),P=function(){return(0,i.jsx)(a.Z,{children:(0,i.jsx)(s.Z,{context:"secondary",content:"Edit",onClick:S,size:"sm"})})};return(0,i.jsxs)(c.Z,{handleClick:S,open:b,title:A,toolbar:r&&(0,i.jsx)(P,{}),children:[_&&o.ie.map&&(0,i.jsx)(d.Z,{apiKey:o.ie.map,center:q,location:q,markers:[q],style:{width:"100%",height:"auto"}}),x&&(0,i.jsx)(u.Z,{content:"Property",text:I?(0,i.jsx)(Z,{propertyId:h,propertyName:x}):x}),"invoice"===w&&t.invoicingEntity&&(0,i.jsx)(u.Z,{content:"Invoicing Entity",text:t.invoicingEntity}),t.name&&"invoice"!==w&&(0,i.jsx)(u.Z,{content:"Name",text:t.name}),(0,i.jsx)(l.Z,{children:" Address "}),(0,i.jsx)(m.Z,{county:t.county,line1:t.addressLine1,line2:t.addressLine2,line3:t.addressLine3,postcode:t.postCode,town:t.city}),e&&(0,i.jsx)(u.Z,{content:"Access",text:e})]})};j.propTypes={address:r.object.isRequired,edit:r.bool,entity:r.string.isRequired,entityId:r.number.isRequired,id:r.number,refetch:r.func,showMap:r.bool,showLink:r.bool,title:r.string,type:r.string},j.defaultProps={edit:!1,open:!0,showMap:!1,showLink:!0,title:"Address"}},74280:function(n,e,t){t.d(e,{Q:function(){return i}});var i=function(n){var e,t,i=n&&n.length>0&&n.find(function(n){var e;return(null===(e=n.medium)||void 0===e?void 0:e.category)==="avatar"});if(!i)return null;var r="".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(i.medium.filename),o=null==i?void 0:null===(e=i.medium)||void 0===e?void 0:null===(t=e.meta)||void 0===t?void 0:t.thumbnails;if(null==o?void 0:o.length){var a=o.find(function(n){return"small"===n.name});(null==a?void 0:a.relativePath)&&(r="".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(a.relativePath))}return r}},97637:function(n,e,t){t.d(e,{G:function(){return N}});var i=t(26042),r=t(69396),o=t(7297),a=t(85893),s=t(67294),c=t(45697),d=t(6812),u=t(92711),l=t(10367),m=t(78289),p=t(41564),f=t(34953),y=t(62466),g=t(68956),h=t(73373),v=t(11585),x=t(18678),Z=t(55377),b=t(16551),j=t(77439),_=t(74297),I=t(11013),A=t(3770),w=t(452),$=t(71072),C=t(87336),S=t(12632),q=t(74944);function P(){var n=(0,o.Z)(["\n  width: 24px;\n"]);return P=function(){return n},n}function L(){var n=(0,o.Z)(["\n  border: 1px solid #eee;\n"]);return L=function(){return n},n}var N=function(n){var e=n.carousel,t=n.category,o=n.children,c=n.data,l=(n.details,n.entity),P=n.entityId,L=n.filters,N=(n.limit,n.listView),M=n.mediaMeta,T=n.onMediaAdd,R=n.onMediaRemove,z=(n.pagination,n.showActionButtons),E=n.showEntityColumn,F=n.showItemActions,D=n.summary,H=n.type,O=(0,S.x)({filters:L}),G=O.initialData,V=O.ref,B=(0,q.x)(),J=B.hasRole,Y=B.user,W=(0,s.useContext)(m.Z),K=(0,d.a)(u.t,{variables:(0,r.Z)((0,i.Z)({},G),{entity:l,entityId:P,category:t,adminId:Y.adminId,meta:M})}),Q=K.data,X=void 0===Q?{items:[],meta:{aggregate:{totalCount:0}}}:Q,nn=X.items,ne=X.meta,nt=K.loading,ni=K.refetch,nr=function(n){W.close(),c.length||ni(),T&&T(n)},no=function(n){W.close(),c.length||ni(),R&&R(n)},na=function(n){n.stopPropagation(),W.show({content:(0,a.jsx)(w.z,{accept:"image/*",adminId:Y.adminId,category:t,entity:l,entityId:P,expiryShow:!1,mediaMeta:M,multiple:!0,onSuccess:nr,type:"image"}),title:"Upload Photos"})},ns=function(n){n.stopPropagation(),W.show({content:(0,a.jsx)(w.z,{accept:".pdf, .doc, .docx, .xlsx",adminId:Y.adminId,category:t,entity:l,entityId:P,expiryShow:!1,mediaMeta:M,onSuccess:nr,type:"document"}),title:"Upload Documents"})},nc=function(n){W.show({content:(0,a.jsx)(I.d,{mediaId:n.data.id,onSuccess:no}),submit:!1,title:"Delete Media"})},nd=function(n){W.show({content:(0,a.jsx)(A.z,{media:n.data,toggleShow:W.close}),submit:!1,title:"Media Details",width:"50%"})},nu=[{context:"primary",icon:["fas","info-circle"],onClick:function(n,e){return nd(e)},tooltip:"Details"}];J("admin")&&nu.push({context:"danger",icon:["fas","trash"],onClick:function(n,e){return nc(e)},tooltip:"Delete"});var nl=[{hidden:!0},{hidden:!0},{hidden:!0,text:"Caption"},{hidden:!1,text:"File"},{hidden:!E,text:"Entity"},{formatter:function(n){var e,t=n.row;return(0,a.jsx)(U,{children:(null==t?void 0:null===(e=t.authority)||void 0===e?void 0:e.adminOnly)&&(0,a.jsx)(p.Z,{content:"Admin user only",children:(0,a.jsx)(f.Z,{alt:"Admin Only",src:"/messaging/admin-only.svg"})})})},text:"",tooltip:"Only Admin can see"},{formatter:(0,y.Z)("/dashboard/users/view","userId","uploaded"),text:"Uploaded by"},{hidden:!N,text:"Thumbnails"},{hidden:!F,formatter:g.Z,formatterData:nu,text:"Actions"}],nm=function(n,e){n.preventDefault(),window.open("".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(e))},np=[],nf=nn.map(function(n){var e=n.entity,t=n.entityId,i=n.id,r=n.item,o=r.caption,s=r.filename,c=r.meta,d=r.name,u=r.type,l=r.user;return{data:r,id:i,userId:null==l?void 0:l.id,file:function(){return(0,a.jsx)(h.Z,{onClick:function(n){return nm(n,s)},children:o||d||s})},entity:e&&"".concat(e,"#").concat(t),authority:c,uploaded:"".concat(null==l?void 0:l.nameFirst," ").concat(null==l?void 0:l.nameLast),thumbnails:(0,$.S)(u,c),actions:""}}),ny=(nn.forEach(function(n){var e=n.item,t=e.caption,i=e.filename;"image"===e.type&&np.push({caption:t,filename:i})}),np),ng=ny.length;return(0,a.jsxs)(v.Z,{fitParentHeight:!0,open:!0,title:D,children:[o,e&&ng>0&&(0,a.jsx)(k,{children:(0,a.jsx)(x.Z,{fullWidth:!0,height:"200px",numberOfItems:1,showNavs:!1,showPagination:!0,slides:ny.map(function(n){var e=n.caption,t=n.filename;return{node:(0,a.jsx)(f.Z,{alt:e,src:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(t)}),text:" "}})})}),(0,a.jsx)(C.t,{columns:nl,loading:nt,fullHeight:!0,paginationSize:!1,meta:ne,ref:V,refetch:ni,rows:nf}),z&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z.Z,{size:"sm"}),(0,a.jsxs)(b.Z,{align:"flex-end",children:[(!H||"document"===H)&&!J("supplier")&&(0,a.jsx)(j.Z,{content:"Add Document",context:"secondary",onClick:ns,size:"sm"}),(!H||"image"===H||"avatar"===H)&&!J("supplier")&&(0,a.jsx)(j.Z,{content:"Add ".concat((0,_.Z)(H||"Image")),context:"secondary",onClick:na,size:"sm"})]})]})]})},U=l.ZP.div.withConfig({displayName:"table__StyledIcon",componentId:"sc-fc77535-0"})(P()),k=l.ZP.div.withConfig({displayName:"table__StyledCarousel",componentId:"sc-fc77535-1"})(L());N.propTypes={carousel:c.bool,category:c.string,children:c.node,data:c.array,details:c.bool,entity:c.string,entityId:c.number,filters:c.object,limit:c.number,listView:c.bool,mediaMeta:c.object,onMediaAdd:c.func,onMediaRemove:c.func,pagination:c.object,showActionButtons:c.bool,showEntityColumn:c.bool,showItemActions:c.bool,summary:c.string,type:c.string},N.defaultProps={carousel:!0,category:null,data:[],details:!1,filters:{},limit:20,listView:!1,mediaMeta:null,showActionButtons:!0,showEntityColumn:!1,showItemActions:!0,summary:"Media",type:null}},56236:function(n,e,t){t.d(e,{J:function(){return c}});var i=t(85893),r=t(45697),o=t(11585),a=t(86036),s=t(26186),c=function(n){var e=n.data,t=e.accountName,r=e.country,c=e.createdAt,d=e.fullName,u=e.position,l=e.phone,m=e.xeroContactId,p=e.permitsRequired,f=n.open;return(0,i.jsxs)(o.Z,{open:f,title:"Contact",children:[(0,i.jsx)(a.Z,{content:"Account",text:t||"Not Specified"}),(0,i.jsx)(a.Z,{content:"Name",text:d?"".concat(d):"Not Specified"}),(0,i.jsx)(a.Z,{content:"Position",text:u||"Not Specified"}),(0,i.jsx)(a.Z,{content:"Phone number",text:l||"Not Specified"}),(0,i.jsx)(a.Z,{content:"Country",text:r||"Not Specified"}),(0,i.jsx)(a.Z,{content:"Date Added",text:(0,s.Z)(c)}),(0,i.jsx)(a.Z,{content:"Permits required",text:p?"Yes":"No"}),m&&(0,i.jsx)(a.Z,{content:"Xero Contact ID",text:m})]})};c.propTypes={data:(0,r.shape)({accountName:r.string,country:r.string,createdAt:r.string,nameFirst:r.string,nameLast:r.string,position:r.string,phone:r.string}),open:r.bool},c.defaultProps={open:!0}},81777:function(n,e,t){t.d(e,{g:function(){return O}});var i=t(7297),r=t(85893),o=t(67294),a=t(45697),s=t(10367),c=t(78289),d=t(74147),u=t(9270),l=t(62140),m=t(65414),p=t(55843),f=t(45481),y=t(97303),g=t(33006),h=t(40826),v=t(55171),x=t.n(v),Z=t(6812),b=t(75063);function j(){var n=(0,i.Z)(["\n  query GetLog($entityId: bigint!, $entityName: String!) {\n    activity: audit_Activity(\n      where: { _and: [{ entityid: { _eq: $entityId } }, { entity: { _eq: $entityName } }] }\n    ) {\n      eventId\n      userId\n      user: User {\n        fullName\n      }\n      sessionUserName\n      transactionStart\n      statementStart\n      applicationName\n      clientAddr\n      clientPort\n      action\n      changedFields\n    }\n  }\n"]);return j=function(){return n},n}var _=(0,b.Ps)(j()),I=t(11585),A=t(26186),w=t(86036),$=t(49501),C={U:"Update",I:"Insert",D:"Delete"},S=function(n){var e=n.entityId,t=n.entityName,i=(0,Z.a)(_,{variables:{entityId:e,entityName:t}}),o=i.loading,a=i.data,s=(void 0===a?{activity:[]}:a).activity;return!o&&(0,r.jsx)(u.Z,{children:(0,r.jsx)(l.Z,{md:12,children:s.map(function(n){var e,t;return(0,r.jsxs)(I.Z,{title:"".concat((null===(e=n.user)||void 0===e?void 0:e.fullName)||"Backend"," - ").concat((0,A.Z)(n.transactionStart,!0)),children:[(0,r.jsx)(w.Z,{content:"Action:",text:C[t=n.action]||"-"}),(0,r.jsx)(p.Z,{}),(0,r.jsx)($.Z,{label:"Changed:",children:(0,r.jsx)(x(),{collapsed:!0,displayDataTypes:!1,src:n.changedFields||"-"})}),(0,r.jsx)(w.Z,{content:"Application:",text:n.applicationName||"-"})]},n.userId)})})})};S.propTypes={entityId:a.number.isRequired,entityName:a.string.isRequired};var q=t(97637),P=t(58632),L=t(48795),N=t(84570),U=t(74944),k=function(n){var e,t,i,o,a=n.job,s=n.numberPrefix,c=n.numberSuffix,d=(0,U.x)().hasRole;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{content:"Type",text:(null===(e=P.x.find(function(n){return n.value===a.type}))||void 0===e?void 0:e.text)||"-"}),(0,r.jsx)(w.Z,{content:"Order",text:(0,r.jsx)(L.D,{id:a.id,number:a.number,invoiceNumber:null==a?void 0:null===(t=a.invoices)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:i.invoiceNumber,type:a.type,numberPrefix:s,numberSuffix:c,isQuote:a.quoted})}),d("admin")&&a.source&&(0,r.jsx)(w.Z,{content:"Source",text:null===(o=N.Y.find(function(n){return n.value===a.source}))||void 0===o?void 0:o.text})]})};function M(){var n=(0,i.Z)(["\n  background-color: #fff;\n  border: 1px solid #eee;\n  box-shadow: rgba(45, 62, 80, 0.12) 0 1px 5px 0;\n  margin-bottom: 0.5rem;\n  padding: 1rem 0;\n"]);return M=function(){return n},n}function T(){var n=(0,i.Z)(["\n  font-size: 1rem;\n  margin-top: 0.5rem;\n"]);return T=function(){return n},n}function R(){var n=(0,i.Z)(["\n  font-size: 0.9rem;\n  margin-top: 0.5rem;\n"]);return R=function(){return n},n}function z(){var n=(0,i.Z)(["\n  margin-bottom: 1rem;\n"]);return z=function(){return n},n}function E(){var n=(0,i.Z)(["\n  margin-right: 0.5rem;\n"]);return E=function(){return n},n}function F(){var n=(0,i.Z)(["\n  display: inline;\n"]);return F=function(){return n},n}function D(){var n=(0,i.Z)(["\n  display: flex;\n  justify-content: center;\n"]);return D=function(){return n},n}function H(){var n=(0,i.Z)(["\n  cursor: pointer;\n"]);return H=function(){return n},n}k.propTypes={job:a.object,numberPrefix:a.string,numberSuffix:a.string},k.defaultProps={numberPrefix:"",numberSuffix:""};var O=function(n){var e=n.avatar,t=n.editable,i=n.entity,a=n.entityName,s=n.icons,g=n.job,h=n.linkTitleTo,v=n.log,x=n.numberPrefix,Z=n.numberSuffix,b=n.prefix,j=(0,o.useContext)(c.Z),_=(0,o.useState)(e),I=_[0],A=_[1],w=function(n){j.close(),(null==n?void 0:n.filename)?A("".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(null==n?void 0:n.filename)):A(null)},$=function(){j.show({content:(0,r.jsx)(q.G,{category:"avatar",entity:a,entityId:null==i?void 0:i.id,filters:{category:"avatar"},limit:1,onMediaAdd:w,onMediaRemove:w,type:"image"}),title:"Avatar"})},C=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Y,{context:"primary",icon:"building"}),h?(0,r.jsx)(W,{border:!1,passHref:!0,to:h,children:null==i?void 0:i.name}):null==i?void 0:i.name]})},P=function(){j.show({content:(0,r.jsx)(S,{entityId:Number(null==v?void 0:v.entityId),entityName:null==v?void 0:v.entityName}),submit:!1,title:"Log Details",width:"50%"})};return(0,r.jsxs)(G,{children:[(0,r.jsx)(d.Z,{children:(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(l.Z,{md:3,children:(0,r.jsx)(m.Z,{action:t?"Edit":null,actionClick:$,content:(null==i?void 0:i.name)||"test",context:"primary",gmail:null==i?void 0:i.email,src:I})}),(0,r.jsxs)(l.Z,{md:9,children:[(0,r.jsx)(V,{content:(0,r.jsx)(C,{}),noMargin:!0}),(null==i?void 0:i.description)&&(0,r.jsx)(B,{content:null==i?void 0:i.description,noMargin:!0}),(null==i?void 0:i.website)&&(0,r.jsxs)(J,{href:null==i?void 0:i.website,rel:"nofollow noopener noreferrer",target:"_blank",children:[(0,r.jsx)(Y,{context:"primary",icon:"window-maximize"}),"Visit website"]})]}),g&&(0,r.jsx)(l.Z,{md:12,children:(0,r.jsx)(k,{job:g,numberPrefix:x,numberSuffix:Z})})]})}),(0,r.jsx)(p.Z,{marginTop:"sm"}),s&&(0,r.jsxs)(K,{children:[s.map(function(n){var e=n.icon,t=n.onClick,i=n.to;return(0,r.jsxs)("div",{children:[t&&(0,r.jsx)(Q,{onClick:t,children:(0,r.jsx)(f.Z,{icon:e,prefix:b})}),i&&(0,r.jsx)(y.Z,{border:!1,passHref:!0,to:i,children:(0,r.jsx)(f.Z,{icon:e,prefix:b})})]},e)}),v&&(0,r.jsx)(Q,{onClick:P,children:(0,r.jsx)(f.Z,{icon:"history",size:"lg"})})]})]})},G=s.ZP.div.withConfig({displayName:"profileHeader__StyledHeader",componentId:"sc-bf764e90-0"})(M()),V=(0,s.ZP)(g.Z).withConfig({displayName:"profileHeader__StyledHeading",componentId:"sc-bf764e90-1"})(T()),B=(0,s.ZP)(g.Z).withConfig({displayName:"profileHeader__StyledDescription",componentId:"sc-bf764e90-2"})(R()),J=s.ZP.a.withConfig({displayName:"profileHeader__StyledLink",componentId:"sc-bf764e90-3"})(z()),Y=(0,s.ZP)(h.Z).withConfig({displayName:"profileHeader__StyledIcon",componentId:"sc-bf764e90-4"})(E()),W=(0,s.ZP)(y.Z).withConfig({displayName:"profileHeader__StyledTitle",componentId:"sc-bf764e90-5"})(F()),K=s.ZP.div.withConfig({displayName:"profileHeader__StyledIconContainer",componentId:"sc-bf764e90-6"})(D()),Q=s.ZP.div.withConfig({displayName:"profileHeader__Click",componentId:"sc-bf764e90-7"})(H());O.propTypes={avatar:a.string,editable:a.bool,entity:a.object.isRequired,entityName:a.string.isRequired,icons:a.array,job:a.object,linkTitleTo:a.string,log:a.object,prefix:a.string,numberPrefix:a.string,numberSuffix:a.string},O.defaultProps={avatar:"",editable:!0,numberPrefix:"",numberSuffix:""}},87336:function(n,e,t){t.d(e,{t:function(){return d}});var i=t(85893),r=t(67294),o=t(45697),a=t(11163),s=t(98209),c=t(16540),d=(0,r.forwardRef)(function(n,e){var t=n.columns,o=n.history,d=n.initialSort,u=n.loading,l=n.meta,m=n.paginationSize,p=n.refetch,f=n.rowClick,y=n.rows,g=n.xeroPageSize,h=(0,a.useRouter)(),v=h.query,x=void 0===v?{}:v,Z=(0,r.useState)(parseInt(null==x?void 0:x.page,10)||1),b=Z[0],j=Z[1],_=(0,r.useState)(g||s.C1.paginationSize),I=_[0],A=_[1];d||(d={item:"createdAt",order:"desc"});var w=(0,r.useState)({item:d.item,order:d.order}),$=w[0],C=w[1],S=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=h.query,t=void 0===e?{}:e;if(n>1?t.page=n:delete t.page,!(Object.keys(t).length>0))return{};var i=Object.keys(t).map(function(e){return"page"===e?"".concat(e,"=").concat(n):"".concat(e,"=").concat(t[e])}).join("&");return"?".concat(i)},q=function(){C({item:d.item,order:d.order}),j(1);var n=S();h.push(n),A(g||s.C1.paginationSize)};(0,r.useImperativeHandle)(e,function(){return{currentPage:b,pageSize:I,sort:$,resetPagination:function(){q()}}});var P=function(n){var e=S(n);o&&h.push(e),j(n),!o&&p&&p()},L=function(n){n!==s.C1.paginationSize&&(A(n),p&&p())},N=function(n){var e;C({item:n.item,order:n.order}),p&&p()};return(0,i.jsx)(c.Z,{columns:t,loading:u,paginationSize:m,pagination:l&&!0,paginationProps:l&&{currentPage:b,onPageChange:P,onPageSizeChange:L,pageCount:Math.ceil(l.aggregate.totalCount/I),perPage:I},rowClick:f,rows:y,sort:$,setSort:N})});d.propTypes={columns:o.array.isRequired,history:o.bool,initialSort:o.object,loading:o.bool,meta:o.object,refetch:o.func,rowClick:o.func,rows:o.array.isRequired},d.defaultProps={history:!0,loading:!0,paginationSize:!1}},94885:function(n,e,t){t.d(e,{$E:function(){return M},AX:function(){return I},I4:function(){return _},JA:function(){return w},MT:function(){return P},Px:function(){return C},WF:function(){return $},ZA:function(){return z},a8:function(){return S},fA:function(){return k},fo:function(){return A},ge:function(){return R},iM:function(){return U},nE:function(){return L},nh:function(){return N},r1:function(){return q},tW:function(){return E},uz:function(){return T}});var i=t(7297),r=t(75063);function o(){var n=(0,i.Z)(["\n  mutation InsertAccountUser($objects: [Account_User_insert_input!]!) {\n    insert_Account_User(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return o=function(){return n},n}function a(){var n=(0,i.Z)(["\n  mutation UpdateUser(\n    $id: Int!\n    $accountUserId: Int!\n    $accountUserChanges: Account_User_set_input\n    $changes: User_set_input\n    $updateAccountUser: Boolean!\n  ) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _set: $accountUserChanges)\n      @include(if: $updateAccountUser) {\n      id\n    }\n    update_User_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]);return a=function(){return n},n}function s(){var n=(0,i.Z)(["\n  query GetUsers(\n    $accountId: Int\n    $accountType: String\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: User_order_by!\n    $status: String\n  ) {\n    users: User(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [\n          { email: { _ilike: $q } }\n          { nameFirst: { _ilike: $q } }\n          { nameLast: { _ilike: $q } }\n        ]\n        status: { _eq: $status }\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n        userLocations: User_Account_Locations {\n          accountLocationId\n        }\n      }\n    }\n    meta: User_aggregate(\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]);return s=function(){return n},n}function c(){var n=(0,i.Z)(["\n  query GetUser($id: Int!) {\n    user: User_by_pk(id: $id) {\n      id\n      fullName\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]);return c=function(){return n},n}function d(){var n=(0,i.Z)(["\n  query CheckDuplicateEmail($email: String!) {\n    users: User_public(where: { email: { _eq: $email } }) {\n      id\n      nameFirst\n      nameLast\n      email\n      phone\n    }\n  }\n"]);return d=function(){return n},n}function u(){var n=(0,i.Z)(["\n  fragment UserFields on User {\n    id\n    email\n    nameFirst\n    nameLast\n    fullName\n    phone\n    status\n  }\n"]);return u=function(){return n},n}function l(){var n=(0,i.Z)(["\n  mutation SendGoogleAuthCode($code: String!, $id: Int!, $type: String!) {\n    createGoogleToken(code: $code, id: $id, type: $type) {\n      success\n      tokens\n      error\n    }\n  }\n"]);return l=function(){return n},n}function m(){var n=(0,i.Z)(["\n  mutation GenerateMSURL($type: String!, $id: Int!) {\n    genenrateMSURL(id: $id, type: $type) {\n      url\n    }\n  }\n"]);return m=function(){return n},n}function p(){var n=(0,i.Z)(["\n  mutation signoutMS($id: Int!, $type: String!, $email: String!) {\n    signoutMS(id: $id, type: $type, email: $email) {\n      error\n      msId\n      success\n    }\n  }\n"]);return p=function(){return n},n}function f(){var n=(0,i.Z)(["\n  query getAccountMeta($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      meta\n    }\n  }\n"]);return f=function(){return n},n}function y(){var n=(0,i.Z)(["\n  query user($id: Int!) {\n    user: User_by_pk(id: $id) {\n      meta\n      invoiceThreshold\n      quoteThreshold\n    }\n  }\n"]);return y=function(){return n},n}function g(){var n=(0,i.Z)(["\n  query GetAccountUserMeta($userId: Int!, $accountId: Int!) {\n    accountUser: Account_User(where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }) {\n      meta\n    }\n  }\n"]);return g=function(){return n},n}function h(){var n=(0,i.Z)(["\n  mutation UpdateAccountUserByUserIdAccoutId(\n    $userId: Int!\n    $accountId: Int!\n    $changes: Account_User_set_input!\n  ) {\n    update_Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n      _set: $changes\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return h=function(){return n},n}function v(){var n=(0,i.Z)(["\n  mutation updateAccount($accountId: Int!, $set: Account_set_input!) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $set) {\n      id\n    }\n  }\n"]);return v=function(){return n},n}function x(){var n=(0,i.Z)(["\n  mutation updateUserMeta($userId: Int!, $meta: jsonb!) {\n    update_User_by_pk(pk_columns: { id: $userId }, _set: { meta: $meta }) {\n      id\n      meta\n    }\n  }\n"]);return x=function(){return n},n}function Z(){var n=(0,i.Z)(['\n  query userDevices($accountId: Int!) {\n    users: User(\n      where: {\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        UserDevices: { status: { _eq: "active" } }\n        status: { _eq: "active" }\n      }\n    ) {\n      id\n      fullName\n      devices: UserDevices(\n        order_by: { updatedAt: desc_nulls_last }\n        where: { status: { _eq: "active" } }\n        limit: 1\n      ) {\n        id\n        playerId\n      }\n    }\n  }\n']);return Z=function(){return n},n}function b(){var n=(0,i.Z)(['\n  query GetAccountLocations($accountId: Int, $limit: Int, $offset: Int) {\n    location: Location(\n      offset: $offset\n      limit: $limit\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      id\n      name\n      accountLocations: Account_Locations {\n        id\n      }\n      addresses: Addresses(where: { entity: { _eq: "Location" }, registered: { _eq: true } }) {\n        id\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          postCode\n        }\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']);return b=function(){return n},n}function j(){var n=(0,i.Z)(["\n  mutation InsertUserAccountLocations(\n    $accountUserId: Int!\n    $objects: [User_Account_Location_insert_input!]!\n  ) {\n    delete_User_Account_Location(where: { accountUserId: { _eq: $accountUserId } }) {\n      affected_rows\n    }\n    insert_User_Account_Location(objects: $objects) {\n      affected_rows\n      returning {\n        id\n      }\n    }\n  }\n"]);return j=function(){return n},n}var _=(0,r.Ps)(o()),I=(0,r.Ps)(a()),A=(0,r.Ps)(s()),w=(0,r.Ps)(c()),$=(0,r.Ps)(d()),C=(0,r.Ps)(u()),S=(0,r.Ps)(l()),q=(0,r.Ps)(m()),P=(0,r.Ps)(p()),L=(0,r.Ps)(f()),N=(0,r.Ps)(y()),U=(0,r.Ps)(g()),k=(0,r.Ps)(h()),M=(0,r.Ps)(v()),T=(0,r.Ps)(x()),R=(0,r.Ps)(Z()),z=(0,r.Ps)(b()),E=(0,r.Ps)(j())},98521:function(n,e,t){t.d(e,{O:function(){return i},v:function(){return r}});var i=[{text:"Country",value:""},{text:"United Kingdom",value:1},{text:"Ireland",value:4}],r=[{label:"United Kingdom",value:1},{label:"Ireland",value:4}]},84570:function(n,e,t){t.d(e,{Y:function(){return i}});var i=[{text:"Select...",value:""},{text:"Call",value:"call"},{text:"Email",value:"email"},{text:"Portal",value:"portal"},{text:"Other",value:"other"}]},60120:function(n,e,t){t.d(e,{w:function(){return x}});var i=t(85893),r=t(67294),o=t(45697),a=t(6812),s=t(11163),c=t(84808),d=t(98456),u=t(81777),l=t(74280),m=t(56236),p=t(19611),f=t(26535),y=t(7297),g=t(75063);function h(){var n=(0,y.Z)(['\n  query GetProperty($id: Int!) {\n    location: Location_by_pk(id: $id) {\n      id\n      access\n      createdAt\n      name\n      contactUserId\n      status\n      meta\n      permitsRequired\n      expenses: Expenses(where: { entity: { _eq: "Location" } }) {\n        id\n        amount\n        description\n        markup\n        total\n        unit\n        vat\n        paid\n        occurredAt\n        recurring\n      }\n      addresses: Addresses(order_by: { id: asc }, where: { entity: { _eq: "Location" } }) {\n        id\n        registered\n        operating\n        trading\n        invoice\n        status\n        createdAt\n        address: Address {\n          id\n          name\n          addressLine1\n          addressLine2\n          addressLine3\n          city\n          county\n          geo\n          postCode\n          country: Country {\n            id\n            name\n            code\n          }\n        }\n      }\n      bookings: Jobs {\n        id\n        title\n        createdAt\n        customerId\n        amount\n        locationId\n        managerId\n        quoteNumber\n        reference\n        status\n        serviceId\n        meta\n        customer: Customer {\n          id\n          name\n        }\n        location: Location {\n          id\n          name\n          addresses: Addresses(where: { entity: { _eq: "Location" } }) {\n            id\n            registered\n            operating\n            trading\n            invoice\n            status\n            createdAt\n            address: Address {\n              id\n              name\n              addressLine1\n              addressLine2\n              addressLine3\n              city\n              county\n              geo\n              postCode\n              country: Country {\n                id\n                name\n              }\n            }\n          }\n        }\n        manager: Manager {\n          id\n          nameFirst\n          nameLast\n        }\n        sla: SLA {\n          id\n          name\n          notes\n        }\n        supplier: Supplier {\n          id\n          companyNumber\n          createdAt\n          name\n          status\n          type\n          updatedAt\n          website\n          clientType\n          managerId\n          vatId\n          meta\n          media: Media {\n            id\n            medium: Medium {\n              id\n              category\n              filename\n              meta\n              type\n            }\n          }\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n        supplierOffers: SupplierOffers {\n          status\n          rate\n          supplier: Supplier {\n            id\n            companyNumber\n            createdAt\n            name\n            status\n            type\n            updatedAt\n            website\n            clientType\n            managerId\n            vatId\n            meta\n            media: Media {\n              id\n              medium: Medium {\n                id\n                category\n                filename\n                meta\n                type\n              }\n            }\n            manager: Manager {\n              id\n              fullName\n            }\n          }\n        }\n        timings: JobTimings {\n          id\n          status\n          createdAt\n        }\n      }\n      customer: Account_Locations(where: { Account: { type: { _eq: "customer" } } }) {\n        account: Account {\n          id\n          companyNumber\n          createdAt\n          name\n          status\n          type\n          updatedAt\n          website\n          clientType\n          managerId\n          vatId\n          meta\n\n          media: Media {\n            id\n            medium: Medium {\n              id\n              category\n              filename\n              meta\n              type\n            }\n          }\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n      }\n      supplier: Account_Locations(where: { Account: { type: { _eq: "supplier" } } }) {\n        id\n        account: Account {\n          id\n          companyNumber\n          createdAt\n          name\n          status\n          type\n          updatedAt\n          website\n          clientType\n          managerId\n          vatId\n          meta\n          media: Media {\n            id\n            medium: Medium {\n              id\n              category\n              filename\n              meta\n              type\n            }\n          }\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n      }\n      user: User {\n        id\n        name: nameFirst\n        nameFirst\n        nameLast\n        phone\n        status\n        email\n        createdAt\n        fullName\n        accounts: Account_Users {\n          id\n          role\n          position\n          isContact\n          status\n          account: Account {\n            id\n            name\n            type\n          }\n        }\n      }\n      assets: Assets {\n        id\n        name\n        manufacturer\n        model\n        serialNumber\n        createdAt\n        customer: Account {\n          id\n          name\n          type\n        }\n        location: Location {\n          id\n          name\n        }\n      }\n    }\n  }\n']);return h=function(){return n},n}var v=(0,g.Ps)(h()),x=function(n){var e,t,o,y=n.propertyId,g=n.toggleShow,h=(0,s.useRouter)();(0,r.useEffect)(function(){var n=function(n){g()};return h.events.on("routeChangeComplete",n),function(){h.events.off("routeChangeComplete",n)}},[]);var x=(0,a.a)(v,{variables:{id:y}}),Z=x.loading,b=x.data,j=(void 0===b?{location:{}}:b).location;if(Z)return(0,i.jsx)(c.Z,{sx:{zIndex:1e5},open:!0,children:(0,i.jsx)(d.Z,{color:"secondary"})});var _=j.createdAt,I=j.customer,A=j.supplier,w=j.user,$=(0,f.WE)(j,"registered"),C=(0,f.WE)(j,"invoice");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.g,{avatar:(0,l.Q)(null===(e=j.customer[0].account)||void 0===e?void 0:e.media),editable:!1,entity:{id:j.id,description:j.customer[0].account.name,name:j.name},entityName:"Location",linkTitleTo:"/dashboard/properties/view?id=".concat(j.id)}),(0,i.jsx)(m.J,{data:{accountName:I.length&&I[0].account.name||A.length&&A[0].account.name,country:null==$?void 0:null===(t=$.address)||void 0===t?void 0:null===(o=t.country)||void 0===o?void 0:o.name,createdAt:_,fullName:null==w?void 0:w.fullName,position:null==w?void 0:w.position,phone:null==w?void 0:w.phone}}),$&&(0,i.jsx)(p.f,{address:$.address,edit:!1,entity:"Location",entityId:j.id,id:$.id,showMap:!0,title:"Address",type:"registered"}),C&&(0,i.jsx)(p.f,{address:C.address,edit:!1,entity:"Location",entityId:j.id,id:C.id,title:"Invoice Address",type:"invoice"})]})};x.propTypes={propertyId:o.number.isRequired,toggleShow:o.func.isRequired}}}]);