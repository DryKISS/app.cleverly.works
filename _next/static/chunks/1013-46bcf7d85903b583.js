"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1013],{52005:function(e,r,t){t.d(r,{C:function(){return v}});var o=t(26042),n=t(99534),a=t(85893),i=t(45697),s=t(89345),u=t(9270),c=t(62140),l=t(99505),d=t(55843),v=function(e){var r=e.control,t=e.errors,i=e.nameEnd,v=e.nameStart,p=e.placeholderEnd,y=e.placeholderStart,m=e.space,g=(0,n.Z)(e,["control","errors","nameEnd","nameStart","placeholderEnd","placeholderStart","space"]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(c.Z,{md:6,children:(0,a.jsx)(l.Z,(0,o.Z)({control:r,errors:t,locale:s.Z,name:v,placeholder:y},g))}),(0,a.jsx)(c.Z,{md:6,children:(0,a.jsx)(l.Z,(0,o.Z)({control:r,errors:t,locale:s.Z,name:i,placeholder:p},g))})]}),m&&(0,a.jsx)(d.Z,{marginBottom:"sm"})]})};v.propTypes={control:i.object.isRequired,errors:i.object.isRequired,nameStart:i.string.isRequired,nameEnd:i.string.isRequired,placeholderStart:i.string,placeholderEnd:i.string,space:i.bool},v.defaultProps={placeholderStart:"Start date",placeholderEnd:"End date",space:!0}},31453:function(e,r,t){t.d(r,{r:function(){return o}});var o=[{text:"All work orders",value:null,label:"All work orders"},{text:"All outstanding invoices",value:"0-",label:"All outstanding invoices"},{text:"1 - 30",value:"1-30",label:"1 - 30"},{text:"31 - 60",value:"31-60",label:"31 - 60"},{text:"61 - 90",value:"61-90",label:"61 - 90"},{text:"> 90",value:"90-",label:"> 90"}]},536:function(e,r,t){t.d(r,{P:function(){return _}});var o=t(47568),n=t(26042),a=t(69396),i=t(99534),s=t(7297),u=t(97582),c=t(85893),l=t(67294),d=t(45697),v=t(10367),p=t(66252),y=t(57493),m=t(78289),g=t(52019),h=t(49501),b=t(9270),I=t(62140),f=t(84043),q=t(77439);function S(){var e=(0,s.Z)(["\n  position: relative;\n  right: 25px;\n  top: 2px;\n"]);return S=function(){return e},e}var x=function(e,r){var t,o,n,a=!0;return(null===(t=e.errors[e.name])||void 0===t?void 0:t.message)!==(null===(o=r.errors[r.name])||void 0===o?void 0:o.message)&&(a=!1),["accountId","assetCategoryId","entity","entityId","locationId","serviceId","type","value","customerId","customerRole"].forEach(function(t){e[t]!==r[t]&&(a=!1)}),a},C=function(e){var r=e.accountId,t=e.area,o=e.assetCategoryId,n=e.entity,a=e.entityId,i=(e.hasRole,e.id),s=e.locationId,u=e.serviceId,c=e.taxonomyGroupType,l=e.customerId,d=e.customerRole,v=e.type,p=e.userId,m=e.invoiceThreshold,g=e.quoteThreshold,h=v;switch(d&&(h="".concat(v,"_").concat(d)),h){case"address":return{query:y.cz,variables:{entity:n,entityId:a}};case"asset":return{query:y.UH,variables:{categoryId:o,locationId:s}};case"assetBookable":return{query:y.UH,variables:{categoryId:o,locationId:s,bookable:"yes"}};case"assetCategory":return{query:y.nD,variables:{id:i}};case"assetSublocation":return{query:y.UH,variables:{category:"sublocation",adminId:r,locationId:s}};case"coverage":return{query:y.j$};case"customer":return{query:y.SW};case"job":return{query:y.Qn,variables:{locationId:s}};case"manager":return{query:y.he,variables:{accountId:r,userId:p}};case"thresholdManagers":return{query:y.Ak,variables:{accountId:r,userId:p,invoiceThreshold:m,quoteThreshold:g}};case"product":return{query:y.UH,variables:{category:"product",locationId:s}};case"property":return{query:y._d,variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:r}}}}};case"property_user":return{query:y._d,variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:r},Account:{type:{_eq:"customer"},Account_Users:{role:{_eq:"user"},userId:{_eq:l}}},User_Account_Locations:{Account_User:{userId:{_eq:l},accountId:{_eq:r}}}}}}};case"sensor":return{query:y.UH,variables:{category:"sensor",locationId:s}};case"service":return{query:y.kx};case"sla":return{query:y.t1,variables:{type:"priority",adminId:r}};case"sublocation":return{query:y.zR,variables:{locationId:s}};case"supplier":var b={type:{_eq:"supplier"}};return t&&(b.PostcodeAreas={PostcodeArea:{area:{_eq:t}},entity:{_eq:"Account"},status:{_eq:"active"}}),u&&(b.ServiceSchedule={status:{_eq:"active"},entity:{_eq:"Supplier"},serviceId:{_eq:u}},t&&(b.ServiceSchedule.PostcodeAreas={PostcodeArea:{area:{_eq:t}}})),{query:y.by,variables:{where:b}};case"user":return{query:y.yR,variables:{accountId:r}};case"usersForBookings":return{query:y.yR,variables:{accountId:p}};case"tenant":return{query:y.RJ};case"taxonomyGroup":return{query:y.Cj,variables:{type:c}};case"expenseCategory":return{query:y.Ve};default:return{query:y.qd}}},_=(0,l.memo)(function(e){var r,t=e.AddForm,s=e.accountId,d=e.area,v=e.assetCategoryId,y=e.control,S=e.entity,x=e.entityId,_=e.errors,j=e.id,R=e.isClearable,A=e.isDisabled,w=e.label,P=e.locationId,T=e.name,k=e.serviceId,z=e.taxonomyGroupType,E=e.customerId,F=e.customerRole,O=e.type,U=e.userId,B=e.invoiceThreshold,D=e.quoteThreshold,G=(0,i.Z)(e,["AddForm","accountId","area","assetCategoryId","control","entity","entityId","errors","id","isClearable","isDisabled","label","locationId","name","serviceId","taxonomyGroupType","customerId","customerRole","type","userId","invoiceThreshold","quoteThreshold"]),H=(0,p.x)(),L=(0,l.useState)(!1),N=L[0],J=L[1],M=(0,l.useState)(),V=M[0],W=M[1],Q=(0,l.useState)(!1),$=Q[0],K=Q[1],X=(0,l.useContext)(m.Z),Y=(0,l.useContext)(g.Z).hasRole,ee=(0,l.useState)(!1),er=ee[0],et=ee[1];(0,l.useEffect)(function(){return et(!1),K(!1),function(){}},[s,v,S,x,P,k,O,E,F,U]);var eo=(r=(0,o.Z)(function(){var e,r,t,o,i,c,l,p;return(0,u.__generator)(this,function(i){switch(i.label){case 0:if($)return et(!0),[2,null];return J(!0),r=(e=C({accountId:s,area:d,assetCategoryId:v,entity:S,entityId:x,hasRole:Y,id:j,locationId:P,serviceId:k,taxonomyGroupType:z,customerId:E,customerRole:F,type:O,userId:U,invoiceThreshold:B,quoteThreshold:D})).query,o=void 0===(t=e.variables)?{}:t,[4,H.query({query:r,variables:(0,n.Z)({},o)})];case 1:var u,l;return u=(void 0===(c=i.sent().data)?{items:[]}:c).items,p="asset"===(l=O)?u.map(function(e){return(0,a.Z)((0,n.Z)({},e),{label:"".concat(e.label," ").concat(e.sublocation?"- ".concat(e.sublocation.name):"")})}):u,W(p),J(!1),K(!0),et(!0),[2]}})}),function(){return r.apply(this,arguments)}),en=function(){X.show({content:(0,c.jsx)("div",{children:(0,c.jsx)(t,{})}),title:"Add form"})};return(0,c.jsx)(h.Z,{id:T,label:w,children:(0,c.jsxs)(b.Z,{children:[(0,c.jsx)(I.Z,{md:t?11:12,children:(0,c.jsx)(f.Z,(0,n.Z)({autoload:!1,blurInputOnSelect:!0,cacheOptions:!0,control:y,errors:_,isDisabled:A,isClearable:R,isLoading:N,menuIsOpen:er,options:V,onFocus:eo,onBlur:function(){et(!1)},name:T,searchable:!0},G),G.defaultValue)}),t&&(0,c.jsx)(I.Z,{md:1,children:(0,c.jsx)(Z,{children:(0,c.jsx)(q.Z,{content:null,startIcon:"plus",size:"sm",onClick:en})})})]})})},x),Z=v.ZP.div.withConfig({displayName:"select__ButtonWrapper",componentId:"sc-f7921e38-0"})(S());_.propTypes={AddForm:d.object,area:d.string,accountId:d.number,assetCategoryId:d.number,control:d.object.isRequired,errors:d.object.isRequired,entity:d.string,entityId:d.number,id:d.number,isClearable:d.bool,label:d.string.isRequired,locationId:d.number,name:d.string.isRequired,serviceId:d.number,taxonomyGroupType:(0,d.oneOf)(["expenseCategory","costCategory","jobTags"]),type:d.string},_.defaultProps={isClearable:!0,label:"Account",name:"account",type:"account"}},87336:function(e,r,t){t.d(r,{t:function(){return c}});var o=t(85893),n=t(67294),a=t(45697),i=t(11163),s=t(98209),u=t(16540),c=(0,n.forwardRef)(function(e,r){var t=e.columns,a=e.history,c=e.initialSort,l=e.loading,d=e.meta,v=e.paginationSize,p=e.refetch,y=e.rowClick,m=e.rows,g=e.xeroPageSize,h=(0,i.useRouter)(),b=h.query,I=void 0===b?{}:b,f=(0,n.useState)(parseInt(null==I?void 0:I.page,10)||1),q=f[0],S=f[1],x=(0,n.useState)(g||s.C1.paginationSize),C=x[0],_=x[1];c||(c={item:"createdAt",order:"desc"});var Z=(0,n.useState)({item:c.item,order:c.order}),j=Z[0],R=Z[1],A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=h.query,t=void 0===r?{}:r;if(e>1?t.page=e:delete t.page,!(Object.keys(t).length>0))return{};var o=Object.keys(t).map(function(r){return"page"===r?"".concat(r,"=").concat(e):"".concat(r,"=").concat(t[r])}).join("&");return"?".concat(o)},w=function(){R({item:c.item,order:c.order}),S(1);var e=A();h.push(e),_(g||s.C1.paginationSize)};(0,n.useImperativeHandle)(r,function(){return{currentPage:q,pageSize:C,sort:j,resetPagination:function(){w()}}});var P=function(e){var r=A(e);a&&h.push(r),S(e),!a&&p&&p()},T=function(e){e!==s.C1.paginationSize&&(_(e),p&&p())},k=function(e){var r;R({item:e.item,order:e.order}),p&&p()};return(0,o.jsx)(u.Z,{columns:t,loading:l,paginationSize:v,pagination:d&&!0,paginationProps:d&&{currentPage:q,onPageChange:P,onPageSizeChange:T,pageCount:Math.ceil(d.aggregate.totalCount/C),perPage:C},rowClick:y,rows:m,sort:j,setSort:k})});c.propTypes={columns:a.array.isRequired,history:a.bool,initialSort:a.object,loading:a.bool,meta:a.object,refetch:a.func,rowClick:a.func,rows:a.array.isRequired},c.defaultProps={history:!0,loading:!0,paginationSize:!1}},12632:function(e,r,t){t.d(r,{x:function(){return l}});var o=t(14924),n=t(26042),a=t(69396),i=t(67294),s=t(96486),u=t(98209),c=t(59577),l=function(e){var r,t,l,d,v,p,y,m,g,h,b,I=e.filters,f=e.newFilters,q=e.initialSort,S=(0,i.useRef)(),x=(0,i.useState)({}),C=x[0],_=x[1],Z=(0,i.useState)({}),j=Z[0],R=Z[1],A=q||{item:"createdAt",order:"desc"},w=(0,o.Z)({},(null===(r=S.current)||void 0===r?void 0:r.sort.item)||A.item,A.inneritem?(0,o.Z)({},A.inneritem,(null===(t=S.current)||void 0===t?void 0:t.sort.order)||A.order):(null===(l=S.current)||void 0===l?void 0:l.sort.order)||A.order);return(0,i.useEffect)(function(){var e=!(0,s.isEqual)(C,I),r=!(0,s.isEqual)(j,f);if(e&&(_(I),null==S||null===(o=S.current)||void 0===o||o.resetPagination()),r&&(R(f),null==S||null===(n=S.current)||void 0===n||n.resetPagination()),(null==S?void 0:null===(t=S.current)||void 0===t?void 0:t.setSort)&&!(e||r)){var t,o,n,a,i,u,c,l,d,v,p,y=(null===(a=S.current)||void 0===a?void 0:null===(i=a.sort)||void 0===i?void 0:i.item)&&(null===(u=S.current)||void 0===u?void 0:null===(c=u.sort)||void 0===c?void 0:c.order)?{item:null===(l=S.current)||void 0===l?void 0:null===(d=l.sort)||void 0===d?void 0:d.item,order:null===(v=S.current)||void 0===v?void 0:null===(p=v.sort)||void 0===p?void 0:p.order}:w;S.current.setSort(y)}},[I,f]),{initialData:(0,a.Z)((0,n.Z)({},I),{newFilters:(null==f?void 0:f.length)>0?f:void 0,limit:(null===(d=S.current)||void 0===d?void 0:d.pageSize)==="Infinity"?null:parseInt(null===(v=S.current)||void 0===v?void 0:v.pageSize,10)||u.C1.paginationSize,offset:((null===(p=S.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(y=S.current)||void 0===y?void 0:y.pageSize)||u.C1.paginationSize),orderBy:(0,c.c)(null===(m=S.current)||void 0===m?void 0:null===(g=m.sort)||void 0===g?void 0:null===(h=g.item)||void 0===h?void 0:h.replace(/ORDER/i,null===(b=S.current)||void 0===b?void 0:b.sort.order))||w}),initialSort:q,ref:S}}},59577:function(e,r,t){t.d(r,{c:function(){return o}});var o=function(e){try{return JSON.parse(e)}catch(r){return!1}}}}]);