(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3731],{83035:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/issues",function(){return t(3728)}])},18531:function(n,e,t){"use strict";t.d(e,{q:function(){return f}});var r=t(26042),i=t(69396),o=t(99534),a=t(85893),u=t(87918),s=t(98456),d=t(23776),c=t(50135),l=t(67294),m=t(45697),p=t.n(m),f=function(n){var e=n.loading,t=n.setSearch,m=n.textFieldProps,p=(n.disableClearable,(0,o.Z)(n,["loading","setSearch","textFieldProps","disableClearable"])),f=(0,l.useState)(""),v=f[0],h=f[1];return(0,l.useEffect)(function(){var n=setTimeout(function(){t(v)},500);return function(){return clearTimeout(n)}},[v,t]),(0,a.jsx)(d.Z,(0,i.Z)((0,r.Z)({isOptionEqualToValue:function(n,e){return n.value===e.value}},p),{loading:e,onInputChange:function(n,e){h(e)},getOptionLabel:function(n){return"".concat(n.label)},renderTags:function(n,e){return n.map(function(n,t){return(0,a.jsx)(u.Z,(0,r.Z)({size:"small",label:n.label},e({index:t})))})},renderInput:function(n){return(0,a.jsx)(c.Z,(0,i.Z)((0,r.Z)({},n,m),{InputProps:(0,i.Z)((0,r.Z)({},n.InputProps,m.InputProps||{}),{endAdornment:(0,a.jsxs)(a.Fragment,{children:[e?(0,a.jsx)(s.Z,{color:"inherit",size:20}):null,n.InputProps.endAdornment]})})}))}}))};f.defaultProps={color:"secondary",onChange:function(){},options:[],onOpen:function(){},setSearch:function(){},textFieldProps:{}},f.propTypes={multiple:p().bool,limitTags:p().number,filterSelectedOptions:p().bool,color:p().string,loading:p().bool,value:p().oneOf([p().array,p().object]),onChange:p().func,options:p().arrayOf(p().shape({value:p().any.isRequired,label:p().string.isRequired})).isRequired,onOpen:p().func,setSearch:p().func,textFieldProps:p().shape({label:p().string,variant:p().oneOf(["standard"]),color:p().string,error:p().bool,helperText:p().string})}},12632:function(n,e,t){"use strict";t.d(e,{x:function(){return c}});var r=t(14924),i=t(26042),o=t(69396),a=t(67294),u=t(96486),s=t(98209),d=t(59577),c=function(n){var e,t,c,l,m,p,f,v,h,g,y,_=n.filters,I=n.newFilters,b=n.initialSort,$=(0,a.useRef)(),A=(0,a.useState)({}),S=A[0],x=A[1],Z=(0,a.useState)({}),q=Z[0],U=Z[1],j=b||{item:"createdAt",order:"desc"},w=(0,r.Z)({},(null===(e=$.current)||void 0===e?void 0:e.sort.item)||j.item,j.inneritem?(0,r.Z)({},j.inneritem,(null===(t=$.current)||void 0===t?void 0:t.sort.order)||j.order):(null===(c=$.current)||void 0===c?void 0:c.sort.order)||j.order);return(0,a.useEffect)(function(){var n=!(0,u.isEqual)(S,_),e=!(0,u.isEqual)(q,I);if(n&&(x(_),null==$||null===(r=$.current)||void 0===r||r.resetPagination()),e&&(U(I),null==$||null===(i=$.current)||void 0===i||i.resetPagination()),(null==$?void 0:null===(t=$.current)||void 0===t?void 0:t.setSort)&&!(n||e)){var t,r,i,o,a,s,d,c,l,m,p,f=(null===(o=$.current)||void 0===o?void 0:null===(a=o.sort)||void 0===a?void 0:a.item)&&(null===(s=$.current)||void 0===s?void 0:null===(d=s.sort)||void 0===d?void 0:d.order)?{item:null===(c=$.current)||void 0===c?void 0:null===(l=c.sort)||void 0===l?void 0:l.item,order:null===(m=$.current)||void 0===m?void 0:null===(p=m.sort)||void 0===p?void 0:p.order}:w;$.current.setSort(f)}},[_,I]),{initialData:(0,o.Z)((0,i.Z)({},_),{newFilters:(null==I?void 0:I.length)>0?I:void 0,limit:(null===(l=$.current)||void 0===l?void 0:l.pageSize)==="Infinity"?null:parseInt(null===(m=$.current)||void 0===m?void 0:m.pageSize,10)||s.C1.paginationSize,offset:((null===(p=$.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(f=$.current)||void 0===f?void 0:f.pageSize)||s.C1.paginationSize),orderBy:(0,d.c)(null===(v=$.current)||void 0===v?void 0:null===(h=v.sort)||void 0===h?void 0:null===(g=h.item)||void 0===g?void 0:g.replace(/ORDER/i,null===(y=$.current)||void 0===y?void 0:y.sort.order))||w}),initialSort:b,ref:$}}},94885:function(n,e,t){"use strict";t.d(e,{$E:function(){return T},AX:function(){return S},I4:function(){return A},JA:function(){return Z},MT:function(){return C},Px:function(){return U},WF:function(){return q},ZA:function(){return M},a8:function(){return j},fA:function(){return k},fo:function(){return x},ge:function(){return L},iM:function(){return D},nE:function(){return P},nh:function(){return N},r1:function(){return w},tW:function(){return F},uz:function(){return O}});var r=t(7297),i=t(75063);function o(){var n=(0,r.Z)(["\n  mutation InsertAccountUser($objects: [Account_User_insert_input!]!) {\n    insert_Account_User(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return o=function(){return n},n}function a(){var n=(0,r.Z)(["\n  mutation UpdateUser(\n    $id: Int!\n    $accountUserId: Int!\n    $accountUserChanges: Account_User_set_input\n    $changes: User_set_input\n    $updateAccountUser: Boolean!\n  ) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _set: $accountUserChanges)\n      @include(if: $updateAccountUser) {\n      id\n    }\n    update_User_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]);return a=function(){return n},n}function u(){var n=(0,r.Z)(["\n  query GetUsers(\n    $accountId: Int\n    $accountType: String\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: User_order_by!\n    $status: String\n  ) {\n    users: User(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [\n          { email: { _ilike: $q } }\n          { nameFirst: { _ilike: $q } }\n          { nameLast: { _ilike: $q } }\n        ]\n        status: { _eq: $status }\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n        userLocations: User_Account_Locations {\n          accountLocationId\n        }\n      }\n    }\n    meta: User_aggregate(\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]);return u=function(){return n},n}function s(){var n=(0,r.Z)(["\n  query GetUser($id: Int!) {\n    user: User_by_pk(id: $id) {\n      id\n      fullName\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]);return s=function(){return n},n}function d(){var n=(0,r.Z)(["\n  query CheckDuplicateEmail($email: String!) {\n    users: User_public(where: { email: { _eq: $email } }) {\n      id\n      nameFirst\n      nameLast\n      email\n      phone\n    }\n  }\n"]);return d=function(){return n},n}function c(){var n=(0,r.Z)(["\n  fragment UserFields on User {\n    id\n    email\n    nameFirst\n    nameLast\n    fullName\n    phone\n    status\n  }\n"]);return c=function(){return n},n}function l(){var n=(0,r.Z)(["\n  mutation SendGoogleAuthCode($code: String!, $id: Int!, $type: String!) {\n    createGoogleToken(code: $code, id: $id, type: $type) {\n      success\n      tokens\n      error\n    }\n  }\n"]);return l=function(){return n},n}function m(){var n=(0,r.Z)(["\n  mutation GenerateMSURL($type: String!, $id: Int!) {\n    genenrateMSURL(id: $id, type: $type) {\n      url\n    }\n  }\n"]);return m=function(){return n},n}function p(){var n=(0,r.Z)(["\n  mutation signoutMS($id: Int!, $type: String!, $email: String!) {\n    signoutMS(id: $id, type: $type, email: $email) {\n      error\n      msId\n      success\n    }\n  }\n"]);return p=function(){return n},n}function f(){var n=(0,r.Z)(["\n  query getAccountMeta($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      meta\n    }\n  }\n"]);return f=function(){return n},n}function v(){var n=(0,r.Z)(["\n  query user($id: Int!) {\n    user: User_by_pk(id: $id) {\n      meta\n      invoiceThreshold\n      quoteThreshold\n    }\n  }\n"]);return v=function(){return n},n}function h(){var n=(0,r.Z)(["\n  query GetAccountUserMeta($userId: Int!, $accountId: Int!) {\n    accountUser: Account_User(where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }) {\n      meta\n    }\n  }\n"]);return h=function(){return n},n}function g(){var n=(0,r.Z)(["\n  mutation UpdateAccountUserByUserIdAccoutId(\n    $userId: Int!\n    $accountId: Int!\n    $changes: Account_User_set_input!\n  ) {\n    update_Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n      _set: $changes\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return g=function(){return n},n}function y(){var n=(0,r.Z)(["\n  mutation updateAccount($accountId: Int!, $set: Account_set_input!) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $set) {\n      id\n    }\n  }\n"]);return y=function(){return n},n}function _(){var n=(0,r.Z)(["\n  mutation updateUserMeta($userId: Int!, $meta: jsonb!) {\n    update_User_by_pk(pk_columns: { id: $userId }, _set: { meta: $meta }) {\n      id\n      meta\n    }\n  }\n"]);return _=function(){return n},n}function I(){var n=(0,r.Z)(['\n  query userDevices($accountId: Int!) {\n    users: User(\n      where: {\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        UserDevices: { status: { _eq: "active" } }\n        status: { _eq: "active" }\n      }\n    ) {\n      id\n      fullName\n      devices: UserDevices(\n        order_by: { updatedAt: desc_nulls_last }\n        where: { status: { _eq: "active" } }\n        limit: 1\n      ) {\n        id\n        playerId\n      }\n    }\n  }\n']);return I=function(){return n},n}function b(){var n=(0,r.Z)(['\n  query GetAccountLocations($accountId: Int, $limit: Int, $offset: Int) {\n    location: Location(\n      offset: $offset\n      limit: $limit\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      id\n      name\n      accountLocations: Account_Locations {\n        id\n      }\n      addresses: Addresses(where: { entity: { _eq: "Location" }, registered: { _eq: true } }) {\n        id\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          postCode\n        }\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']);return b=function(){return n},n}function $(){var n=(0,r.Z)(["\n  mutation InsertUserAccountLocations(\n    $accountUserId: Int!\n    $objects: [User_Account_Location_insert_input!]!\n  ) {\n    delete_User_Account_Location(where: { accountUserId: { _eq: $accountUserId } }) {\n      affected_rows\n    }\n    insert_User_Account_Location(objects: $objects) {\n      affected_rows\n      returning {\n        id\n      }\n    }\n  }\n"]);return $=function(){return n},n}var A=(0,i.Ps)(o()),S=(0,i.Ps)(a()),x=(0,i.Ps)(u()),Z=(0,i.Ps)(s()),q=(0,i.Ps)(d()),U=(0,i.Ps)(c()),j=(0,i.Ps)(l()),w=(0,i.Ps)(m()),C=(0,i.Ps)(p()),P=(0,i.Ps)(f()),N=(0,i.Ps)(v()),D=(0,i.Ps)(h()),k=(0,i.Ps)(g()),T=(0,i.Ps)(y()),O=(0,i.Ps)(_()),L=(0,i.Ps)(I()),M=(0,i.Ps)(b()),F=(0,i.Ps)($())},59577:function(n,e,t){"use strict";t.d(e,{c:function(){return r}});var r=function(n){try{return JSON.parse(n)}catch(e){return!1}}},3728:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return H}});var r=t(85893),i=t(67294),o=t(11163),a=t.n(o),u=t(73987),s=t(26042),d=t(69396),c=t(828),l=t(6812),m=t(73359),p=t(5616),f=t(11057),v=t(98456),h=t(90629),g=t(51233),y=t(15861),_=t(57460),I=t.n(_),b=t(45697),$=t.n(b),A=t(53767),S=t(74944),x=t(12632),Z=t(26186),q=function(n){var e=n.data,t=n.isCSV,r=n.isAdmin,i=n.type;return e.map(function(n){var e,o,a,u,c,l,m,p,f,v,h,g,y,_,I,b,$,A,S,x,q,U,j=n.manager?"".concat(n.manager.nameFirst," ").concat(n.manager.nameLast):"Unassigned",w=n.scheduledAt?(0,Z.Z)(n.scheduledAt,!0):(0,Z.Z)(n.timingStart,!0),C=t&&(null==n?void 0:n.supplierOffers.length)>0?null===(e=null==n?void 0:n.supplierOffers[0].supplier)||void 0===e?void 0:e.name:null,P="bookings"===i||t?(null===(o=n.sublocation)||void 0===o?void 0:o.name)||"-":void 0,N=t?null==n?void 0:null===(a=n.tags)||void 0===a?void 0:a.map(function(n){var e;return null==n?void 0:null===(e=n.tag)||void 0===e?void 0:e.name}):null==n?void 0:n.tags;return(0,d.Z)((0,s.Z)({id:n.id,type:n.type,number:n.number,invoiceNumber:null===(u=n.invoices)||void 0===u?void 0:null===(c=u[0])||void 0===c?void 0:c.invoiceNumber,sublocation:P,creator:null===(l=n.timings)||void 0===l?void 0:null===(m=l[0])||void 0===m?void 0:null===(p=m.user)||void 0===p?void 0:p.fullName,propertyId:null===(f=n.location)||void 0===f?void 0:f.id,managerId:null===(v=n.manager)||void 0===v?void 0:v.id,customerId:null===(h=n.customer)||void 0===h?void 0:h.id,priority:(null===(g=n.sla)||void 0===g?void 0:g.name)||"-",supplierId:n.supplier?n.supplier.id:"",service:(null===(y=n.service)||void 0===y?void 0:y.name)||"-",description:(null===(_=n.shortJobDesc)||void 0===_?void 0:null===(I=_[0])||void 0===I?void 0:I.taxonomy.name)||"-",manager:j,location:(null===(b=n.location)||void 0===b?void 0:b.name)||"-",customer:(null===($=n.customer)||void 0===$?void 0:$.name)||"-",customerManager:(null===(A=n.customer)||void 0===A?void 0:null===(S=A.manager)||void 0===S?void 0:S.fullName)||"-"},!t&&{customerManagerId:null===(x=n.customer)||void 0===x?void 0:null===(q=x.manager)||void 0===q?void 0:q.id}),{supplier:n.supplier?n.supplier.name:"-",supplierUser:n.supplierUser?n.supplierUser.fullName:"-",scheduleDate:w,tags:N,date:(0,Z.Z)(n.createdAt),status:(null==n?void 0:n.job)?null===(U=n.job)||void 0===U?void 0:U.status:n.status,offerTo:r?C:"",actions:""})})},U=t(16605),j=t(91027),w=t(29952),C=t(20924),P=t(39831),N=function(n){var e=n.variables,t=n.user,r=n.queryParams,i=n.hasRole,o=r.hasOwnProperty("tileName");if(!e.isChangedStatusSelect)switch(r.show){case"offered":e.status=["offered"];break;case"current":e.status=["accepted","inProgress","pending"];break;case"openJobs":e.status=["raised","pending"];break;case"raised":e.status=["raised"];break;case"pending":e.status=["pending"];break;case"past":e.status=["completed","inDispute","disputeResolved","reportSent","invoiceSent","customerPaid","supplierPaid","closed"];break;default:e.status=r.show}var a=e.limit,u=e.offset,c=e.orderBy,l=e.q,m=e.status,p=e.startDate,f=e.endDate,v=e.type,h=e.number,g=e.userId,y=e.managerId,_=e.locationId,I=e.monthStart,b=e.tagsWhere,$=e.todayStart,A=e.yearStart,S=e.asAt;if(o){var x=g||+r.userId,Z=+r.accountId;return i(["customer","supplier"])&&(x=t.id,Z=t.accountId),{query:(0,C.Z)({tagsWhere:b}),variables:(0,d.Z)((0,s.Z)({},e),{locationId:_||r.locationId,managerId:y||r.managerId,customerManagerId:+r.customerManagerId,accountId:Z,adminId:null==t?void 0:t.adminId,asAt:S,tileName:null==r?void 0:r.tileName,orderBy:c,monthStart:I,dayStart:$,yearStart:A,type:r.type||v,userId:x})}}switch(t.accountType){case"supplier":return{query:P.p7,variables:{limit:a,offset:u,orderBy:c,q:l,status:m,startDate:p,endDate:f,type:v,number:h,userId:g||y}};case"customer":return{query:P.lS,variables:{limit:a,offset:u,orderBy:c,q:l,status:m,type:v,number:h,startDate:p,endDate:f,userId:g||y,locationId:_}};case"tenant":return{query:P.lS,variables:{limit:a,offset:u,orderBy:c,q:l,status:m,type:v,startDate:p,endDate:f}};default:return{query:(0,P.ct)({tagsWhere:b}),variables:(0,s.Z)({},e)}}},D=function(n){var e,t,r;return(0,d.Z)((0,s.Z)({},n),{orderBy:(null==n?void 0:null===(e=n.orderBy)||void 0===e?void 0:e.scheduleDate)?{scheduledAt:null==n?void 0:null===(t=n.orderBy)||void 0===t?void 0:t.scheduleDate,timingStart:null==n?void 0:null===(r=n.orderBy)||void 0===r?void 0:r.scheduleDate}:n.orderBy})},k=t(48795),T=t(59505),O=t(45451),L=t(21830),M=t(81261),F=t(30381),R=t.n(F),W=t(35374),E=t(83162),B=t(79928),z=t(71559),G="/dashboard/issues/",J=function(n){var e,t,u,_,b,$=n.initialFilters,Z=n.type,C=n.title,P=n.subtitle,F=(0,A.q)(),J=(0,S.x)(),V=J.hasRole,X=J.user,H=(0,o.useRouter)().query,K=(0,i.useState)((0,s.Z)({},$)),Q=K[0],Y=K[1],nn=(0,i.useState)(!1),ne=nn[0],nt=nn[1],nr=(0,i.useState)(!1),ni=nr[0],no=nr[1],na=null===(e=F.admin)||void 0===e?void 0:null===(t=e.jobSetting)||void 0===t?void 0:t.jobNumberPrefix,nu=null===(u=F.admin)||void 0===u?void 0:null===(_=u.jobSetting)||void 0===_?void 0:_.jobNumberSuffix,ns=(0,W.s)(),nd=V("admin"),nc=V("customer"),nl=V("tenant"),nm=V("supplier"),np=(0,x.x)({filters:Q}),nf=np.initialData,nv=np.ref,nh=N({variables:(0,d.Z)((0,s.Z)({assetId:null},D(nf)),{monthStart:R()(H.asAt).startOf("month"),todayEnd:R()(H.asAt).endOf("day"),todayStart:R()(H.asAt).startOf("day"),yearStart:R()(H.asAt).startOf("year"),asAt:R()(H.asAt).endOf("day"),number:nf.id?String(nf.id):null,tagsWhere:(0,z.Y)(nf.tags),type:Z}),user:X,queryParams:H,hasRole:V}),ng=nh.query,ny=nh.variables,n_=(0,l.a)(ng,{variables:ny}),nI=n_.data,nb=void 0===nI?{jobs:[],meta:{aggregate:{totalCount:0}}}:nI,n$=nb.jobs,nA=nb.meta,nS=n_.loading,nx=n_.refetch,nZ=(0,c.Z)((0,m.t)(ng,{fetchPolicy:"no-cache",variables:(0,d.Z)((0,s.Z)({},ny),{limit:(null==nA?void 0:null===(b=nA.aggregate)||void 0===b?void 0:b.totalCount)||150}),onCompleted:function(n){var e=n.jobs;try{var t=I().unparse(q({data:e,isCSV:!0,isAdmin:nd})),r="data:application/octet-stream,"+encodeURIComponent(t);(0,U.S)(r,"jobs.csv")}finally{no(!1)}}}),1)[0],nq=function(n){a().push("".concat(G,"manage?id=").concat(n.number))},nU=function(n){return[{context:"secondary",icon:"edit",onClick:function(e){return nq(n)},tooltip:"Edit"},{context:"secondary",icon:"info",onClick:function(e){return a().push("/dashboard/issues/view?id=".concat(n.number))},tooltip:"Info"}]},nj=function(n){n.stopPropagation();var e=(0,j.Uu)(Q);a().push("".concat(G,"manage").concat(e))},nw=function(n){n.stopPropagation(),no(!0),nZ()};return(0,r.jsxs)(g.Z,{width:"100%",spacing:2,sx:{height:"100%"},children:[(0,r.jsxs)(g.Z,{width:"100%",direction:"row",justifyContent:"space-between",children:[(0,r.jsx)(f.Z,{variant:"contained",startIcon:(0,r.jsx)(M.Z,{}),onClick:function(){return nt(!0)},children:"Filters"}),(0,r.jsxs)(g.Z,{direction:"row",spacing:2,children:["reactive"===Z&&(nd||nc)&&(0,r.jsx)(f.Z,{variant:"contained",color:"secondary",onClick:nj,children:"Create Work Order"}),!ns&&(0,r.jsx)(f.Z,{startIcon:!ni&&(0,r.jsx)("img",{src:"/static/icons/csv.svg"}),disabled:ni,variant:"contained",color:"success",onClick:nw,children:ni?(0,r.jsx)(v.Z,{size:20,color:"secondary"}):"Export"})]})]}),(0,r.jsxs)(h.Z,{sx:{paddingTop:"16px",paddingBottom:"16px",height:"calc(100% - 52px)"},children:[(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(y.Z,{ml:2,variant:"h5",sx:{fontWeight:600},children:C}),P&&(0,r.jsx)(y.Z,{typography:"subtitle1",ml:2,children:P})]}),(0,r.jsx)(w.h,{open:ne,setOpen:nt,initialFilters:$,filters:Q,setFilters:Y,filtersVisibilityModel:{sla:(null==H?void 0:H.type)!=="ppm"}}),(0,r.jsx)(O.i,{autoHeight:!1,loading:nS,ref:nv,columns:[{minWidth:60,field:"id",headerName:"Job ID",renderCell:function(n){var e=n.row;return(0,r.jsx)(k.D,{id:e.id,number:e.number,openCanvas:!0,type:e.type,numberPrefix:na,numberSuffix:nu})}},{minWidth:60,field:"invoiceNumber",headerName:"Invoice ID",renderCell:function(n){return n.row.invoiceNumber},sortable:!1},{maxWidth:80,field:"priority",headerName:"Priority",sortName:'{"SLA": {"name": "ORDER"}}'},{minWidth:200,field:"service",headerName:"Service",sortName:'{"Service": {"name": "ORDER"}}'},{minWidth:80,field:"type",headerName:"Type",sortable:!0},{minWidth:300,field:"tags",headerName:"Tags",sortable:!1,renderCell:function(n){var e=n.row;return(0,r.jsx)(B.K,{row:e,refetchQueries:["GetJobs","GetDashboardList"],entity:"Job"})}},{minWidth:200,flex:1,field:"description",headerName:"Description",sortable:!1},{minWidth:130,flex:1,field:"manager",headerName:"Assigned to",sortName:'{"Manager": {"nameFirst": "ORDER"}}',renderCell:function(n){var e=n.row;return(0,r.jsx)(E.r,{noWrap:!e.managerId,color:"secondary",href:"/dashboard/users/view?id=".concat(e.managerId),children:e.manager})}},{minWidth:200,flex:1,field:"location",headerName:nc||nm||nl?"Location":"Customer",sortName:'{"Customer": {"name": "ORDER"}}',renderCell:function(n){var e=n.row;return(0,r.jsxs)(g.Z,{children:[nd&&(0,r.jsx)(E.r,{color:"secondary",href:"/dashboard/customers/view?id=".concat(e.customerId),children:e.customer}),(0,r.jsx)(E.r,{noWrap:nm||nl,color:"secondary",href:"/dashboard/properties/view?id=".concat(e.propertyId),children:e.location})]})}},{minWidth:180,flex:1,field:"customerManager",headerName:"Account Manager",sortName:'{"Customer": {"Manager": {"fullName": "ORDER"}}}',renderCell:function(n){var e=n.row;return(0,r.jsx)(E.r,{noWrap:!e.customerManagerId,color:"secondary",href:"/dashboard/users/view?id=".concat(e.customerManagerId),children:e.customerManager})}},{minWidth:140,flex:1,field:"supplier",headerName:"Supplier",sortName:'{"Supplier": {"name": "ORDER"}}',renderCell:function(n){var e=n.row;return(0,r.jsx)(E.r,{color:"secondary",href:"/dashboard/suppliers/view?id=".concat(e.supplierId),children:e.supplier})}},{flex:1,minWidth:120,field:"supplierUser",headerName:"Assigned to",sortName:'{"SupplierUser": {"nameFirst": "ORDER"}}'},{minWidth:160,field:"scheduleDate",headerName:"Scheduled",sortable:!0},{minWidth:120,flex:1,field:"date",headerName:"Created",sortName:"createdAt"},{minWidth:120,flex:1,field:"status",headerName:"Status",renderCell:function(n){var e,t,i=n.row;return(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(p.Z,{children:(0,r.jsx)(T.B,{value:i.status})}),nd&&"offered"===i.status&&i.offerTo&&i.offerTo.length>0&&(0,r.jsx)(E.r,{color:"secondary",href:"/dashboard/suppliers/view?id=".concat(null===(e=i.offerTo[0].supplier)||void 0===e?void 0:e.id),children:null===(t=i.offerTo[0].supplier)||void 0===t?void 0:t.name})]})}},{width:50,field:"actions",headerName:"",sortable:!1,renderCell:function(n){var e=n.row;return(0,r.jsx)(L.C,{actionsData:nU,row:e})}}],rows:q({data:n$,isCSV:!1,isAdmin:nd}),meta:nA,refetch:nx,containerHeight:"calc(100% - ".concat(P?52:32,"px)"),columnVisibilityModel:{priority:!("ppm"===Z||nc||nm),manager:nd,customerManager:nd,supplier:nd,supplierUser:nm,actions:nd,tags:nd}})]})]})};J.defaultProps={initialFilters:{},type:"reactive",title:"",subtitle:""},J.propTypes={initialFilters:$().object,type:$().oneOf(["reactive","ppm"]),title:$().string,subtitle:$().string};var V=t(24716),X=function(){var n,e,t=(0,i.useContext)(u.Z).user,s=(0,o.useRouter)().query;if(!t)return a().push("/account/sign-in"),null;var d=null;return d="ppm"===s.type?(0,r.jsx)(J,{type:"ppm",title:null!==(n=null==s?void 0:s.title)&&void 0!==n?n:"Find PPM",subtitle:null==s?void 0:s.subtitle,initialFilters:K}):(0,r.jsx)(J,{type:"reactive",title:null!==(e=null==s?void 0:s.title)&&void 0!==e?e:"Work Orders",subtitle:null==s?void 0:s.subtitle,initialFilters:Q}),(0,r.jsx)(V.Z,{children:d})};X.getLayout=function(n){return n};var H=X,K={customerId:null,endDate:null,id:null,locationId:null,managerId:null,q:null,startDate:null,status:[],supplierId:null,userId:null,tags:null,customerManagerId:null,isChangedStatusSelect:!1,filterType:"reactive_table"},Q={customerId:null,endDate:null,id:null,meta:null,locationId:null,managerId:null,q:null,startDate:null,status:[],supplierId:null,userId:null,tags:null,customerManagerId:null,isChangedStatusSelect:!1,filterType:"ppm_table"}}},function(n){n.O(0,[3662,2283,212,8890,9511,2583,6310,4599,4135,8579,4244,3776,1564,2329,778,1023,3911,9957,3425,1870,8062,2429,5497,5117,4551,4716,8359,6937,4664,9774,2888,179],function(){return n(n.s=83035)}),_N_E=n.O()}]);