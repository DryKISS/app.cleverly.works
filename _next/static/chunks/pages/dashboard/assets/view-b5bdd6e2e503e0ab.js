(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6872,7493],{86432:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/assets/view",function(){return t(34e3)}])},21830:function(e,n,t){"use strict";t.d(n,{C:function(){return P}});var i=t(85893),o=t(67294),r=t(45697),a=t.n(r),s=t(93946),l=t(25464),d=t(18972),c=t(57976),u=t(73890),m=t(69008),p=t(41687),h=t(60888),f=t(40535),x=t(63441),v=t(41733),g=t(77957),y=t(2548),b=t(24519),Z=t(2391),j=t(69308),w=t(79369),C=t(22961),I=t(28201),q=t(51233),$=t(15861),_={add:(0,i.jsx)(p.Z,{}),archive:(0,i.jsx)(u.Z,{}),avatar:(0,i.jsx)(I.Z,{}),check:(0,i.jsx)(h.Z,{}),delete:(0,i.jsx)(v.Z,{}),description:(0,i.jsx)(f.Z,{}),download:(0,i.jsx)(x.Z,{}),info:(0,i.jsx)(y.Z,{}),edit:(0,i.jsx)(g.Z,{}),location:(0,i.jsx)(j.Z,{}),unarchive:(0,i.jsx)(m.Z,{}),uploadFile:(0,i.jsx)(b.Z,{}),receipt:(0,i.jsx)(Z.Z,{}),visibility:(0,i.jsx)(C.Z,{})},S={default:(0,i.jsx)(c.Z,{}),defaultHoriz:(0,i.jsx)(w.Z,{}),description:(0,i.jsx)(f.Z,{})},P=function(e){var n=e.actionsData,t=e.icon,r=e.row,a=e.disabled,c=(0,o.useState)(null),u=c[0],m=c[1],p=function(e){e.stopPropagation(),m(e.currentTarget)},h=function(){m(null)};return(0,i.jsxs)("div",{children:[(0,i.jsx)(s.Z,{sx:{":hover":{backgroundColor:"#DDDDDD"}},disabled:a,"aria-controls":"simple-menu","aria-haspopup":"true",onClick:p,children:S[t]}),(0,i.jsx)(l.Z,{id:"simple-menu",anchorEl:u,keepMounted:!0,open:Boolean(u),onClose:h,PaperProps:{sx:{borderRadius:2}},children:n(r).map(function(e,n){return(0,i.jsx)(d.Z,{disabled:e.disabled,onClick:function(n){e.onClick(n),h()},sx:{pl:3,pr:4},children:(0,i.jsxs)(q.Z,{direction:"row",alignItems:"center",spacing:2,children:[(null==_?void 0:_[e.icon])||null,(0,i.jsx)($.Z,{children:e.tooltip})]})},n)})})]})};P.propTypes={actionsData:a().func.isRequired,icon:a().oneOf(["default","description"]),row:a().any.isRequired,disabled:a().bool},P.defaultProps={actionsData:function(){return[{disabled:!1,onClick:function(){},icon:"edit",tooltip:"Edit"}]},icon:"default",disabled:!1}},4595:function(e,n,t){"use strict";t.d(n,{F:function(){return $}});var i=t(14924),o=t(26042),r=t(69396),a=t(85893),s=t(45697),l=t.n(s),d=t(10166),c=t(80482),u=t(23776),m=t(98456),p=t(16143),h=t(50135),f=t(99534),x=t(29815),v=t(74061),g=t(6498),y=t(75438),b=t(15861),Z=t(61730),j=t(67294),w=(0,j.createContext)({}),C=(0,j.forwardRef)(function(e,n){var t=(0,j.useContext)(w);return(0,a.jsx)("div",(0,o.Z)({ref:n},e,t))}),I=(0,j.forwardRef)(function(e,n){var t=e.children,i=(0,f.Z)(e,["children"]),o=[];t.forEach(function(e){o.push(e),o.push.apply(o,(0,x.Z)(e.children||[]))});var r,s,l=(0,g.u)(),d=(0,Z.Z)(l.breakpoints.up("sm"),{noSsr:!0}),c=o.length,u=d?36:48,m=function(e){return e.hasOwnProperty("group")?48:u},p=(s=(0,j.useRef)(null),(0,j.useEffect)(function(){null!=s.current&&s.current.resetAfterIndex(0,!0)},[c]),s);return(0,a.jsx)("div",{ref:n,children:(0,a.jsx)(w.Provider,{value:i,children:(0,a.jsx)(v.S_,{itemData:o,height:(c>8?8*u:o.map(m).reduce(function(e,n){return e+n},0))+16,width:"100%",ref:p,outerElementType:C,innerElementType:"ul",itemSize:function(e){return m(o[e])},overscanCount:5,itemCount:c,children:q})})})});function q(e){var n=e.data,t=e.index,i=e.style,s=n[t],l=(0,r.Z)((0,o.Z)({},i),{top:i.top+8});return s.hasOwnProperty("group")?(0,a.jsx)(y.Z,{component:"div",style:l,children:s.group},s.key):(0,a.jsx)(b.Z,(0,r.Z)((0,o.Z)({component:"li"},s[0]),{noWrap:!0,style:l,children:s[1].label}))}var $=function(e){var n=e.label,t=e.loading,i=e.placeholder,s=e.error,l=e.helperText,d=e.inputProps;return(0,a.jsx)(S,(0,r.Z)((0,o.Z)({},e),{disableListWrap:!0,PopperComponent:_,ListboxComponent:I,renderInput:function(e){return(0,a.jsx)(h.Z,(0,r.Z)((0,o.Z)({},e,d),{error:s,helperText:l,label:n,placeholder:i,color:"secondary",variant:"standard",InputProps:(0,r.Z)((0,o.Z)({},e.InputProps,(null==d?void 0:d.InputProps)||{}),{endAdornment:(0,a.jsxs)(a.Fragment,{children:[t?(0,a.jsx)(m.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))},renderOption:function(e,n,t){return[e,n,t.index]},renderGroup:function(e){return e}}))};$.defaultProps={value:null,onChange:function(){},label:"",loading:!1,error:!1,onOpen:function(){},options:[],inputProps:{},withoutSelectIcon:!1},$.propTypes={value:l().shape({value:l().any,label:l().string}),onChange:l().func,label:l().string,loading:l().bool,onOpen:l().func,options:l().arrayOf(l().shape({value:l().any,label:l().string})),inputProps:l().object,withoutSelectIcon:l().bool,inputValue:l().string,onInputChange:l().func};var _=(0,d.Z)(p.Z)((0,i.Z)({zIndex:"12000 !important"},"& .".concat(c.Z.listbox),{boxSizing:"border-box","& ul":{padding:0,margin:0}})),S=(0,d.Z)(u.Z)(function(e){var n=e.withoutSelectIcon;return{"& .MuiAutocomplete-root":{cursor:"pointer"},"& .MuiAutocomplete-popper":{zIndex:"12000 "},"& .MuiAutocomplete-endAdornment":{"& .MuiButtonBase-root.MuiIconButton-root.MuiAutocomplete-popupIndicator":{"& .MuiSvgIcon-root":(0,o.Z)({},n&&{display:"none"})}}}})},57779:function(e,n,t){"use strict";t.d(n,{G:function(){return O}});var i=t(26042),o=t(69396),r=t(85893),a=t(45697),s=t.n(a),l=t(6812),d=t(92711),c=t(45451),u=t(11013),m=t(3770),p=t(452),h=t(40826),f=function(e,n){var t=function(){return(0,r.jsx)(h.Z,{context:"success",icon:"check",size:"sm",title:"Yes"})},i=function(){return(0,r.jsx)(h.Z,{context:"warning",icon:"times",size:"sm",title:"No"})},o=function(){return(0,r.jsx)(h.Z,{context:"dark",icon:"minus",size:"sm",title:"Unavailable"})};return"image"===e?(null==n?void 0:n.thumbnails)&&(null==n?void 0:n.thumbnails.length)?t:i:o},x=t(12632),v=t(74944),g=t(86532),y=t(22797),b=t(38895),Z=t(5616),j=t(11057),w=t(51233),C=t(21023),I=t(15861),q=t(14924),$=t(70872),_=t(58886),S=t(90948),P=t(67294),M=t(77314),A=(0,t(42850).bH)(M.ZP),k=function(e){var n=e.images,t=e.showPagination,o=e.height,a=(0,P.useState)(0),s=a[0],l=a[1],d=function(e){l(e)};return(0,r.jsxs)(w.Z,{width:"100%",alignItems:"center",children:[(0,r.jsx)(A,{index:s,onChangeIndex:d,enableMouseEvents:!0,interval:1e4,children:n.map(function(e){return(0,r.jsx)(Z.Z,{component:"img",sx:{height:o,display:"block",overflow:"hidden",width:"100%",objectFit:"cover"},src:e.filename,alt:e.caption},e.caption)})}),t&&n.length>1&&(0,r.jsx)(R,{page:s+1,count:n.length,onChange:function(e,n){return d(n-1)},variant:"outlined",shape:"rounded",renderItem:function(e){return(0,r.jsx)(_.Z,(0,i.Z)({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},e))}})]})};k.defaultProps={images:[],showPagination:!0},k.propTypes={height:s().oneOfType([s().string,s().number]),images:s().arrayOf(s().shape({caption:s().string,filename:s().string.isRequired}).isRequired).isRequired,showPagination:s().bool};var R=(0,S.ZP)($.Z)(function(e){e.hidePrevButton,e.hideNextButton;var n,t=e.theme;return n={},(0,q.Z)(n,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,q.Z)(n,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,q.Z)(n,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,q.Z)(n,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,q.Z)(n,"& button.Mui-selected",{color:t.palette.white.main,backgroundColor:t.palette.secondary.main}),n}),T=t(27434),D=t(21830),E=t(83162),F=t(74492),O=function(e){var n=e.carousel,t=e.category,a=e.data,s=e.entity,h=e.entityId,q=e.filters,$=e.listView,_=e.mediaMeta,S=e.onMediaAdd,P=e.onMediaRemove,M=e.showActionButtons,A=e.showEntityColumn,R=e.showItemActions,O=e.title,N=e.type,B=e.expanded,G=e.onChangeExpanded,L=e.hideExpandIcon,z=e.mediaFormProps,U=e.offCanvasProps,H=e.onlySingleMedia,W=e.elevation,Y=e.accordionSx,Q=e.refetch,V=(0,x.x)({filters:q}),J=V.initialData,X=V.ref,K=(0,v.x)(),ee=K.hasRole,en=K.user,et=(0,F.a)(),ei=(0,l.a)(d.t,{variables:(0,o.Z)((0,i.Z)({},J),{entity:s,entityId:h,category:t,adminId:en.adminId,meta:_})}),eo=ei.data,er=void 0===eo?{items:[],meta:{aggregate:{totalCount:0}}}:eo,ea=er.items,es=er.meta,el=ei.loading,ed=ei.refetch,ec=function(e){et.close(),a.length||ed();var n=e.map(function(e){return(0,o.Z)((0,i.Z)({},e),{link:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(e.filename)})});S&&S(n),Q&&Q()},eu=function(e){et.close(),a.length||ed(),P&&P(e),Q&&Q()},em=function(e){e.stopPropagation(),et.show((0,i.Z)({content:(0,r.jsx)(p.z,(0,i.Z)({accept:"image/*",adminId:en.adminId,category:t,entity:s,entityId:h,expiryShow:!1,mediaMeta:_,multiple:!0,onSuccess:ec,type:"image"},z)),title:"Upload Photos"},U))},ep=function(e){e.stopPropagation(),et.show((0,i.Z)({content:(0,r.jsx)(p.z,(0,i.Z)({accept:".pdf, .doc, .docx, .xlsx",adminId:en.adminId,category:t,entity:s,entityId:h,expiryShow:!1,mediaMeta:_,onSuccess:ec,type:"document"},z)),title:"Upload Documents"},U))},eh=function(e){et.show({content:(0,r.jsx)(u.d,{mediaId:e.data.id,onSuccess:eu}),submit:!1,title:"Delete Media"})},ef=function(e){et.show({content:(0,r.jsx)(m.z,{media:e.data,toggleShow:et.close}),title:"Media Details"})},ex=function(e){return[{context:"primary",icon:"info",onClick:function(n){return ef(e)},tooltip:"Details"},{context:"danger",icon:"delete",onClick:function(n){return eh(e)},tooltip:"Delete"}]},ev=[{field:"file",headerName:"File",flex:1,sortable:!1,renderCell:function(e){var n=e.row,t=e.value;return(0,r.jsx)(E.r,{color:"secondary",onClick:function(e){e.preventDefault(),window.open("".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(n.filename))},children:t})}},{field:"visibility",headerName:"Visible to",flex:1,sortable:!1},{hide:!A,field:"entity",headerName:"Entity",flex:1,sortable:!1},{field:"authority",headerName:"",width:50,sortable:!1,renderCell:function(e){var n=e.value;return(0,r.jsx)(r.Fragment,{children:(null==n?void 0:n.adminOnly)&&(0,r.jsx)(C.Z,{title:"Admin user only",children:(0,r.jsx)(Z.Z,{component:"img",alt:"Admin Only",src:"/messaging/admin-only.svg",sx:{height:"24px"}})})})}},{field:"uploaded",headerName:"Uploaded by",flex:1,sortable:!1},{hide:!$,field:"thumbnails",headerName:"Thumbnails",flex:1,sortable:!1,renderCell:function(e){var n=e.value;return"function"==typeof n?n():n}},{hide:!R,field:"actions",headerName:"",width:50,sortable:!1,renderCell:function(e){var n=e.row;return ee("admin")?(0,r.jsx)(D.C,{actionsData:ex,row:n}):en.id===n.userId?(0,r.jsx)(D.C,{actionsData:ex,row:n}):null}}],eg=[],ey=ea.filter(function(e){var n=e.item;return(null==n?void 0:n.visibility)&&ee(null==n?void 0:n.visibility)}).map(function(e){var n=e.entity,t=e.entityId,i=e.id,o=e.item,r=o.caption,a=o.filename,s=o.meta,l=o.name,d=o.type,c=o.user,u=o.visibility;return{data:o,id:i,userId:null==c?void 0:c.id,filename:a,visibility:u.join(", "),file:r||l||a,entity:n&&"".concat(n,"#").concat(t),authority:s,uploaded:"".concat(null==c?void 0:c.nameFirst," ").concat(null==c?void 0:c.nameLast),thumbnails:f(d,s),actions:""}}),eb=(ea.filter(function(e){var n=e.item;return(null==n?void 0:n.visibility)&&ee(null==n?void 0:n.visibility)}).forEach(function(e){var n=e.item,t=n.caption,i=n.filename;"image"===n.type&&eg.push({caption:t,filename:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(i)})}),eg),eZ=eb.length;return(0,r.jsxs)(g.Z,{elevation:W,expanded:B,onChange:G,sx:Y,children:[(0,r.jsx)(b.Z,(0,o.Z)((0,i.Z)({},L?{}:{expandIcon:(0,r.jsx)(T.Z,{})}),{children:(0,r.jsx)(I.Z,{variant:"h6",children:O})})),(0,r.jsxs)(y.Z,{children:[n&&eZ>0&&(0,r.jsx)(k,{height:"200px",images:eb}),(0,r.jsx)(c.i,{columns:ev,rows:ey,loading:el,meta:es,ref:X,refetch:ed,columnVisibilityModel:{entity:A,thumbnails:$,actions:R}}),M&&!(H&&ey.length>0)&&(0,r.jsxs)(w.Z,{direction:"row",justifyContent:"center",spacing:2,mt:2,children:[(!N||"document"===N)&&(0,r.jsx)(j.Z,{variant:"contained",color:"secondary",onClick:ep,children:"Add Document"}),(!N||"image"===N||"avatar"===N)&&(0,r.jsxs)(j.Z,{variant:"contained",color:"secondary",onClick:em,children:["Add ",N?"".concat(N.charAt(0).toUpperCase()).concat(N.slice(1)):"Image"]})]})]})]})};O.propTypes={carousel:s().bool,category:s().string,data:s().array,entity:s().string,entityId:s().number,filters:s().object,listView:s().bool,mediaMeta:s().object,onMediaAdd:s().func,onMediaRemove:s().func,showActionButtons:s().bool,showEntityColumn:s().bool,showItemActions:s().bool,title:s().string,type:s().string,expanded:s().bool,onChangeExpanded:s().func,hideExpandIcon:s().bool,mediaFormProps:s().object,offCanvasProps:s().object,onlySingleMedia:s().bool,elevation:s().number,accordionSx:s().object,refetch:s().func},O.defaultProps={carousel:!0,data:[],filters:{},listView:!1,mediaMeta:null,showActionButtons:!0,showEntityColumn:!1,showItemActions:!0,title:"Media",type:null,onChangeExpanded:function(){},mediaFormProps:{},offCanvasProps:{},category:"media",onlySingleMedia:!1,elevation:1,accordionSx:{},refetch:function(){}}},97637:function(e,n,t){"use strict";t.d(n,{G:function(){return k}});var i=t(26042),o=t(69396),r=t(7297),a=t(85893),s=t(67294),l=t(45697),d=t(6812),c=t(92711),u=t(10367),m=t(78289),p=t(41564),h=t(34953),f=t(62466),x=t(68956),v=t(73373),g=t(11585),y=t(18678),b=t(55377),Z=t(16551),j=t(77439),w=t(74297),C=t(11013),I=t(3770),q=t(452),$=t(71072),_=t(87336),S=t(12632),P=t(74944);function M(){var e=(0,r.Z)(["\n  width: 24px;\n"]);return M=function(){return e},e}function A(){var e=(0,r.Z)(["\n  border: 1px solid #eee;\n"]);return A=function(){return e},e}var k=function(e){var n=e.carousel,t=e.category,r=e.children,l=e.data,u=(e.details,e.entity),M=e.entityId,A=e.filters,k=(e.limit,e.listView),D=e.mediaMeta,E=e.onMediaAdd,F=e.onMediaRemove,O=(e.pagination,e.showActionButtons),N=e.showEntityColumn,B=e.showItemActions,G=e.summary,L=e.type,z=(0,S.x)({filters:A}),U=z.initialData,H=z.ref,W=(0,P.x)(),Y=W.hasRole,Q=W.user,V=(0,s.useContext)(m.Z),J=(0,d.a)(c.t,{variables:(0,o.Z)((0,i.Z)({},U),{entity:u,entityId:M,category:t,adminId:Q.adminId,meta:D})}),X=J.data,K=void 0===X?{items:[],meta:{aggregate:{totalCount:0}}}:X,ee=K.items,en=K.meta,et=J.loading,ei=J.refetch,eo=function(e){V.close(),l.length||ei(),E&&E(e)},er=function(e){V.close(),l.length||ei(),F&&F(e)},ea=function(e){e.stopPropagation(),V.show({content:(0,a.jsx)(q.z,{accept:"image/*",adminId:Q.adminId,category:t,entity:u,entityId:M,expiryShow:!1,mediaMeta:D,multiple:!0,onSuccess:eo,type:"image"}),title:"Upload Photos"})},es=function(e){e.stopPropagation(),V.show({content:(0,a.jsx)(q.z,{accept:".pdf, .doc, .docx, .xlsx",adminId:Q.adminId,category:t,entity:u,entityId:M,expiryShow:!1,mediaMeta:D,onSuccess:eo,type:"document"}),title:"Upload Documents"})},el=function(e){V.show({content:(0,a.jsx)(C.d,{mediaId:e.data.id,onSuccess:er}),submit:!1,title:"Delete Media"})},ed=function(e){V.show({content:(0,a.jsx)(I.z,{media:e.data,toggleShow:V.close}),submit:!1,title:"Media Details",width:"50%"})},ec=[{context:"primary",icon:["fas","info-circle"],onClick:function(e,n){return ed(n)},tooltip:"Details"}];Y("admin")&&ec.push({context:"danger",icon:["fas","trash"],onClick:function(e,n){return el(n)},tooltip:"Delete"});var eu=[{hidden:!0},{hidden:!0},{hidden:!0,text:"Caption"},{hidden:!1,text:"File"},{hidden:!N,text:"Entity"},{formatter:function(e){var n,t=e.row;return(0,a.jsx)(R,{children:(null==t?void 0:null===(n=t.authority)||void 0===n?void 0:n.adminOnly)&&(0,a.jsx)(p.Z,{content:"Admin user only",children:(0,a.jsx)(h.Z,{alt:"Admin Only",src:"/messaging/admin-only.svg"})})})},text:"",tooltip:"Only Admin can see"},{formatter:(0,f.Z)("/dashboard/users/view","userId","uploaded"),text:"Uploaded by"},{hidden:!k,text:"Thumbnails"},{hidden:!B,formatter:x.Z,formatterData:ec,text:"Actions"}],em=function(e,n){e.preventDefault(),window.open("".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(n))},ep=[],eh=ee.map(function(e){var n=e.entity,t=e.entityId,i=e.id,o=e.item,r=o.caption,s=o.filename,l=o.meta,d=o.name,c=o.type,u=o.user;return{data:o,id:i,userId:null==u?void 0:u.id,file:function(){return(0,a.jsx)(v.Z,{onClick:function(e){return em(e,s)},children:r||d||s})},entity:n&&"".concat(n,"#").concat(t),authority:l,uploaded:"".concat(null==u?void 0:u.nameFirst," ").concat(null==u?void 0:u.nameLast),thumbnails:(0,$.S)(c,l),actions:""}}),ef=(ee.forEach(function(e){var n=e.item,t=n.caption,i=n.filename;"image"===n.type&&ep.push({caption:t,filename:i})}),ep),ex=ef.length;return(0,a.jsxs)(g.Z,{fitParentHeight:!0,open:!0,title:G,children:[r,n&&ex>0&&(0,a.jsx)(T,{children:(0,a.jsx)(y.Z,{fullWidth:!0,height:"200px",numberOfItems:1,showNavs:!1,showPagination:!0,slides:ef.map(function(e){var n=e.caption,t=e.filename;return{node:(0,a.jsx)(h.Z,{alt:n,src:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(t)}),text:" "}})})}),(0,a.jsx)(_.t,{columns:eu,loading:et,fullHeight:!0,paginationSize:!1,meta:en,ref:H,refetch:ei,rows:eh}),O&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{size:"sm"}),(0,a.jsxs)(Z.Z,{align:"flex-end",children:[(!L||"document"===L)&&!Y("supplier")&&(0,a.jsx)(j.Z,{content:"Add Document",context:"secondary",onClick:es,size:"sm"}),(!L||"image"===L||"avatar"===L)&&!Y("supplier")&&(0,a.jsx)(j.Z,{content:"Add ".concat((0,w.Z)(L||"Image")),context:"secondary",onClick:ea,size:"sm"})]})]})]})},R=u.ZP.div.withConfig({displayName:"table__StyledIcon",componentId:"sc-fc77535-0"})(M()),T=u.ZP.div.withConfig({displayName:"table__StyledCarousel",componentId:"sc-fc77535-1"})(A());k.propTypes={carousel:l.bool,category:l.string,children:l.node,data:l.array,details:l.bool,entity:l.string,entityId:l.number,filters:l.object,limit:l.number,listView:l.bool,mediaMeta:l.object,onMediaAdd:l.func,onMediaRemove:l.func,pagination:l.object,showActionButtons:l.bool,showEntityColumn:l.bool,showItemActions:l.bool,summary:l.string,type:l.string},k.defaultProps={carousel:!0,category:null,data:[],details:!1,filters:{},limit:20,listView:!1,mediaMeta:null,showActionButtons:!0,showEntityColumn:!1,showItemActions:!0,summary:"Media",type:null}},69297:function(e,n,t){"use strict";t.d(n,{E:function(){return x}});var i=t(26042),o=t(69396),r=t(85893),a=t(45697),s=t.n(a),l=t(94054),d=t(50480),c=t(56815),u=t(40476),m=t(79717),p=t(36872),h=t(51233),f=t(15861),x=function(e){var n=e.label,t=e.options,a=e.error,s=e.helperText,x=e.stackProps,g=e.formControlProps,y=e.labelLeft,b=function(e){var n=e.children;return(0,r.jsx)(r.Fragment,{children:n})};return(0,r.jsxs)(l.Z,(0,o.Z)((0,i.Z)({sx:{m:3},error:a,variant:"standard"},void 0===g?{}:g),{children:[(0,r.jsxs)(h.Z,(0,o.Z)((0,i.Z)({},y&&v),{children:[n&&(0,r.jsx)(u.Z,{id:"radio-group",color:"secondary",children:n}),(0,r.jsx)(m.Z,(0,o.Z)((0,i.Z)({},e),{"aria-labelledby":"radio-group",children:(0,r.jsx)(h.Z,(0,o.Z)((0,i.Z)({},void 0===x?{}:x),{children:t.map(function(e){var n=e.value,t=e.label,i=e.icon,o=e.ParentComponent;return(0,r.jsx)(void 0===o?b:o,{children:(0,r.jsx)(d.Z,{value:n,control:(0,r.jsx)(p.Z,{color:"secondary"}),label:(0,r.jsxs)(h.Z,{direction:"row",alignItems:"center",spacing:1,children:[i,(0,r.jsx)(f.Z,{children:t})]})})})})}))}))]})),(0,r.jsx)(c.Z,{children:s})]}))};x.defaultProps={options:[],error:!1,helperText:"",stackProps:{},formControlProps:{},labelLeft:!1},x.propTypes={label:s().string,options:s().arrayOf(s().shape({label:s().string.isRequired,value:s().any.isRequired,ParentComponent:s().elementType})).isRequired,error:s().bool,helperText:s().string,stackProps:s().object,formControlProps:s().object,labelLeft:s().bool};var v={direction:"row",alignItems:"center",flexWrap:"wrap",spacing:1}},23789:function(e,n,t){"use strict";t.d(n,{CX:function(){return A},UH:function(){return Z}});var i=t(85893),o=t(84059),r=t(45697),a=t.n(r),s=t(51233),l=t(11057),d=t(86532),c=t(22797),u=t(38895),m=t(15861),p=t(5616),h=t(27434),f=t(63441),x=t(35374),v=t(67294),g=l.Z,y=function(e){var n=e.id,t=e.value,r=e.isExpandedByDefault,a=e.collapsible,l=(0,x.a)(),y=(0,v.useState)(r),Z=y[0],j=y[1],w=function(){return j(function(e){return!e})},C=function(e){e.stopPropagation();var t=document.querySelector("#qr-".concat(n," > canvas")).toDataURL(),i=document.createElement("a");i.href=t,i.download="".concat(n,".png"),document.body.appendChild(i),i.click(),document.body.removeChild(i)},I=(0,v.useMemo)(function(){var e={Main:s.Z,Header:s.Z,Body:s.Z};return a&&(e={Main:d.Z,Header:u.Z,Body:c.Z}),e},[a]);return(0,i.jsx)(p.Z,{children:(0,i.jsxs)(I.Main,{expanded:Z,onChange:w,children:[(0,i.jsx)(I.Header,{expandIcon:(0,i.jsx)(h.Z,{}),children:(0,i.jsxs)(s.Z,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(m.Z,{variant:"h6",children:"QR Code"}),(0,i.jsx)(g,{disabled:l,disableMinWidth:!0,size:"small",color:"info",variant:"contained",onClick:C,sx:b.downloadButton,children:(0,i.jsx)(f.Z,{sx:b.downloadIcon})})]})}),(0,i.jsx)(I.Body,{sx:b.body,children:(0,i.jsx)(s.Z,{id:"qr-".concat(n),alignItems:"center",children:(0,i.jsx)(o.Qd,{bgColor:"#ffffff",fgColor:"#000000",value:t,level:"H",size:256})})})]})})},b={downloadIcon:{height:"17px",width:"17px"},downloadButton:{mr:2},body:{marginTop:"20px"}};y.propTypes={id:a().string,value:a().string,isExpandedByDefault:a().bool,collapsible:a().bool},y.defaultProps={id:"new-qr-code",isExpandedByDefault:!1,collapsible:!0};var Z=y,j=t(93946),w=t(78394),C=function(e){var n=e.id,t=e.value,r=function(e){e.stopPropagation();var t=document.querySelector("#qr-".concat(n," > canvas")).toDataURL(),i=document.createElement("a");i.href=t,i.download="".concat(n,".png"),document.body.appendChild(i),i.click(),document.body.removeChild(i)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Z,{onClick:r,size:"large",sx:{borderRadius:"10px!important",width:"130px"},children:(0,i.jsxs)(s.Z,{alignItems:"center",children:[(0,i.jsx)(w.Z,{sx:{width:"50px",height:"50px"},color:"secondary"}),(0,i.jsx)(m.Z,{children:"Qr Code"})]})}),(0,i.jsx)(s.Z,{id:"qr-".concat(n),alignItems:"center",display:"none",children:(0,i.jsx)(o.Qd,{style:{display:"none"},bgColor:"#ffffff",fgColor:"#000000",value:t,level:"H",size:256})})]})};C.propTypes={id:a().string,value:a().string},C.defaultProps={id:"new-qr-code",isExpandedByDefault:!1,collapsible:!0};var I=t(78566),q=t.n(I),$=t(28842),_=q(),S=function(e){var n=e.id,t=e.value,o=function(e){e.stopPropagation();var t=document.querySelector("#barcode-".concat(n," > svg")).outerHTML,i=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),o=URL.createObjectURL(i),r=document.createElement("a");r.href=o,r.download="".concat(n,".svg"),document.body.appendChild(r),r.click(),document.body.removeChild(r)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Z,{onClick:o,size:"large",sx:{borderRadius:"10px!important",width:"130px"},children:(0,i.jsxs)(s.Z,{alignItems:"center",children:[(0,i.jsx)($.Z,{sx:{width:"50px",height:"50px"},color:"secondary"}),(0,i.jsx)(m.Z,{children:"Barcode"})]})}),(0,i.jsx)(s.Z,{id:"barcode-".concat(n),alignItems:"center",display:"none",children:(0,i.jsx)(_,{value:"".concat(t),style:{display:"none"}})})]})};S.defaultProps={id:"asset",value:""},S.propTypes={id:a().string.isRequired,value:a().string.isRequired};var P=l.Z,M=function(e){var n=e.id,t=e.value,o=e.expanded,r=e.onChangeExpanded,a=e.collapsible,l=(0,x.a)(),g=function(e){e.stopPropagation();var t=document.querySelector("#barcode-".concat(n," > svg")).outerHTML,i=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),o=URL.createObjectURL(i),r=document.createElement("a");r.href=o,r.download="".concat(n,".svg"),document.body.appendChild(r),r.click(),document.body.removeChild(r)},y=(0,v.useMemo)(function(){var e={Main:s.Z,Header:s.Z,Body:s.Z};return a&&(e={Main:d.Z,Header:u.Z,Body:c.Z}),e},[a]);return(0,i.jsx)(p.Z,{children:(0,i.jsxs)(y.Main,{expanded:o,onChange:r,children:[(0,i.jsx)(y.Header,{expandIcon:(0,i.jsx)(h.Z,{}),children:(0,i.jsxs)(s.Z,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(m.Z,{variant:"h6",children:"Barcode"}),(0,i.jsx)(P,{disabled:l,disableMinWidth:!0,size:"small",color:"info",variant:"contained",onClick:g,sx:{mr:2},children:(0,i.jsx)(f.Z,{sx:{height:"17px",width:"17px"}})})]})}),(0,i.jsx)(y.Body,{children:(0,i.jsx)(s.Z,{id:"barcode-".concat(n),alignItems:"center",children:(0,i.jsx)(q(),{value:"".concat(t)})})})]})})};M.defaultProps={expanded:!1,onChangeExpanded:function(){},collapsible:!0,id:"asset",value:""},M.propTypes={expanded:a().bool,onChangeExpanded:a().func,collapsible:a().bool,id:a().string.isRequired,value:a().string.isRequired};var A=M},57493:function(e,n,t){"use strict";t.d(n,{A5:function(){return es},Ak:function(){return G},Cj:function(){return J},K4:function(){return ei},Oq:function(){return ea},Qn:function(){return N},RJ:function(){return V},SW:function(){return O},T_:function(){return W},UH:function(){return F},UM:function(){return en},Ve:function(){return X},_d:function(){return z},_f:function(){return et},by:function(){return Y},cz:function(){return T},he:function(){return B},j$:function(){return L},kB:function(){return K},kx:function(){return U},nD:function(){return E},nP:function(){return er},pY:function(){return eo},qd:function(){return D},t1:function(){return H},yR:function(){return Q},zR:function(){return ee}});var i=t(7297),o=t(75063);function r(){var e=(0,i.Z)(["\n  query GetAddressForSelect($q: String, $entity: String!, $entityId: Int!) {\n    items: Address(\n      where: {\n        Address_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } }\n        _or: [\n          { addressLine1: { _eq: $q } }\n          { addressLine2: { _eq: $q } }\n          { addressLine3: { _eq: $q } }\n          { county: { _eq: $q } }\n          { postCode: { _eq: $q } }\n          { city: { _eq: $q } }\n        ]\n      }\n    ) {\n      label: addressLine1\n      value: id\n      id\n      name\n      addressLine1\n      addressLine2\n      addressLine3\n      postCode\n      county\n      country: Country {\n        name\n      }\n      city\n      Address_Entities {\n        invoice\n      }\n    }\n  }\n"]);return r=function(){return e},e}function a(){var e=(0,i.Z)(["\n  query GetAccountsForSelect($q: String, $type: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: $type } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return a=function(){return e},e}function s(){var e=(0,i.Z)(['\n  query GetTaxonomy($q: String, $id: Int) {\n    items: Taxonomy(\n      where: { type: { _eq: "assetCategory" }, status: { _eq: "active" } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      options: Taxonomies(\n        where: {\n          type: { _eq: "assetCategory" }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']);return s=function(){return e},e}function l(){var e=(0,i.Z)(["\n  query GetAssetsForSelect(\n    $locationId: Int\n    $q: String\n    $categoryId: Int\n    $bookable: String\n    $limit: Int\n    $offset: Int\n  ) {\n    items: Asset(\n      where: {\n        categoryId: { _eq: $categoryId }\n        locationId: { _eq: $locationId }\n        name: { _ilike: $q }\n        bookable: { _eq: $bookable }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n      sublocation: Sublocation {\n        name\n      }\n    }\n  }\n"]);return l=function(){return e},e}function d(){var e=(0,i.Z)(['\n  query GetCustomersForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: "customer" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      admin: Admins {\n        id: adminId\n      }\n      label: name\n      spendThreshold: meta(path: "$.finance.spendThreshold")\n      serviceRateLabour: meta(path: "$.finance.serviceRateLabour")\n      serviceRateExpenses: meta(path: "$.finance.serviceRateExpenses")\n      value: id\n    }\n  }\n']);return d=function(){return e},e}function c(){var e=(0,i.Z)(["\n  query GetJobsForSelect($_q: Int, $locationId: Int) {\n    items: Job(\n      where: {\n        Location: { id: { _eq: $locationId } }\n        _or: [{ id: { _eq: $_q } }, { Invoices: { id: { _eq: $_q } } }]\n      }\n      order_by: { title: asc }\n    ) {\n      label: label\n      value: id\n      number\n      createdAt\n      description\n      status\n      timingStart\n      title\n      type\n      Location {\n        name\n      }\n      Taxonomy {\n        Taxonomy {\n          shortJobDescription: name\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}function u(){var e=(0,i.Z)(['\n  query GetManagersForSelect($userId: Int, $accountId: Int!, $q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return u=function(){return e},e}function m(){var e=(0,i.Z)(['\n  query GetManagersForSelect(\n    $userId: Int\n    $accountId: Int!\n    $q: String\n    $invoiceThreshold: numeric\n    $quoteThreshold: numeric\n  ) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n        _and: [\n          {\n            _or: [\n              { invoiceThreshold: { _gt: $invoiceThreshold } }\n              { invoiceThreshold: { _is_null: true } }\n            ]\n          }\n          {\n            _or: [\n              { quoteThreshold: { _gt: $quoteThreshold } }\n              { quoteThreshold: { _is_null: true } }\n            ]\n          }\n        ]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return m=function(){return e},e}function p(){var e=(0,i.Z)(["\n  query GetPostCodeAreaForSelect($countryId: Int, $q: String) {\n    items: PostcodeArea(\n      where: { name: { _ilike: $q }, countryId: { _eq: $countryId } }\n      order_by: { name: asc }\n    ) {\n      area\n      label: name\n      value: id\n    }\n  }\n"]);return p=function(){return e},e}function h(){var e=(0,i.Z)(['\n  query GetPropertiesForSelect($where: Location_bool_exp, $limit: Int, $offset: Int) {\n    items: Location(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n      access\n      permitsRequired\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n']);return h=function(){return e},e}function f(){var e=(0,i.Z)(['\n  query GetServicesForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Service(\n      where: { name: { _ilike: $q }, status: { _eq: "active" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']);return f=function(){return e},e}function x(){var e=(0,i.Z)(["\n  query GetSlasForSelect($q: String, $adminId: Int, $type: String, $subtype: sla_subtype) {\n    items: SLA(\n      where: {\n        name: { _ilike: $q }\n        type: { _eq: $type }\n        adminId: { _eq: $adminId }\n        subtype: { _eq: $subtype }\n      }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return x=function(){return e},e}function v(){var e=(0,i.Z)(["\n  query GetSlasForSelectNew($where: SLA_bool_exp, $limit: Int, $offset: Int) {\n    items: SLA(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n    }\n  }\n"]);return v=function(){return e},e}function g(){var e=(0,i.Z)(["\n  query GetSuppliersForSelect($where: Account_bool_exp, $limit: Int, $offset: Int) {\n    items: Account(where: $where, limit: $limit, offset: $offset, order_by: { name: asc }) {\n      label: name\n      value: id\n    }\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,i.Z)(['\n  query GetUsersForSelect($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          accountId: { _eq: $accountId }\n          isContact: { _eq: true }\n          status: { _eq: "active" }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']);return y=function(){return e},e}function b(){var e=(0,i.Z)(['\n  query GetUsersForSelect($q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']);return b=function(){return e},e}function Z(){var e=(0,i.Z)(["\n  query GetTaxonomyGroupForSelect($q: String, $type: String!) {\n    items: Taxonomy(\n      where: { isGroup: { _eq: true }, name: { _ilike: $q }, type: { _eq: $type } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return Z=function(){return e},e}function j(){var e=(0,i.Z)(['\n  query GetTaxonomy($q: String) {\n    items: Taxonomy(where: { type: { _eq: "expenseCategoryGroup" } }, order_by: { name: asc }) {\n      label: name\n      options: Taxonomies(\n        where: { type: { _eq: "expenseCategory" }, name: { _ilike: $q } }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']);return j=function(){return e},e}function w(){var e=(0,i.Z)(["\n  query GetUserRole($userId: Int!, $accountId: Int!) {\n    accountUsers: Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n    ) {\n      role\n    }\n  }\n"]);return w=function(){return e},e}function C(){var e=(0,i.Z)(["\n  query GetSublocationsForSelect($locationId: Int!, $q: String, $limit: Int, $offset: Int) {\n    items: Sublocation(\n      where: { name: { _ilike: $q }, locationId: { _eq: $locationId }, active: { _eq: true } }\n      limit: $limit\n      offset: $offset\n      order_by: { createdAt: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n"]);return C=function(){return e},e}function I(){var e=(0,i.Z)(['\n  query GetTaxonomy($q: String, $limit: Int, $offset: Int) {\n    items: Taxonomy(\n      where: {\n        type: { _eq: "assetCategory" }\n        isGroup: { _eq: false }\n        status: { _eq: "active" }\n        name: { _ilike: $q }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']);return I=function(){return e},e}function q(){var e=(0,i.Z)(["\n  query GetTaxonomyForSelect(\n    $where: Taxonomy_bool_exp\n    $limit: Int\n    $offset: Int\n    $orderBy: Taxonomy_order_by!\n    $includeMeta: Boolean! = false\n  ) {\n    items: Taxonomy(where: $where, limit: $limit, offset: $offset, order_by: [$orderBy]) {\n      value: id\n      label: name\n      meta @include(if: $includeMeta)\n    }\n  }\n"]);return q=function(){return e},e}function $(){var e=(0,i.Z)(['\n  query GetTagsForTask($q: String!, $limit: Int = 50, $offset: Int = 0) {\n    items: Taxonomy(\n      where: { name: { _ilike: $q }, status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n']);return $=function(){return e},e}function _(){var e=(0,i.Z)(['\n  query GetTagsForEntity(\n    $entityId: Int\n    $entity: String!\n    $q: String!\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    tags: Taxonomy(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: "active" }\n        type: { _eq: "taskTags" }\n        _not: { Taxonomy_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } } }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      id\n      name\n      meta\n    }\n  }\n']);return _=function(){return e},e}function S(){var e=(0,i.Z)(['\n  query GetEntityTags($entityId: Int!, $entity: String!) {\n    tags: Taxonomy_Entity(\n      where: {\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n        Taxonomy: { status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      }\n      order_by: { id: desc }\n    ) {\n      id\n      tag: Taxonomy {\n        id\n        name\n        meta\n      }\n    }\n  }\n']);return S=function(){return e},e}function P(){var e=(0,i.Z)(["\n  query GetCustomerManagers($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: { Account_Users: { accountId: { _eq: $accountId } }, fullName: { _ilike: $q } }\n      order_by: { fullName: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n"]);return P=function(){return e},e}function M(){var e=(0,i.Z)(["\n  query GetServiceSchedulesForSelect(\n    $q: String\n    $serviceId: Int\n    $entity: service_schedule_entity\n    $entityId: Int\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    items: ServiceSchedule(\n      where: {\n        name: { _ilike: $q }\n        serviceId: { _eq: $serviceId }\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]);return M=function(){return e},e}function A(){var e=(0,i.Z)(['\n  query GetPropertyById($id: Int!) {\n    item: Location_by_pk(id: $id) {\n      label: name\n      value: id\n      access\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n            code\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n']);return A=function(){return e},e}function k(){var e=(0,i.Z)(["\n  query GetCompliancesForSelectNew($q: String, $locationId: Int, $limit: Int, $offset: Int) {\n    items: Compliance(\n      where: { name: { _ilike: $q }, locationId: { _eq: $locationId } }\n      order_by: { name: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      value: id\n      label: name\n      category: ComplianceCategory {\n        label: name\n      }\n    }\n  }\n"]);return k=function(){return e},e}function R(){var e=(0,i.Z)(['\n  query GetTaskAssignedToForSelect(\n    $accountId: Int\n    $q: String\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']);return R=function(){return e},e}var T=(0,o.Ps)(r()),D=(0,o.Ps)(a()),E=(0,o.Ps)(s()),F=(0,o.Ps)(l()),O=(0,o.Ps)(d()),N=(0,o.Ps)(c()),B=(0,o.Ps)(u()),G=(0,o.Ps)(m()),L=(0,o.Ps)(p()),z=(0,o.Ps)(h()),U=(0,o.Ps)(f()),H=(0,o.Ps)(x()),W=(0,o.Ps)(v()),Y=(0,o.Ps)(g()),Q=(0,o.Ps)(y()),V=(0,o.Ps)(b()),J=(0,o.Ps)(Z()),X=(0,o.Ps)(j()),K=(0,o.Ps)(w()),ee=(0,o.Ps)(C()),en=(0,o.Ps)(I()),et=(0,o.Ps)(q());(0,o.Ps)($()),(0,o.Ps)(_()),(0,o.Ps)(S());var ei=(0,o.Ps)(P()),eo=(0,o.Ps)(M()),er=(0,o.Ps)(A()),ea=(0,o.Ps)(k()),es=(0,o.Ps)(R())},45451:function(e,n,t){"use strict";t.d(n,{i:function(){return I}});var i=t(14924),o=t(26042),r=t(69396),a=t(85893),s=t(67294),l=t(11163),d=t(45697),c=t.n(d),u=t(61870),m=t(5616),p=t(51233),h=t(15861),f=t(90948),x=t(41796),v=t(29217),g=t(45111),y=t(98209),b=t(70872),Z=t(58886),j=t(61730),w=function(e){var n=e.currentPage,t=e.totalCount,i=e.pageSize,r=e.onPageChange,s=(0,j.Z)("(max-width:400px)"),l=(0,j.Z)("(max-width:500px)");return(0,a.jsx)(C,{mb:2,page:n,count:Math.ceil(t/i),onChange:function(e,n){return r(n)},variant:"outlined",shape:"rounded",size:s?"small":"medium",hidePrevButton:1===n,hideNextButton:n===Math.ceil(t/i),siblingCount:l?0:1,renderItem:function(e){return(0,a.jsx)(Z.Z,(0,o.Z)({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},e))}})};w.defaultProps={currentPage:1,totalCount:0,pageSize:50,onPageChange:function(){}},w.propTypes={currentPage:c().number,totalCount:c().number,pageSize:c().number,onPageChange:c().func};var C=(0,f.ZP)(b.Z)(function(e){var n,t=e.hidePrevButton,r=e.hideNextButton,a=e.theme;return n={},(0,i.Z)(n,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,i.Z)(n,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,i.Z)(n,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,i.Z)(n,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,i.Z)(n,"& button.Mui-selected",(0,o.Z)({color:a.palette.white.main,backgroundColor:a.palette.secondary.main},r?{borderRadius:"0 5px 5px 0"}:{},t?{borderRadius:"5px 0 0 5px"}:{})),n}),I=(0,s.forwardRef)(function(e,n){var t=e.columns,i=e.history,r=e.initialSort,d=e.meta,c=e.refetch,u=e.paginationSize,m=e.containerHeight,f=e.containerMaxHeight,x=e.noResultsMessage,b=e.autoHeight,Z=(0,l.useRouter)(),j=Z.query,C=void 0===j?{}:j,I=(0,s.useState)(parseInt(null==C?void 0:C.page,10)||1),_=I[0],S=I[1],P=(0,s.useState)(u||y.C1.paginationSize),M=P[0],A=P[1],k=r;k||(k={item:"createdAt",order:"desc"});var R=(0,s.useState)({item:k.item,order:k.order}),T=R[0],D=R[1],E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=Z.query,t=void 0===n?{}:n;if(e>1?t.page=e:delete t.page,!(Object.keys(t).length>0))return{};var i=Object.keys(t).map(function(n){return"page"===n?"".concat(n,"=").concat(e):"".concat(n,"=").concat(t[n])}).join("&");return"?".concat(i)},F=function(){D({item:k.item,order:k.order}),S(1);var e=E();Z.push(e),A(u||y.C1.paginationSize)};(0,s.useImperativeHandle)(n,function(){return{currentPage:_,pageSize:M,sort:T,resetPagination:function(){F()}}});var O=function(e){var n=E(e);i&&Z.push(n),S(e),!i&&c&&c()},N=function(e){e&&e.field&&e.sort?(D({item:t.find(function(n){return n.field===e.field}).sortName||e.field||e.item||k.item,order:e.sort||e.order||k.order}),c&&c()):(D({item:k.item,order:k.order}),c&&c())};return(0,a.jsxs)(q,{containerHeight:m,containerMaxHeight:f,children:[(0,a.jsx)($,(0,o.Z)({hideFooter:!0,disableColumnMenu:!0,disableSelectionOnClick:!0,autoHeight:b,sortingMode:"server",onSortModelChange:function(e){return N(e[0])},columns:t,pageSize:M,slots:{columnSortedAscendingIcon:function(){return(0,a.jsx)(v.Z,{})},columnSortedDescendingIcon:function(){return(0,a.jsx)(g.Z,{})},columnUnsortedIcon:function(){return(0,a.jsxs)(p.Z,{alignItems:"center",sx:{width:"33px"},children:[(0,a.jsx)(v.Z,{sx:{marginBottom:"-15px"}}),(0,a.jsx)(g.Z,{})]})},noResultsOverlay:function(){return(0,a.jsx)(p.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,a.jsx)(h.Z,{children:x})})},noRowsOverlay:function(){return(0,a.jsx)(p.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,a.jsx)(h.Z,{children:x})})}}},e)),d&&Math.ceil(d.aggregate.totalCount/M)>1&&(0,a.jsx)(w,{currentPage:_,totalCount:d.aggregate.totalCount,pageSize:M,onPageChange:O})]})});I.propTypes={history:c().bool,initialSort:c().object,loading:c().bool,meta:c().object,refetch:c().func,paginationSize:c().number,noResultsMessage:c().string,columns:c().array.isRequired,rows:c().array.isRequired,autoHeight:c().bool},I.defaultProps={columns:[],history:!1,loading:!1,rows:[],noResultsMessage:"There are no results.",autoHeight:!0};var q=(0,f.ZP)(m.Z)(function(e){var n;return{height:e.containerHeight,maxHeight:e.containerMaxHeight,display:"flex",flexDirection:"column"}}),$=(0,f.ZP)(u.s)(function(e){var n,t=e.theme,a=e.hideHeader,s=(e.rows,e.loading,e.rowHeight),l=e.isPdf;return n={"--DataGrid-overlayHeight":"40px"},(0,i.Z)(n,"&.MuiDataGrid-root",(0,o.Z)({color:t.palette.black.main,border:"none"},l&&{"@media print":{display:"block"}})),(0,i.Z)(n,"& .MuiDataGrid-main",(0,o.Z)({},l&&{"@media print":{overflow:"visible !important"}})),(0,i.Z)(n,"& .MuiDataGrid-columnHeaders",(0,r.Z)((0,o.Z)({},a&&{display:"none"}),{"& .MuiDataGrid-iconButtonContainer":{visibility:"visible","& .MuiButtonBase-root.MuiIconButton-root":{backgroundColor:"inherit",color:t.palette.black.main,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"}}}})),(0,i.Z)(n,"& .MuiDataGrid-virtualScroller",(0,o.Z)({},a&&{marginTop:"0 !important"},l&&{"@media print":{overflow:"visible !important"}})),(0,i.Z)(n,"& .MuiDataGrid-iconSeparator",{opacity:0}),(0,i.Z)(n,"& .MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,i.Z)(n,"& .MuiButtonBase-root.MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,i.Z)(n,"& .MuiDataGrid-virtualScrollerContent",(0,o.Z)({},l&&{height:"initial !important",minHeight:"initial !important"})),(0,i.Z)(n,"& .MuiDataGrid-virtualScrollerRenderZone",(0,o.Z)({},l&&{position:"relative"})),(0,i.Z)(n,"& .MuiDataGrid-overlayWrapper",(0,i.Z)({},"& .MuiCircularProgress-root",{color:t.palette.secondary.main})),(0,i.Z)(n,"& .MuiDataGrid-row",(0,o.Z)({},l&&{minHeight:"".concat(s,"cm !important"),maxHeight:"".concat(s,"cm !important")})),(0,i.Z)(n,"& .MuiDataGrid-row > .MuiDataGrid-cell",(0,o.Z)({},l&&{minHeight:"".concat(s,"cm !important"),maxHeight:"".concat(s,"cm !important")})),(0,i.Z)(n,"& .MuiDataGrid-columnHeaderCheckbox",(0,i.Z)({},"& .MuiButtonBase-root.MuiCheckbox-root > .MuiSvgIcon-root",(0,i.Z)({color:t.palette.secondary.main},'&[data-testid="CheckBoxOutlineBlankIcon"]',{color:"currentColor"}))),(0,i.Z)(n,"& .MuiDataGrid-row > .MuiDataGrid-cellCheckbox",(0,i.Z)({},"& .MuiButtonBase-root.MuiCheckbox-root > .MuiSvgIcon-root",(0,i.Z)({color:t.palette.secondary.main},'&[data-testid="CheckBoxOutlineBlankIcon"]',{color:"currentColor"}))),(0,i.Z)(n,"& .MuiDataGrid-row.even",{backgroundColor:t.palette.muiLightGray.main,"&:hover, &.Mui-hovered":{backgroundColor:(0,x.Fq)(t.palette.muiLightGray.main,.3),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,x.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,x.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,x.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity)}}}}),n})},87336:function(e,n,t){"use strict";t.d(n,{t:function(){return d}});var i=t(85893),o=t(67294),r=t(45697),a=t(11163),s=t(98209),l=t(16540),d=(0,o.forwardRef)(function(e,n){var t=e.columns,r=e.history,d=e.initialSort,c=e.loading,u=e.meta,m=e.paginationSize,p=e.refetch,h=e.rowClick,f=e.rows,x=e.xeroPageSize,v=(0,a.useRouter)(),g=v.query,y=void 0===g?{}:g,b=(0,o.useState)(parseInt(null==y?void 0:y.page,10)||1),Z=b[0],j=b[1],w=(0,o.useState)(x||s.C1.paginationSize),C=w[0],I=w[1];d||(d={item:"createdAt",order:"desc"});var q=(0,o.useState)({item:d.item,order:d.order}),$=q[0],_=q[1],S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=v.query,t=void 0===n?{}:n;if(e>1?t.page=e:delete t.page,!(Object.keys(t).length>0))return{};var i=Object.keys(t).map(function(n){return"page"===n?"".concat(n,"=").concat(e):"".concat(n,"=").concat(t[n])}).join("&");return"?".concat(i)},P=function(){_({item:d.item,order:d.order}),j(1);var e=S();v.push(e),I(x||s.C1.paginationSize)};(0,o.useImperativeHandle)(n,function(){return{currentPage:Z,pageSize:C,sort:$,resetPagination:function(){P()}}});var M=function(e){var n=S(e);r&&v.push(n),j(e),!r&&p&&p()},A=function(e){e!==s.C1.paginationSize&&(I(e),p&&p())},k=function(e){var n;_({item:e.item,order:e.order}),p&&p()};return(0,i.jsx)(l.Z,{columns:t,loading:c,paginationSize:m,pagination:u&&!0,paginationProps:u&&{currentPage:Z,onPageChange:M,onPageSizeChange:A,pageCount:Math.ceil(u.aggregate.totalCount/C),perPage:C},rowClick:h,rows:f,sort:$,setSort:k})});d.propTypes={columns:r.array.isRequired,history:r.bool,initialSort:r.object,loading:r.bool,meta:r.object,refetch:r.func,rowClick:r.func,rows:r.array.isRequired},d.defaultProps={history:!0,loading:!0,paginationSize:!1}},16605:function(e,n,t){"use strict";t.d(n,{S:function(){return i}});var i=function(e,n){var t=document.createElement("a");"string"==typeof t.download?(document.body.appendChild(t),t.download=n,t.href=e,t.click(),document.body.removeChild(t)):location.replace(e)}},19504:function(e,n,t){"use strict";t.d(n,{l:function(){return i}});var i=function(e,n){var t=Math.pow(10,n);return Math.round(e*t)/t}},34e3:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eA}});var i=t(85893),o=t(14924),r=t(26042),a=t(69396),s=t(828),l=t(29815),d=t(45697),c=t.n(d),u=t(11163),m=t.n(u),p=t(6812),h=t(80426),f=t(5616),x=t(98456),v=t(86886),g=t(51233),y=t(86532),b=t(22797),Z=t(38895),j=t(11057),w=t(15861),C=t(77957),I=t(30381),q=t.n(I),$=t(27434),_=t(74492),S=t(89591),P=t(71628),M=j.Z,A=function(e){var n=e.assetId,t=e.name,o=e.description,r=e.parentAsset,a=e.customer,l=e.location,d=e.sublocation,c=e.category,u=e.createdAt,m=e.status,p=e.categoryQuestions,h=e.categoryAnswers,x=e.assetAdditional,j=e.editable,I=e.expanded,A=e.onChangeExpanded,k=(0,_.a)(),R=function(e){e.stopPropagation(),k.show({content:(0,i.jsx)(S.R,{assetId:n,offCanvas:k}),title:"Edit Asset",submit:!0})};return(0,i.jsx)(f.Z,{children:(0,i.jsxs)(y.Z,{expanded:I,onChange:A,children:[(0,i.jsx)(Z.Z,{expandIcon:(0,i.jsx)($.Z,{}),children:(0,i.jsxs)(g.Z,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(w.Z,{variant:"h6",children:"Details"}),j&&(0,i.jsx)(M,{disableMinWidth:!0,size:"small",color:"secondary",variant:"contained",onClick:R,sx:{mr:2},children:(0,i.jsx)(C.Z,{sx:{height:"17px",width:"17px"}})})]})}),(0,i.jsx)(b.Z,{children:(0,i.jsxs)(v.ZP,{container:!0,rowSpacing:2,children:[(0,i.jsxs)(v.ZP,{container:!0,item:!0,xs:6,rowSpacing:1,columnSpacing:1,children:[(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Name"}),(0,i.jsx)(w.Z,{children:t})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Description"}),(0,i.jsx)(w.Z,{children:o})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Parent asset"}),(0,i.jsx)(w.Z,{children:r})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Customer"}),(0,i.jsx)(w.Z,{children:a})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,sx:{maxWidth:"85%!important"},children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Location"}),(0,i.jsx)(w.Z,{children:l})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Sublocation"}),(0,i.jsx)(w.Z,{children:d})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Category"}),(0,i.jsx)(w.Z,{children:c})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Type"}),(0,i.jsx)(w.Z,{children:r?"Child":"Parent"})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Date created"}),(0,i.jsx)(w.Z,{children:q()(u).format("YYYY-MM-DD")})]}),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:"Status"}),(0,i.jsx)(w.Z,{children:m})]}),p.map(function(e,n){var t,o,r=h[e.name];return Array.isArray(r)&&(r=r.filter(function(e){return e}).join(", ")),(null===(t=e.meta)||void 0===t?void 0:t.input)==="datepicker"&&(r=q()(r).format("Do MMM YYYY")),(0,i.jsxs)(v.ZP,{item:!0,xs:12,children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:null===(o=e.meta)||void 0===o?void 0:o.label}),(0,i.jsx)(w.Z,{children:r})]},"".concat(e.name,"-").concat(n))})]}),(0,i.jsx)(v.ZP,{container:!0,item:!0,xs:6,children:(0,i.jsx)(g.Z,{spacing:1,mt:1,children:x?Object.entries(x).map(function(e){var n,t,o,r=(0,s.Z)(e,2),a=r[0],l=r[1],d=null===(n=P.W[a])||void 0===n?void 0:n.formatter,c=d?d(l):l;return(0,i.jsxs)(f.Z,{children:[(0,i.jsx)(w.Z,{variant:"subtitle2",children:null!==(o=null===(t=P.W[a])||void 0===t?void 0:t.label)&&void 0!==o?o:"No label"}),(0,i.jsx)(g.Z,{direction:"row",alignItems:"center",children:(0,i.jsx)(w.Z,{children:null!=c?c:"-"})})]})}):null})})]})})]})})};A.defaultProps={assetId:null,name:"-",description:"-",parentAsset:!1,customer:"-",location:"-",sublocation:"-",category:"-",createdAt:new Date,status:"active",categoryQuestions:[],categoryAnswers:{},editable:!1,expanded:!1,onChangeExpanded:function(){}},A.propTypes={assetId:c().number.isRequired,name:c().string,description:c().string,parentAsset:c().string,customer:c().string,location:c().string,sublocation:c().string,category:c().string,createdAt:c().oneOfType([c().object,c().string]),status:c().string,assetAdditional:c().object,categoryQuestions:c().arrayOf(c().shape({name:c().string.isRequired,meta:c().shape({label:c().string.isRequired,input:c().oneOf(["input","textArea","currencyInput","radio","select","selectRange","datepicker","checkbox"]).isRequired})})),categoryAnswers:c().object.isRequired,editable:c().bool,expanded:c().bool,onChangeExpanded:c().func};var k=t(57779),R=t(57460),T=t.n(R),D=t(45451),E=t(12632),F=t(74944),O=t(48795),N=t(53767),B=t(59505),G=t(83162),L=t(21830),z=t(73359),U=t(16605),H=t(67294),W=function(e){var n,t,o,l=e.assetId,d=e.editable,c=e.expanded,u=e.onChangeExpanded,v=e.asset,C=(0,N.q)(),I=(0,F.x)().hasRole,_=I("admin"),S=I("supplier"),P=I("tenant"),M=null===(n=C.admin.jobSetting)||void 0===n?void 0:n.jobNumberPrefix,A=null===(t=C.admin.jobSetting)||void 0===t?void 0:t.jobNumberSuffix,k=(0,H.useState)(!1),R=k[0],W=k[1],Y=(0,E.x)({filters:{}}),Q=Y.ref,V=Y.initialData,J=(0,p.a)(h.zu,{variables:(0,a.Z)((0,r.Z)({},V),{assetId:null==v?void 0:v.id})}),X=J.data,K=void 0===X?{jobs:[],meta:{aggregate:{totalCount:0}}}:X,ee=K.jobs,en=K.meta,et=J.loading,ei=J.refetch,eo=(0,s.Z)((0,z.t)(h.zu,{fetchPolicy:"no-cache",variables:{assetId:l,orderBy:V.orderBy,offset:0,limit:(null==en?void 0:null===(o=en.aggregate)||void 0===o?void 0:o.totalCount)||150},onCompleted:function(e){var n=e.jobs;try{var t=T().unparse(ea(n,!0)),i="data:application/octet-stream,"+encodeURIComponent(t);(0,U.S)(i,"asset-".concat(l,"_jobs.csv"))}finally{W(!1)}}}),1)[0],er=function(e){var n=[];return d&&n.push({context:"secondary",icon:"edit",onClick:function(n){return m().push("/dashboard/issues/manage?id=".concat(e.number).concat("quote"===e.type?"&quoted=1":""))},tooltip:"Edit"}),n.push({context:"secondary",icon:"info",onClick:function(n){return m().push("/dashboard/issues/view?id=".concat(e.number))},tooltip:"Info"}),n},ea=function(e,n){return e.map(function(e){var t,i,o,s,l,d,c,u,m,p,h,f,x,v,g,y,b=e.manager?e.manager.fullName:"Unassigned",Z=e.scheduledAt?q()(e.scheduledAt).format("YYYY-MM-DD"):q()(e.timingStart).format("YYYY-MM-DD"),j=n&&(null==e?void 0:e.supplierOffers.length)>0?null===(t=null==e?void 0:e.supplierOffers[0].supplier)||void 0===t?void 0:t.name:null==e?void 0:e.supplierOffers;return(0,a.Z)((0,r.Z)({},!n&&{id:e.id}),{type:e.type,number:e.number,invoiceNumber:null===(i=e.invoices)||void 0===i?void 0:null===(o=i[0])||void 0===o?void 0:o.invoiceNumber,creator:null===(s=e.timings)||void 0===s?void 0:null===(l=s[0])||void 0===l?void 0:null===(d=l.user)||void 0===d?void 0:d.fullName,propertyId:null===(c=e.location)||void 0===c?void 0:c.id,managerId:null===(u=e.manager)||void 0===u?void 0:u.id,customerId:null===(m=e.customer)||void 0===m?void 0:m.id,priority:(null===(p=e.sla)||void 0===p?void 0:p.name)||"-",supplierId:e.supplier?e.supplier.id:"",service:(null===(h=e.service)||void 0===h?void 0:h.name)||"-",description:(null===(f=e.shortJobDesc)||void 0===f?void 0:null===(x=f[0])||void 0===x?void 0:x.taxonomy.name)||"-",manager:b,location:(null===(v=e.location)||void 0===v?void 0:v.name)||"-",customer:(null===(g=e.customer)||void 0===g?void 0:g.name)||"-",supplier:e.supplier?e.supplier.name:"-",supplierUser:e.supplierUser?e.supplierUser.fullName:"-",scheduleDate:Z,date:q()(e.createdAt).format("YYYY-MM-DD"),status:(null==e?void 0:e.job)?null===(y=e.job)||void 0===y?void 0:y.status:e.status,offerTo:_?j:""})})},es=function(e){e.stopPropagation(),W(!0),eo()};return(0,i.jsx)(f.Z,{children:(0,i.jsxs)(y.Z,{expanded:c,onChange:u,sx:{maxHeight:"calc(100vh - 32px)",overflow:"scroll"},children:[(0,i.jsx)(Z.Z,{expandIcon:(0,i.jsx)($.Z,{}),children:(0,i.jsxs)(g.Z,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(w.Z,{variant:"h6",children:"Work Orders"}),(0,i.jsx)(g.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:(0,i.jsx)(j.Z,{disabled:R,size:"small",color:"success",variant:"contained",onClick:es,sx:{mr:2},children:R?(0,i.jsx)(x.Z,{size:20,color:"secondary"}):"CSV"})})]})}),(0,i.jsx)(b.Z,{children:(0,i.jsx)(D.i,{autoHeight:!1,loading:et,ref:Q,columns:[{minWidth:60,field:"id",headerName:"Job ID",renderCell:function(e){var n=e.row;return(0,i.jsx)(O.D,{id:n.id,number:n.number,openCanvas:!0,type:n.type,numberPrefix:M,numberSuffix:A})}},{minWidth:60,field:"invoiceNumber",headerName:"Invoice ID",renderCell:function(e){return e.row.invoiceNumber},sortable:!1},{maxWidth:80,field:"priority",headerName:"Priority",sortName:'{"SLA": {"name": "ORDER"}}'},{minWidth:200,field:"service",headerName:"Service",sortName:'{"Service": {"name": "ORDER"}}'},{minWidth:80,field:"type",headerName:"Type",sortable:!1},{minWidth:200,flex:1,field:"description",headerName:"Description",sortable:!1},{minWidth:130,flex:1,field:"manager",headerName:"Assigned to",sortName:'{"Manager": {"nameFirst": "ORDER"}}',renderCell:function(e){var n=e.row;return(0,i.jsx)(G.r,{color:"secondary",href:"/dashboard/users/view?id=".concat(n.managerId),children:n.manager})}},{minWidth:200,flex:1,field:"location",headerName:_?"Customer":"Location",sortName:'{"Customer": {"name": "ORDER"}}',renderCell:function(e){var n=e.row;return(0,i.jsxs)(g.Z,{children:[_&&(0,i.jsx)(G.r,{color:"secondary",href:"/dashboard/customers/view?id=".concat(n.customerId),children:n.customer}),(0,i.jsx)(G.r,{noWrap:S||P,color:"secondary",href:"/dashboard/properties/view?id=".concat(n.propertyId),children:n.location})]})}},{minWidth:140,flex:1,field:"supplier",headerName:"Supplier",sortName:'{"Supplier": {"name": "ORDER"}}',renderCell:function(e){var n=e.row;return(0,i.jsx)(G.r,{color:"secondary",href:"/dashboard/suppliers/view?id=".concat(n.supplierId),children:n.supplier})}},{flex:1,minWidth:120,field:"supplierUser",headerName:"Assigned to",sortName:'{"SupplierUser": {"nameFirst": "ORDER"}}'},{minWidth:160,field:"scheduleDate",headerName:"Scheduled",sortable:!1},{minWidth:120,flex:1,field:"date",headerName:"Created",sortName:"createdAt"},{minWidth:120,flex:1,field:"status",headerName:"Status",renderCell:function(e){var n,t,o=e.row;return(0,i.jsxs)(g.Z,{children:[(0,i.jsx)(f.Z,{children:(0,i.jsx)(B.B,{value:o.status})}),_&&"offered"===o.status&&o.offerTo&&o.offerTo.length>0&&(0,i.jsx)(G.r,{color:"secondary",href:"/dashboard/suppliers/view?id=".concat(null===(n=o.offerTo[0].supplier)||void 0===n?void 0:n.id),children:null===(t=o.offerTo[0].supplier)||void 0===t?void 0:t.name})]})}},{width:50,field:"actions",headerName:"",sortable:!1,renderCell:function(e){var n=e.row;return(0,i.jsx)(L.C,{actionsData:er,row:n})}}],rows:ea(ee,!1),meta:en,refetch:ei,columnVisibilityModel:{priority:_,manager:_,supplier:_,supplierUser:S}})})]})})};W.defaultProps={editable:!1,expanded:!1,onChangeExpanded:function(){}},W.propTypes={editable:c().bool,expanded:c().bool,onChangeExpanded:c().func,asset:c().object,assetId:c().number.isRequired};var Y=t(98209),Q=t(69308),V=function(e){var n=e.filename,t=e.initialCoordinates,o=e.color,r=e.editable,a=e.handleChangeCoordinates,s=(0,H.useRef)(null),l=(0,H.useRef)(null),d=(0,H.useState)(t),c=d[0],u=d[1];(0,H.useEffect)(function(){u(t)},[t]);var m=function(e){if(r){var n=s.current,t=n.clientHeight,i=n.clientWidth,o=l.current,d=o.clientHeight,c=o.clientWidth,m={x:(e.nativeEvent.offsetX-i/2)*100/c,y:(e.nativeEvent.offsetY-t)*100/d};u(m),a(m)}};return(0,i.jsx)(f.Z,{sx:{position:"relative"},children:n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{ref:l,component:"img",src:n,sx:{width:"100%"},onClick:m}),(0,i.jsx)(Q.Z,{ref:s,color:o,sx:{position:"absolute",width:"8%",height:"auto",top:"".concat(c.y,"%"),left:"".concat(c.x,"%")}})]})})};V.defaultProps={initialCoordinates:{x:0,y:0},color:"warning",editable:!1,handleChangeCoordinates:function(){}},V.propTypes={filename:c().string.isRequired,initialCoordinates:c().shape({x:c().number.isRequired,y:c().number.isRequired}).isRequired,color:c().string,editable:c().bool,handleChangeCoordinates:c().func};var J=t(452),X=t(50319),K=function(e){var n,t,o,l,d,c=e.assetId,u=e.asset,m=e.markerColor,x=e.editable,v=e.expanded,I=e.onChangeExpanded,q=(0,_.a)(),S=(0,F.x)().user,P=(0,H.useState)(null),M=P[0],A=P[1],k=(0,p.a)(h.Jt,{variables:{adminId:S.adminId,entityId:c,entity:"Asset",category:"assetFloorplan",type:"image"}}),R=k.data,T=(void 0===R?{items:[]}:R).items,D=k.refetch,E=(0,s.Z)((0,X.D)(h.Wx),1)[0],O=function(e){e.stopPropagation(),q.show({content:(0,i.jsx)(J.z,{accept:"image/*",adminId:S.adminId,category:"assetFloorplan",entity:"Asset",entityId:c,expiryShow:!1,mediaMeta:null,multiple:!1,showAdminOnly:!1,onSuccess:function(){q.close(),D()},type:"image"}),title:"Upload floorplan image"})},N=function(e){M&&clearTimeout(M),A(setTimeout(function(){E({variables:{id:c,changes:{meta:(0,a.Z)((0,r.Z)({},u.meta),{coordinates:e})}}})},1e3))},B="".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(null==T?void 0:null===(n=T[0])||void 0===n?void 0:null===(t=n.item)||void 0===t?void 0:t.filename);return(0,i.jsx)(f.Z,{children:(0,i.jsxs)(y.Z,{expanded:v,onChange:I,children:[(0,i.jsx)(Z.Z,{expandIcon:(0,i.jsx)($.Z,{}),children:(0,i.jsxs)(g.Z,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(w.Z,{variant:"h6",children:"Place asset on floorplan"}),x&&(0,i.jsx)(j.Z,{disableMinWidth:!0,size:"small",color:"secondary",variant:"contained",onClick:O,sx:{mr:2},children:(0,i.jsx)(C.Z,{sx:{height:"17px",width:"17px"}})})]})}),(0,i.jsx)(b.Z,{children:(0,i.jsx)(g.Z,{alignItems:"center",children:(null==T?void 0:null===(o=T[0])||void 0===o?void 0:null===(l=o.item)||void 0===l?void 0:l.filename)?(0,i.jsx)(V,{editable:x,filename:B,initialCoordinates:null===(d=u.meta)||void 0===d?void 0:d.coordinates,markerColor:m,handleChangeCoordinates:N}):(0,i.jsx)(w.Z,{color:"muiGray.main",children:"No image available"})})})]})})};K.defaultProps={asset:{},editable:!1,expanded:!1,onChangeExpanded:function(){}},K.defaultProps={assetId:c().number.isRequired,asset:c().shape({meta:c().shape({coordinates:c().shape({x:c().number.isRequired,y:c().number.isRequired}).isRequired}).isRequired}).isRequired,markerColor:c().string,editable:c().bool,expanded:c().bool,onChangeExpanded:c().func};var ee=t(93946),en=t(56693),et=t(23054),ei=t(28842),eo=t(78394),er=function(e){var n=e.currentStep,t=e.color,o=e.circularProgressSx,s=e.labelComponent;return(0,i.jsxs)(g.Z,{sx:{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center"},children:[(0,i.jsx)(x.Z,(0,a.Z)((0,r.Z)({variant:"determinate"},e),{sx:(0,a.Z)((0,r.Z)({},o),{width:"150px",borderRadius:"50%",boxShadow:"inset 0 0 0 13px #BFBFBF "}),size:"large",value:n})),(0,i.jsx)(f.Z,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",color:void 0===t?"success":t},children:s&&(0,i.jsx)(s,{})})]})},ea=t(8152),es=t(83372),el=function(e){e.start;var n=e.end;return e.isDatesValid?q()(n).isSameOrAfter(new Date)?es.Q.COLOUR.success:es.Q.COLOUR.danger:"transparent"},ed=t(23789),ec=t(62153),eu=t(61730),em=t(50108),ep=t(83704);t.n(ep)()(q());var eh={bubblesWrapper:{borderRadius:"10px"},bubble:{display:"flex",justifyContent:"space-between",minWidth:"100px",padding:"1px 8px",backgroundColor:"green",borderRadius:"20px"},usefulTimeRemainingTile:{border:"1px solid #1E88E5",borderRadius:"7px",padding:"20px 32px"},usefulTimeRemainingTileText:function(e){return(0,r.Z)({alignSelf:"flex-start"},e&&{alignSelf:"center"})},usefulTimeRemainingTileCircular:function(e){return(0,r.Z)({alignSelf:"flex-end"},e&&{alignSelf:"center",margin:"16px 0"})},tile:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{backgroundColor:"#1E88E5"}).backgroundColor;return{width:"45%",minHeight:"70px",borderRadius:"7px",padding:"10px",textAlign:"center",color:"#FFFFFF",backgroundColor:e}},bold:{fontWeight:"600!important"},thin:{fontWeight:300}},ef=function(e){var n,t,o,l,d,c,u,p,h,x,v,j,C,I,S,P,M,A,R,T,D,E,O=e.expanded,N=e.onChangeExpanded,B=e.asset,G=e.qrCodeValue,L=e.jobsTotalByMonths,z=(0,eu.Z)("(max-width: 1800px)"),U=(0,eu.Z)("(max-width: 1400px)"),W=(0,ec.useMainContext)().setPredefinedAssetForWorkOrder,Y=(0,F.x)(),V=Y.user,J=Y.hasRole,X=(0,_.a)(),K=(0,ea.wo)(ea.Fn,B.condition),ep=(0,ea.wo)(ea.of,B.preparationStatus),ef=(Object.entries(L).reduce(function(e,n){var t=(0,s.Z)(n,2);return e+(t[0],t[1])},0)/(null===(n=B.meta)||void 0===n?void 0:null===(t=n.assetAdditional)||void 0===t?void 0:t.estimatedAnnualMaintenance)*100).toFixed(0),ex=function(){X.show({title:"Main photo",content:(0,i.jsx)(k.G,{entity:"Asset",entityId:B.id,category:"assetMainPhoto",onlySingleMedia:!0})})},ev=q()(null===(o=B.meta)||void 0===o?void 0:null===(l=o.assetAdditional)||void 0===l?void 0:l.purchaseDate),eg=q()(null===(d=B.meta)||void 0===d?void 0:null===(c=d.assetAdditional)||void 0===c?void 0:c.estimatedEndDate),ey=eg.diff(ev,"days",!0),eb=eg.diff(q()(),"days"),eZ=q()().isAfter(eg),ej=function(e){e.stopPropagation();var n={customer:B.customer,location:B.location,sublocation:B.sublocation,category:B.category,asset:{id:B.id,name:B.name},assetCategory:B.category,customerUser:J("admin")?{id:B.location.customerUser.id,name:"".concat(B.location.customerUser.nameFirst," ").concat(B.location.customerUser.nameLast)}:{id:V.id,name:"".concat(V.nameFirst," ").concat(V.nameLast)}};W(n),m().push("/dashboard/issues/manage")},ew=function(){X.show({title:"Barcode",content:(0,i.jsx)(ed.CX,{id:"download-asset-barcode-".concat(B.id),value:B.id,collapsible:!1}),submit:!1})},eC=function(){X.show({title:"Qr Code",content:(0,i.jsx)(ed.UH,{id:"download-asset-qrcode-".concat(B.id),value:G,collapsible:!1}),submit:!1})},eI=(0,H.useMemo)(function(){var e=q().duration(ey,"days");return{years:e.clone().years(),months:e.clone().months(),days:e.clone().days()}},[ey]),eq=eI.years,e$=eI.months,e_=eI.days;return(0,i.jsxs)(y.Z,{expanded:O,onChange:N,children:[(0,i.jsx)(Z.Z,{expandIcon:(0,i.jsx)($.Z,{}),children:(0,i.jsx)(w.Z,{typography:"h6",children:"Information"})}),(0,i.jsx)(b.Z,{children:(0,i.jsxs)(g.Z,{rowGap:2,children:[(0,i.jsx)(w.Z,{typography:"h6",sx:(0,a.Z)((0,r.Z)({},eh.bold),{fontSize:"20px"}),children:B.name}),(0,i.jsx)(g.Z,{sx:eh.bubblesWrapper,rowGap:2,mb:5,children:(0,i.jsxs)(g.Z,{direction:"row",columnGap:1,children:[(0,i.jsx)(Q.Z,{}),(0,i.jsxs)(w.Z,{typography:"h6",children:[B.location.name,B.sublocation?"/".concat(null===(u=B.sublocation)||void 0===u?void 0:u.name,"/"):"",null===(p=B.parentAsset)||void 0===p?void 0:p.name]})]})}),(0,i.jsxs)(g.Z,{direction:"row",columnGap:2,rowGap:2,flexWrap:"wrap",children:[(0,i.jsxs)(f.Z,{sx:(0,a.Z)((0,r.Z)({},eh.bubble),{backgroundColor:ep.color,color:ep.fontColor}),children:[(0,i.jsx)(w.Z,{typography:"subtitle1",sx:eh.bold,children:"Status:\xa0"}),(0,i.jsx)(w.Z,{typography:"subtitle1",sx:eh.thin,children:B.preparationStatus?null==ep?void 0:ep.label:"N/A"})]}),(0,i.jsxs)(f.Z,{sx:(0,a.Z)((0,r.Z)({},eh.bubble),{backgroundColor:K.color,color:K.fontColor}),children:[(0,i.jsx)(w.Z,{typography:"subtitle1",sx:eh.bold,children:"Condition:\xa0"}),(0,i.jsx)(w.Z,{typography:"subtitle1",sx:eh.thin,children:B.condition?null==K?void 0:K.label:"N/A"})]})]}),(0,i.jsxs)(g.Z,{direction:"row",justifyContent:"space-between",flexWrap:"wrap",sx:{border:"1px solid",borderColor:"divider",borderLeft:"none",borderRight:"none"},children:[(0,i.jsx)(ee.Z,{onClick:ew,size:"large",sx:{borderRadius:"10px",width:"130px"},children:(0,i.jsxs)(g.Z,{alignItems:"center",children:[(0,i.jsx)(ei.Z,{sx:{width:"50px",height:"50px"},color:"secondary"}),(0,i.jsx)(w.Z,{children:"Barcode"})]})}),(0,i.jsx)(ee.Z,{onClick:eC,size:"large",sx:{borderRadius:"10px",width:"130px"},children:(0,i.jsxs)(g.Z,{alignItems:"center",children:[(0,i.jsx)(eo.Z,{sx:{width:"50px",height:"50px"},color:"secondary"}),(0,i.jsx)(w.Z,{children:"Qr Code"})]})}),(0,i.jsx)(ee.Z,{onClick:ex,size:"large",sx:{borderRadius:"10px",width:"130px"},children:(0,i.jsxs)(g.Z,{alignItems:"center",children:[(0,i.jsx)(en.Z,{sx:{width:"50px",height:"50px"},color:"secondary"}),(0,i.jsx)(w.Z,{children:"Main photo"})]})}),(0,i.jsx)(ee.Z,{onClick:ej,size:"large",sx:{borderRadius:"10px",width:"130px"},children:(0,i.jsxs)(g.Z,{alignItems:"center",children:[(0,i.jsx)(et.Z,{sx:{width:"50px",height:"50px"},color:"secondary"}),(0,i.jsx)(w.Z,{children:"Work order"})]})})]}),(0,i.jsxs)(g.Z,{direction:"row",rowGap:2,flexWrap:"wrap",justifyContent:"space-around",children:[(0,i.jsxs)(f.Z,{sx:eh.tile(),children:[(0,i.jsx)(w.Z,{typography:"h6",children:"Initial cost"}),(0,i.jsx)(w.Z,{typography:"subtitle1",sx:eh.bold,children:(null===(h=B.meta)||void 0===h?void 0:null===(x=h.assetAdditional)||void 0===x?void 0:x.initialCost)?(0,em.T)(B.meta.assetAdditional.initialCost):"N/A"})]}),(0,i.jsxs)(f.Z,{sx:eh.tile(),children:[(0,i.jsx)(w.Z,{typography:"h6",children:"Annual cost"}),(0,i.jsx)(w.Z,{typography:"subtitle1",sx:eh.bold,children:(null===(v=B.meta)||void 0===v?void 0:null===(j=v.assetAdditional)||void 0===j?void 0:j.estimatedAnnualMaintenance)?(0,em.T)(B.meta.assetAdditional.estimatedAnnualMaintenance):"N/A"})]}),(0,i.jsxs)(f.Z,{sx:eh.tile(),children:[(0,i.jsx)(w.Z,{typography:"h6",children:"Residual value"}),(0,i.jsx)(w.Z,{typography:"subtitle1",sx:eh.bold,children:(null===(C=B.meta)||void 0===C?void 0:null===(I=C.assetAdditional)||void 0===I?void 0:I.residualValue)?(0,em.T)(B.meta.assetAdditional.residualValue):"N/A"})]}),(0,i.jsxs)(f.Z,{sx:eh.tile({backgroundColor:ef<=100?es.Q.COLOUR.success:es.Q.COLOUR.danger}),children:[(0,i.jsx)(w.Z,{typography:"h6",children:"Versus budget"}),(0,i.jsx)(w.Z,{typography:"subtitle1",sx:eh.bold,children:(null===(S=B.meta)||void 0===S?void 0:null===(P=S.assetAdditional)||void 0===P?void 0:P.estimatedAnnualMaintenance)?"".concat(ef,"%"):"N/A"})]})]}),(0,i.jsx)(f.Z,{p:2,children:(0,i.jsxs)(g.Z,{sx:(0,r.Z)({},eh.usefulTimeRemainingTile),children:[(0,i.jsx)(w.Z,{typography:"subtitle1",sx:(0,r.Z)({},eh.usefulTimeRemainingTileText(z&&!U)),children:"Useful time remaining"}),(0,i.jsx)(g.Z,{sx:(0,r.Z)({},eh.usefulTimeRemainingTileCircular(z&&!U)),children:(0,i.jsx)(er,{currentStep:(null===(M=B.meta)||void 0===M?void 0:M.assetAdditional)&&!eZ?eb/ey*100:100,circularProgressSx:{color:el({start:ev,end:eg,isDatesValid:!!(null===(A=B.meta)||void 0===A?void 0:null===(R=A.assetAdditional)||void 0===R?void 0:R.purchaseDate)&&!!(null===(T=B.meta)||void 0===T?void 0:null===(D=T.assetAdditional)||void 0===D?void 0:D.estimatedEndDate)})}})}),(0,i.jsxs)(w.Z,{typography:"h5",fontWeight:600,sx:(0,r.Z)({},eh.usefulTimeRemainingTileText(z&&!U)),children:[eq>1?"".concat(eq," years "):eq>0?"".concat(eq," year "):"",e$>1?"".concat(e$," months "):e$>0?"".concat(e$," month "):"",e_>1?"".concat(e_," days "):e_>0?"".concat(e_," day "):""]})]})})]})})]})},ex=t(78840),ev=t.n(ex),eg=t(75708),ey=t.n(eg),eb=function(e,n){var t=q()(n).endOf("month").diff(q()(e).startOf("month"),"months");return t<=0?[]:Array(t+1).fill("").map(function(n,t){return q()(e).add(t,"month").format("MM.YYYY")})},eZ=function(e,n,t){var i=eb(n,t);return i.length?i.map(function(n){return{name:n,y:e[n],color:"#BFBFBF"}}):[]},ej=function(e,n,t,i,o){var r=eb(i,o);if(!r.length)return[];for(var a=[e].concat((0,l.Z)(Array(r.length-1).fill(0))),s=0;s<a.length;s++)0!==s&&(a[s]=a[s-1]+n/12);var d=r.map(function(e,n){return{name:e,x:n,y:a[n],color:es.Q.COLOUR.success}});return d.push({name:r[r.length-1],x:r.length-1,y:t,color:es.Q.COLOUR.success}),d},ew=function(e,n,t,i){var o=eb(t,i);if(!o.length)return[];var r=e;return o.map(function(e,t){var i;return r+=null!==(i=n[e])&&void 0!==i?i:0,{name:e,x:t,y:r,color:es.Q.COLOUR.warning}})},eC=function(e){var n=e.expanded,o=e.onChangeExpanded,r=e.jobsTotalByMonths,a=e.assetAdditional,s=e.maintenanceStart,l=e.maintenanceEnd;return t(18393)(ev()),(0,i.jsxs)(y.Z,{expanded:n,onChange:o,children:[(0,i.jsx)(Z.Z,{expandIcon:(0,i.jsx)($.Z,{}),children:(0,i.jsx)(w.Z,{typography:"h6",children:"Budgeting"})}),(0,i.jsx)(b.Z,{children:(0,i.jsxs)(g.Z,{columnGap:2,children:[(0,i.jsx)(ey(),{callback:function(e){e.reflow()},constructorType:"chart",Highcharts:ev(),options:{chart:{type:"column"},title:{text:null},series:[{name:"Work orders total by month",data:eZ(r,s,l),color:es.Q.COLOUR.muiGray}],xAxis:{title:null,categories:eb(s,l)},yAxis:{title:null,formatter:function(){return(0,em.T)(this.value)}},tooltip:{shared:!1,useHTML:!0,formatter:function(){return"<b>".concat(this.point.name,"</b><br/>Price: ").concat((0,em.T)(this.y))}}}}),(0,i.jsx)(ey(),{callback:function(e){e.reflow()},constructorType:"chart",Highcharts:ev(),options:{chart:{type:"line"},title:{text:null},series:[{name:"Annual maintenance",color:es.Q.COLOUR.success,data:ej(null==a?void 0:a.initialCost,null==a?void 0:a.estimatedAnnualMaintenance,null==a?void 0:a.residualValue,s,l),marker:{enabled:!0}},{name:"Work orders",color:es.Q.COLOUR.danger,data:ew(null==a?void 0:a.initialCost,r,s,l),marker:{enabled:!0}}],xAxis:{title:null,categories:eb(s,l)},yAxis:{title:null,formatter:function(){return(0,em.T)(this.value)},tickInterval:2e3},tooltip:{useHTML:!0,formatter:function(){return"<b>".concat(this.point.name,"</b><br/>Price: ").concat((0,em.T)(this.y))}}}})]})})]})},eI=t(7739),eq=t.n(eI),e$=t(19504),e_=v.ZP,eS=function(e){var n,t,d,c,u,v,y,b,Z,j,w,C,I,$,_,S,P,M,R=e.id,T=e.editable,D=e.showMediaButtons,E=(0,H.useState)(["asset-details","asset-qr-code","asset-bar-code","asset-floorplan","asset-media","asset-work-orders","asset-information","asset-charts"]),F=E[0],O=E[1],N=(0,p.a)(h.yC,{variables:{id:R}}),B=N.loading,G=N.data,L=(void 0===G?{asset:{}}:G).asset,z=(null==L?void 0:null===(n=L.meta)||void 0===n?void 0:null===(t=n.assetAdditional)||void 0===t?void 0:t.purchaseDate)?q()(null==L?void 0:null===(d=L.meta)||void 0===d?void 0:null===(c=d.assetAdditional)||void 0===c?void 0:c.purchaseDate,"YYYY-MM-DD"):q()(L.createdAt),U=(null==L?void 0:null===(u=L.meta)||void 0===u?void 0:null===(v=u.assetAdditional)||void 0===v?void 0:v.estimatedEndDate)?q()(null==L?void 0:null===(y=L.meta)||void 0===y?void 0:null===(b=y.assetAdditional)||void 0===b?void 0:b.estimatedEndDate,"YYYY-MM-DD"):q()(z).startOf("month").add(12,"month"),Q=(0,p.a)(h.YG,{variables:{assetId:R,start:z,end:U}}).data,V=(void 0===Q?{jobs:[]}:Q).jobs,J=Object.entries(eq()(V.map(function(e){return(0,a.Z)((0,r.Z)({},e),{date:q()(null!==(M=e.scheduledAt)&&void 0!==M?M:e.timingStart).format("MM.YYYY")})}),"date")).reduce(function(e,n){var t=(0,s.Z)(n,2),i=t[0],l=t[1].reduce(function(e,n){var t,i,o=(null!==(i=n.customerVatTotal)&&void 0!==i?i:0)/((null===(t=n.assets)||void 0===t?void 0:t.length)||1);return(0,e$.l)(e+o,2)},0);return(0,a.Z)((0,r.Z)({},e),(0,o.Z)({},i,l))},{});if(!B&&!(null==L?void 0:L.id))return m().push("/404"),null;var X=function(e){return function(n,t){t?O(function(n){return(0,l.Z)(n).concat([e])}):O(function(n){return n.filter(function(n){return n!==e})})}},ee="".concat(Y.C1.portalUrl,"/dashboard/assets/view?id=").concat(R),en=(null===(Z=L.category)||void 0===Z?void 0:Z.childs)||[],et=(null===(j=L.meta)||void 0===j?void 0:j.categoryQuestions)||{};return B?(0,i.jsx)(g.Z,{height:"100%",justifyContent:"center",alignItems:"center",children:(0,i.jsx)(x.Z,{color:"secondary"})}):(0,i.jsxs)(e_,{container:!0,spacing:4,children:[(0,i.jsx)(e_,{item:!0,xs:12,md:6,lg2:3,children:(0,i.jsxs)(g.Z,{spacing:2,children:[(0,i.jsx)(ef,{asset:L,qrCodeValue:ee,expanded:F.includes("asset-information"),onChangeExpanded:X("asset-information"),jobsTotalByMonths:J}),(0,i.jsx)(A,{editable:T,expanded:F.includes("asset-details"),onChangeExpanded:X("asset-details"),assetId:L.id,name:L.name,description:L.description,parentAsset:null===(w=L.parentAsset)||void 0===w?void 0:w.name,customer:null===(C=L.customer)||void 0===C?void 0:C.name,location:null===(I=L.location)||void 0===I?void 0:I.name,sublocation:null===($=L.sublocation)||void 0===$?void 0:$.name,category:null===(_=L.category)||void 0===_?void 0:_.name,createdAt:L.createdAt,status:L.status,categoryQuestions:en,categoryAnswers:et,assetAdditional:null==L?void 0:null===(S=L.meta)||void 0===S?void 0:S.assetAdditional})]})}),(0,i.jsx)(e_,{item:!0,xs:12,md:6,lg2:4,children:(0,i.jsxs)(g.Z,{spacing:2,children:[(0,i.jsx)(K,{editable:T,expanded:F.includes("asset-floorplan"),onChangeExpanded:X("asset-floorplan"),assetId:R,asset:L}),(0,i.jsx)(f.Z,{children:(0,i.jsx)(k.G,{showActionButtons:D,expanded:F.includes("asset-media"),onChangeExpanded:X("asset-media"),details:!0,entity:"Asset",category:"media",entityId:parseInt(R)})}),(0,i.jsx)(eC,{expanded:F.includes("asset-charts"),onChangeExpanded:X("asset-charts"),jobsTotalByMonths:J,assetAdditional:null===(P=L.meta)||void 0===P?void 0:P.assetAdditional,maintenanceStart:z,maintenanceEnd:U})]})}),(0,i.jsx)(e_,{item:!0,xs:12,md:6,lg2:5,children:(0,i.jsx)(W,{editable:T,expanded:F.includes("asset-work-orders"),onChangeExpanded:X("asset-work-orders"),assetId:R,asset:L})})]})};eS.defaultProps={showMediaButtons:!0},eS.propTypes={id:c().number.isRequired,editable:c().bool.isRequired,showMediaButtons:c().bool.isRequired};var eP=t(24716),eM=function(){var e,n,t=(0,F.x)(),o=t.user,r=t.hasRole,a=(0,u.useRouter)().query,s=(0,N.q)(),l=null==s?void 0:null===(e=s.admin)||void 0===e?void 0:null===(n=e.modules)||void 0===n?void 0:n.assets,d=r("admin"),c=r("tenant");return o?l?(0,i.jsx)(eS,{id:a.id,editable:d,showMediaButtons:!c}):(m().push("/404"),null):(m().push("/account/sign-in"),null)},eA=eM;eM.getLayout=function(e){return(0,i.jsx)(eP.Z,{children:e})}}},function(e){e.O(0,[3662,6898,2283,212,8890,9511,2583,6310,4599,4135,8579,4244,7645,3776,1564,2329,778,3054,1023,3911,1417,9957,6540,3425,1870,5037,8062,1352,2429,1207,5117,9313,3704,1050,3977,7036,4716,8359,6557,9591,9774,2888,179],function(){return e(e.s=86432)}),_N_E=e.O()}]);