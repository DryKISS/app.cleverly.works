(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2744],{6315:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/workflows",function(){return n(3001)}])},19512:function(e,t,n){"use strict";n.d(t,{D:function(){return a}});var r=n(67294),o=n(21925),a=function(){var e=(0,r.useContext)(o.S);if(!e)throw Error("useSnackbarContext must be used within the SnackbarProvider");return e}},62547:function(e,t,n){"use strict";n.d(t,{V:function(){return S}});var r=n(26042),o=n(69396),a=n(29815),i=n(85893),l=n(45697),s=n.n(l),u=n(93946),d=n(51233),c=n(15861),p=n(21023),v=n(96540),f=n(67294),m=n(83162),x=n(42283),g=n(79665),h=n(11057),b=n(50135),y=n(77957),j=n(41733),T=n(16310),Z=T.Ry({name:T.Z_().required(),url:T.Z_().url().required()}),C=h.Z,w=function(e){var t=e.noEdit,n=e.noDelete,a=e.onDelete,l=e.id,s=e.isAdded,c=e.url,v=e.name,h=e.onSave,T=(0,f.useState)(s),w=T[0],k=T[1],S=(0,x.cI)({resolver:(0,g.S)(Z)}),q=S.control,I=S.handleSubmit,P=S.errors,D=function(e){e.stopPropagation(),k(!0)},R=function(e){e.stopPropagation(),k(!1),v&&c||a()},O=function(e){h(e),k(!1)};return(0,i.jsx)("form",{children:w?(0,i.jsxs)(d.Z,{children:[(0,i.jsxs)(d.Z,{spacing:1,children:[(0,i.jsx)(x.Qr,{control:q,name:"name",defaultValue:v,render:function(e){var t;return(0,i.jsx)(b.Z,(0,o.Z)((0,r.Z)({fullWidth:!0,label:"Name",variant:"standard",color:"secondary"},e),{error:P.name,helperText:null===(t=P.name)||void 0===t?void 0:t.message}))}}),(0,i.jsx)(x.Qr,{control:q,name:"url",defaultValue:c,render:function(e){var t;return(0,i.jsx)(b.Z,(0,o.Z)((0,r.Z)({fullWidth:!0,label:"Link",variant:"standard",color:"secondary"},e),{error:P.url,helperText:null===(t=P.url)||void 0===t?void 0:t.message}))}})]}),(0,i.jsxs)(d.Z,{direction:"row",justifyContent:"flex-end",spacing:1,mt:2,children:[(0,i.jsx)(C,{variant:"contained",color:"danger",size:"small",onClick:R,children:"Cancel"}),(0,i.jsx)(C,{variant:"contained",size:"small",onClick:I(O),children:"Save"})]})]}):(0,i.jsxs)(d.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,i.jsx)(m.r,{target:"_blank",variant:"body1",color:"secondary",href:c,sx:{textDecoration:"auto",fontWeight:700},children:v}),!t&&(0,i.jsx)(p.Z,{title:"Edit",placement:"top-start",children:(0,i.jsx)(u.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:D,children:(0,i.jsx)(y.Z,{sx:{fontSize:"16px"}})})}),!n&&(0,i.jsx)(p.Z,{title:"Delete",placement:"top-start",children:(0,i.jsx)(u.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:function(){return a(l)},children:(0,i.jsx)(j.Z,{sx:{fontSize:"16px"}})})})]})})};w.defaultProps={isAdded:!1,noEdit:!1,noDelete:!1,url:"",name:"",onSave:function(){},onCancel:function(){},onDelete:function(){}},w.propTypes={isAdded:s().bool,noEdit:s().bool,noDelete:s().bool,url:s().string,name:s().string,onSave:s().func,onCancel:s().func,onDelete:s().func};var k=n(74944),S=function(e){var t=e.values,n=e.setValue,l=e.name,s=e.title,m=e.displayMode,x=e.noDeleteEdit,g=e.titleSx,h=(0,f.useState)([]),b=h[0],y=h[1],j=(0,(0,k.x)().hasRole)("tenant");(0,f.useEffect)(function(){Array.isArray(t)&&y(t)},[t]);var T=function(e){e.stopPropagation(),y(function(e){return(0,a.Z)(e).concat([{name:"",link:"",isAdded:!0}])})},Z=function(e,t){var r=(0,a.Z)(b);r.splice(e,1,t),n(l,r)};return(0,i.jsxs)(d.Z,{children:[(0,i.jsxs)(d.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,i.jsxs)(c.Z,{sx:g,children:[s,":"]}),!m&&!j&&(0,i.jsx)(p.Z,{title:"Add new link",placement:"top-start",children:(0,i.jsx)(u.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:T,children:(0,i.jsx)(v.Z,{})})})]}),(0,i.jsx)(d.Z,{pl:2,spacing:.8,children:(null==b?void 0:b.length)?b.map(function(e,a){var s;return(0,i.jsx)(w,(0,o.Z)((0,r.Z)({index:a},e),{noEdit:x||m,noDelete:x||m,onDelete:function(){var e=t.filter(function(e,t){return t!==a});n(l,e),y(e)},onSave:function(e){return Z(a,e)}}))}):(0,i.jsx)(c.Z,{typography:"subtitle2",children:"No data"})})]})};S.defaultProps={values:[],setValue:function(){},title:"Related links",displayMode:!1,noDeleteEdit:!1,titleSx:{}},S.propTypes={values:s().arrayOf(s().shape({isAdded:s().bool,noEdit:s().bool,url:s().string,name:s().string})),titleSx:s().object,setValue:s().func,noDeleteEdit:s().bool}},18531:function(e,t,n){"use strict";n.d(t,{q:function(){return f}});var r=n(26042),o=n(69396),a=n(99534),i=n(85893),l=n(87918),s=n(98456),u=n(23776),d=n(50135),c=n(67294),p=n(45697),v=n.n(p),f=function(e){var t=e.loading,n=e.setSearch,p=e.textFieldProps,v=(e.disableClearable,(0,a.Z)(e,["loading","setSearch","textFieldProps","disableClearable"])),f=(0,c.useState)(""),m=f[0],x=f[1];return(0,c.useEffect)(function(){var e=setTimeout(function(){n(m)},500);return function(){return clearTimeout(e)}},[m,n]),(0,i.jsx)(u.Z,(0,o.Z)((0,r.Z)({isOptionEqualToValue:function(e,t){return e.value===t.value}},v),{loading:t,onInputChange:function(e,t){x(t)},getOptionLabel:function(e){return"".concat(e.label)},renderTags:function(e,t){return e.map(function(e,n){return(0,i.jsx)(l.Z,(0,r.Z)({size:"small",label:e.label},t({index:n})))})},renderInput:function(e){return(0,i.jsx)(d.Z,(0,o.Z)((0,r.Z)({},e,p),{InputProps:(0,o.Z)((0,r.Z)({},e.InputProps,p.InputProps||{}),{endAdornment:(0,i.jsxs)(i.Fragment,{children:[t?(0,i.jsx)(s.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}}))};f.defaultProps={color:"secondary",onChange:function(){},options:[],onOpen:function(){},setSearch:function(){},textFieldProps:{}},f.propTypes={multiple:v().bool,limitTags:v().number,filterSelectedOptions:v().bool,color:v().string,loading:v().bool,value:v().oneOf([v().array,v().object]),onChange:v().func,options:v().arrayOf(v().shape({value:v().any.isRequired,label:v().string.isRequired})).isRequired,onOpen:v().func,setSearch:v().func,textFieldProps:v().shape({label:v().string,variant:v().oneOf(["standard"]),color:v().string,error:v().bool,helperText:v().string})}},83162:function(e,t,n){"use strict";n.d(t,{r:function(){return p}});var r=n(26042),o=n(69396),a=n(99534),i=n(85893),l=n(45697),s=n.n(l),u=n(41664),d=n.n(u),c=n(23795),p=function(e){var t=e.children,n=e.href,l=e.noWrap,s=e.target,u=e.sx,p=void 0===u?{}:u,v=(0,a.Z)(e,["children","href","noWrap","target","sx"]);return l?(0,i.jsx)(i.Fragment,{children:t}):n?(0,i.jsx)(d(),{href:n,target:s,passHref:!0,children:(0,i.jsx)(c.Z,(0,o.Z)((0,r.Z)({sx:p,children:t,href:n,noWrap:l,target:s},v),{children:t}))}):(0,i.jsx)(c.Z,(0,o.Z)((0,r.Z)({sx:p,children:t,href:n,noWrap:l,target:s},v),{children:t}))};p.defaultProps={onClick:function(e){e.stopPropagation()}},p.propTypes={onClick:s().func,href:s().string,noWrap:s().bool,color:s().string}},34187:function(e,t,n){"use strict";n.d(t,{C:function(){return v}});var r=n(26042),o=n(69396),a=n(85893);n(67294);var i=n(45697),l=n(90948),s=n(15861),u=n(51233),d=n(11057),c=n(61730),p=(0,l.ZP)("img")({width:"300px",height:"250px"}),v=function(e){var t=e.imageSrc,n=e.sx,i=e.imageSx,l=e.title,v=e.titleSx,f=e.subtitleFirstLine,m=e.subtitleFirstLineSx,x=e.subtitleSecondLine,g=e.subtitleSecondLineSx,h=e.buttonText,b=e.onAction,y=(0,c.Z)("(max-width: 400px)");return(0,a.jsxs)(u.Z,{sx:(0,o.Z)((0,r.Z)({},n),{width:"100%",height:"100%"}),justifyContent:"center",alignItems:"center",spacing:2,color:"#757575",children:[(0,a.jsx)(p,{src:t,sx:(0,o.Z)((0,r.Z)({},i),{width:y?"250px":"300px"})}),(0,a.jsx)(s.Z,{typography:"h5",sx:(0,r.Z)({},v),children:l}),(0,a.jsxs)(u.Z,{alignItems:"center",sx:{padding:"0px 10px",textAlign:"center"},children:[(0,a.jsx)(s.Z,{sx:(0,r.Z)({},m),children:f}),(0,a.jsx)(s.Z,{sx:(0,r.Z)({},g),children:x})]}),h&&b&&(0,a.jsx)(d.Z,{variant:"contained",color:"secondary",onClick:b,children:h})]})};v.propTypes={imageSrc:i.string,title:i.string,subtitleFirstLine:i.string,subtitleSecondLine:i.string,onAction:i.func,sx:i.object,imageSx:i.object,titleSx:i.object,subtitleFirstLineSx:i.object,subtitleSecondLineSx:i.object},v.defaultProps={title:"",subtitleFirstLine:"",subtitleSecondLine:"",sx:{},imageSx:{},titleSx:{},subtitleFirstLineSx:{},subtitleSecondLineSx:{},onAction:null}},69297:function(e,t,n){"use strict";n.d(t,{E:function(){return x}});var r=n(26042),o=n(69396),a=n(85893),i=n(45697),l=n.n(i),s=n(94054),u=n(50480),d=n(56815),c=n(40476),p=n(79717),v=n(36872),f=n(51233),m=n(15861),x=function(e){var t=e.label,n=e.options,i=e.error,l=e.helperText,x=e.stackProps,h=e.formControlProps,b=e.labelLeft,y=function(e){var t=e.children;return(0,a.jsx)(a.Fragment,{children:t})};return(0,a.jsxs)(s.Z,(0,o.Z)((0,r.Z)({sx:{m:3},error:i,variant:"standard"},void 0===h?{}:h),{children:[(0,a.jsxs)(f.Z,(0,o.Z)((0,r.Z)({},b&&g),{children:[t&&(0,a.jsx)(c.Z,{id:"radio-group",color:"secondary",children:t}),(0,a.jsx)(p.Z,(0,o.Z)((0,r.Z)({},e),{"aria-labelledby":"radio-group",children:(0,a.jsx)(f.Z,(0,o.Z)((0,r.Z)({},void 0===x?{}:x),{children:n.map(function(e){var t=e.value,n=e.label,r=e.icon,o=e.ParentComponent;return(0,a.jsx)(void 0===o?y:o,{children:(0,a.jsx)(u.Z,{value:t,control:(0,a.jsx)(v.Z,{color:"secondary"}),label:(0,a.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:1,children:[r,(0,a.jsx)(m.Z,{children:n})]})})})})}))}))]})),(0,a.jsx)(d.Z,{children:l})]}))};x.defaultProps={options:[],error:!1,helperText:"",stackProps:{},formControlProps:{},labelLeft:!1},x.propTypes={label:l().string,options:l().arrayOf(l().shape({label:l().string.isRequired,value:l().any.isRequired,ParentComponent:l().elementType})).isRequired,error:l().bool,helperText:l().string,stackProps:l().object,formControlProps:l().object,labelLeft:l().bool};var g={direction:"row",alignItems:"center",flexWrap:"wrap",spacing:1}},91830:function(e,t,n){"use strict";n.d(t,{P:function(){return T}});var r=n(26042),o=n(69396),a=n(85893),i=n(67294),l=n(10166),s=n(45697),u=n.n(s),d=n(94054),c=n(47312),p=n(18972),v=n(18360),f=n(56815),m=n(51233),x=n(15861),g=n(5616),h=n(87918),b=n(69368),y={text:function(e){var t=e.option,n=e.multiple,r=e.index;return n&&r>0?", ".concat(t.label):t.label},textWithIcon:function(e){var t=e.option;return(0,a.jsxs)(m.Z,{direction:"row",alignItems:"center",spacing:1,children:[t.icon,(0,a.jsxs)(x.Z,{children:[" ",t.label]})]})},chip:function(e){var t=e.chipProps,n=e.option;return(0,i.createElement)(h.Z,(0,o.Z)((0,r.Z)({},t),{key:n.value,label:n.label,icon:n.icon,sx:{color:n.color,bgcolor:n.bgcolor}}))}},j={text:function(e){return e.option.label},textWithIcon:function(e){var t=e.option;return(0,a.jsxs)(m.Z,{direction:"row",alignItems:"center",spacing:1,children:[t.icon,(0,a.jsxs)(x.Z,{children:[" ",t.label]})]})},chip:function(e){var t=e.chipProps,n=e.option;return(0,i.createElement)(h.Z,(0,o.Z)((0,r.Z)({},t),{key:n.value,label:n.label,icon:n.icon,sx:{color:n.color,bgcolor:n.bgcolor}}))},checkbox:function(e){var t=e.option,n=e.value;return(0,a.jsxs)(m.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,a.jsx)(b.Z,{color:"secondary",sx:{height:"10px"},checked:n.indexOf(t.value)>-1}),(0,a.jsxs)(x.Z,{children:[" ",t.label]})]})}},T=function(e){var t=e.label,n=e.value,i=e.onChange,l=e.leftSideLabel,s=e.options,u=e.inputComponent,d=e.selectComponent,c=e.withoutSelectIcon,m=e.formControl,h=e.chipProps,b=e.selectProps,T=function(e){return s.find(function(t){return t.value===e})};return(0,a.jsxs)(Z,(0,o.Z)((0,r.Z)({},m),{leftSideLabel:l,withoutSelectIcon:c,children:[t&&l&&(0,a.jsx)(x.Z,{children:t}),t&&!l&&(0,a.jsx)(C,{shrink:""!==n&&void 0!==n,children:t}),(0,a.jsx)(v.Z,(0,o.Z)((0,r.Z)({displayEmpty:!0},b),{value:n,onChange:i,inputProps:{shrink:!0},renderValue:function(){if(Array.isArray(n))return(0,a.jsx)(g.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.map(function(e,t){var n=T(e);return n?y[u]({chipProps:h,option:n,multiple:!0,index:t}):""})});var e=T(n);return e?(0,a.jsx)(g.Z,{children:y[u]({chipProps:h,option:e})}):""},children:s.map(function(e){return(0,a.jsx)(p.Z,{value:e.value,children:j[d]({chipProps:h,option:e,value:n})},e.value)})})),(null==m?void 0:m.helperText)&&(0,a.jsx)(f.Z,{children:m.helperText})]}))};T.defaultProps={label:"",onChange:function(){},leftSideLabel:!1,options:[],inputComponent:"text",selectComponent:"text",withoutSelectIcon:!1,formControl:{error:!1,helperText:""},chipProps:{size:"small"},selectProps:{}},T.propTypes={label:u().string,value:u().oneOfType([u().string,u().array]),onChange:u().func,leftSideLabel:u().bool,options:u().arrayOf(u().shape({label:u().string.isRequired,value:u().string.isRequired,color:u().string,bgcolor:u().string,icon:u().node}).isRequired),inputComponent:u().oneOf(["text","textWithIcon","chip"]),selectComponent:u().oneOf(["text","textWithIcon","chip","checkbox"]),withoutSelectIcon:u().bool,formControl:u().object,chipProps:u().object,selectProps:u().object};var Z=(0,l.Z)(d.Z)(function(e){e.theme;var t=e.leftSideLabel,n=e.withoutSelectIcon;return{"&.MuiFormControl-root":(0,r.Z)({display:"flex",flexDirection:"column",alignItems:"flex-start"},t&&{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"}),"& .MuiSelect-icon":(0,r.Z)({},n&&{display:"none"})}}),C=(0,l.Z)(c.Z)(function(e){return{"&.MuiFormLabel-root.MuiInputLabel-root.Mui-focused":{color:e.theme.palette.secondary.main}}})},12632:function(e,t,n){"use strict";n.d(t,{x:function(){return d}});var r=n(14924),o=n(26042),a=n(69396),i=n(67294),l=n(96486),s=n(98209),u=n(59577),d=function(e){var t,n,d,c,p,v,f,m,x,g,h,b=e.filters,y=e.newFilters,j=e.initialSort,T=(0,i.useRef)(),Z=(0,i.useState)({}),C=Z[0],w=Z[1],k=(0,i.useState)({}),S=k[0],q=k[1],I=j||{item:"createdAt",order:"desc"},P=(0,r.Z)({},(null===(t=T.current)||void 0===t?void 0:t.sort.item)||I.item,I.inneritem?(0,r.Z)({},I.inneritem,(null===(n=T.current)||void 0===n?void 0:n.sort.order)||I.order):(null===(d=T.current)||void 0===d?void 0:d.sort.order)||I.order);return(0,i.useEffect)(function(){var e=!(0,l.isEqual)(C,b),t=!(0,l.isEqual)(S,y);if(e&&(w(b),null==T||null===(r=T.current)||void 0===r||r.resetPagination()),t&&(q(y),null==T||null===(o=T.current)||void 0===o||o.resetPagination()),(null==T?void 0:null===(n=T.current)||void 0===n?void 0:n.setSort)&&!(e||t)){var n,r,o,a,i,s,u,d,c,p,v,f=(null===(a=T.current)||void 0===a?void 0:null===(i=a.sort)||void 0===i?void 0:i.item)&&(null===(s=T.current)||void 0===s?void 0:null===(u=s.sort)||void 0===u?void 0:u.order)?{item:null===(d=T.current)||void 0===d?void 0:null===(c=d.sort)||void 0===c?void 0:c.item,order:null===(p=T.current)||void 0===p?void 0:null===(v=p.sort)||void 0===v?void 0:v.order}:P;T.current.setSort(f)}},[b,y]),{initialData:(0,a.Z)((0,o.Z)({},b),{newFilters:(null==y?void 0:y.length)>0?y:void 0,limit:(null===(c=T.current)||void 0===c?void 0:c.pageSize)==="Infinity"?null:parseInt(null===(p=T.current)||void 0===p?void 0:p.pageSize,10)||s.C1.paginationSize,offset:((null===(v=T.current)||void 0===v?void 0:v.currentPage)-1||0)*((null===(f=T.current)||void 0===f?void 0:f.pageSize)||s.C1.paginationSize),orderBy:(0,u.c)(null===(m=T.current)||void 0===m?void 0:null===(x=m.sort)||void 0===x?void 0:null===(g=x.item)||void 0===g?void 0:g.replace(/ORDER/i,null===(h=T.current)||void 0===h?void 0:h.sort.order))||P}),initialSort:j,ref:T}}},42074:function(e,t,n){"use strict";n.d(t,{n:function(){return W}});var r=n(47568),o=n(26042),a=n(69396),i=n(828),l=n(29815),s=n(97582),u=n(85893),d=n(45697),c=n.n(d),p=n(96486),v=n(6812),f=n(50319),m=n(11961),x=n(93362),g=n(23776),h=n(5616),b=n(98456),y=n(93946),j=n(78462),T=n(18972),Z=n(14564),C=n(51233),w=n(50135),k=n(67294),S=n(10166),q=n(74944),I=n(22428),P=n(16380),D=n(71403),R=y.Z,O=(0,x.D)(),W=function(e){var t=e.entityId,n=e.entity,d=e.values,c=void 0===d?[]:d,x=e.name,y=void 0===x?"tags":x,Z=e.setValue,S=(0,q.x)().user,W=(0,k.useState)(null),E=W[0],L=W[1],Q=(0,k.useState)(""),A=Q[0],U=Q[1],F=(0,k.useState)(""),N=F[0],V=F[1],M=(0,k.useState)(""),$=M[0],G=M[1],H=(0,v.a)(P.BU,{skip:!t,variables:{entityId:t,entity:n},onCompleted:function(e){Z(y,e.tags)}}),z=H.data,B=(void 0===z?{tags:[]}:z).tags,J=H.loading,X=H.refetch,Y=(0,v.a)(P.gI,{skip:!E,variables:{entityId:t,entity:n,q:""!==$?"%".concat($,"%"):null}}),K=Y.data,ee=(void 0===K?{tags:[]}:K).tags,et=Y.loading,en=(0,i.Z)((0,f.D)(P.Zm,{refetchQueries:["GetAllTags"]}),2),er=en[0],eo=en[1].loading,ea=(0,i.Z)((0,f.D)(P.LE,{onCompleted:function(){X()}}),2),ei=ea[0],el=ea[1].loading,es=(0,i.Z)((0,f.D)(P.cS,{onCompleted:function(){X()}}),2),eu=es[0],ed=es[1].loading,ec=(0,i.Z)((0,f.D)(P.g$,{refetchQueries:["GetAllTags"]}),2),ep=ec[0],ev=ec[1].loading;(0,k.useEffect)(function(){var e=setTimeout(function(){G(N)},500);return function(){return clearTimeout(e)}},[N]);var ef,em,ex,eg=function(e){e.stopPropagation(),L(e.currentTarget)},eh=function(){L(null)},eb=(ef=(0,r.Z)(function(e,r){var o,a,i;return(0,s.__generator)(this,function(e){switch(e.label){case 0:if("string"!=typeof r)return[3,1];return U({label:r}),[3,6];case 1:if(!(r&&r.inputValue&&t))return[3,2];return ei({variables:{objects:[{entity:n,entityId:t,Taxonomy:{data:{type:"tags",status:"active",name:r.inputValue,meta:{color:"#0679d8"},isGroup:!1,adminId:S.adminId}}}]}}),U(null),[3,6];case 2:if(!(r&&r.value&&t))return[3,3];return ei({variables:{objects:[{entity:n,entityId:t,taxonomyId:r.value}]}}),U(null),[3,6];case 3:if(!(r&&r.inputValue))return[3,5];return[4,er({variables:{objects:[{type:"tags",status:"active",name:r.inputValue,meta:{color:"#0679d8"},isGroup:!1,adminId:S.adminId}]}})];case 4:return i=e.sent().data.insert_Taxonomy,Z(y,(0,l.Z)(c).concat([{id:null,tag:{id:i.returning[0].id,name:i.returning[0].name,meta:i.returning[0].meta}}])),U(null),[3,6];case 5:r&&r.value&&(Z(y,(0,l.Z)(c).concat([{id:null,tag:{id:r.value,name:r.label,meta:r.meta}}])),U(null)),e.label=6;case 6:return[2]}})}),function(e,t){return ef.apply(this,arguments)}),ey=(0,k.useCallback)(function(e,t){var n=O(e,t),r=t.inputValue,o=e.some(function(e){return r===e.label});return""===r||o||n.push({inputValue:r,label:'Add "'.concat(r,'"')}),n},[]),ej=(0,k.useCallback)(function(e){return"string"==typeof e?e:e.inputValue?e.inputValue:e.label},[]),eT=function(e){t?eu({variables:{tagEntityId:e}}):Z(y,c.filter(function(t,n){return n!==e}))},eZ=(em=(0,r.Z)(function(e){var t,n,r,i,l,u;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,ep({variables:{tagId:t=e.tagId,object:{meta:{color:e.color}}}})];case 1:return l=n.sent().data.update_Taxonomy_by_pk,Z(y,c.map(function(e){return e.tag.id===t?(0,a.Z)((0,o.Z)({},e),{tag:(0,o.Z)({},l)}):e})),[2]}})}),function(e){return em.apply(this,arguments)}),eC=(ex=(0,r.Z)(function(e){var t,n,r,i,l,u;return(0,s.__generator)(this,function(r){switch(r.label){case 0:return[4,ep({variables:{tagId:t=e.tagId,object:{name:n=e.name}}})];case 1:return l=r.sent().data.update_Taxonomy_by_pk,Z(n,c.map(function(e){return e.tag.id===t?(0,a.Z)((0,o.Z)({},e),{tag:(0,o.Z)({},l)}):e})),[2]}})}),function(e){return ex.apply(this,arguments)}),ew=Boolean(E),ek=(0,k.useMemo)(function(){return ee.map(function(e){return{label:e.name,value:e.id,meta:e.meta}})},[ee]),eS=(0,k.useMemo)(function(){return p.uniqBy((0,l.Z)(B).concat((0,l.Z)(c)),function(e){var t;return null===(t=e.tag)||void 0===t?void 0:t.id})},[B,c]);return(0,u.jsxs)(C.Z,{direction:"row",alignItems:"center",children:[(0,u.jsx)(D.P,{tags:eS,handleDeleteTagEntity:eT}),(0,u.jsx)(_,{id:ew?"tags-popover":void 0,open:ew,anchorEl:E,onClose:eh,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,u.jsxs)(h.Z,{sx:{maxHeight:"80vh",width:"280px",p:"10px",pt:"5px"},children:[(0,u.jsx)(g.Z,{freeSolo:!0,selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:(0,l.Z)(ek),value:A,onChange:eb,onInputChange:function(e,t){V(t)},filterOptions:ey,getOptionLabel:ej,renderOption:function(e,t){return(0,u.jsx)(T.Z,(0,a.Z)((0,o.Z)({},e),{children:t.label}))},renderInput:function(e){return(0,u.jsx)(w.Z,(0,a.Z)((0,o.Z)({},e),{variant:"standard",color:"secondary",label:"Search tag",InputProps:(0,a.Z)((0,o.Z)({},e.InputProps),{endAdornment:(0,u.jsxs)(u.Fragment,{children:[et||eo||el?(0,u.jsx)(b.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))},sx:{pl:"16px",pr:"16px"}}),J||ed||ev?(0,u.jsx)(C.Z,{width:"100%",alignItems:"center",p:4,children:(0,u.jsx)(b.Z,{color:"secondary"})}):(0,u.jsx)(j.Z,{children:null==eS?void 0:eS.map(function(e,t){var n;return(0,u.jsx)(I.T,{tagEntityId:e.id||t,tagId:e.tag.id,name:e.tag.name,color:null===(n=e.tag.meta)||void 0===n?void 0:n.color,onDelete:eT,onColorChange:eZ,onNameChange:eC})})})]})}),(0,u.jsx)(R,{color:"black",onClick:eg,children:(0,u.jsx)(m.Z,{sx:{height:"16px",width:"16px"}})})]})};W.defaultProps={entityId:null},W.propTypes={entityId:c().number};var _=(0,S.Z)(Z.ZP)({"& .MuiPaper-root":{borderRadius:"12px"}})},71559:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Job",n="";return(null==e?void 0:e.length)&&(n="\n      Taxonomy: {\n      _and: [\n        { entity: { _eq: ".concat(t,' } }\n        {\n          Taxonomy: {\n            status: { _eq: "active" }\n            _and: [{ id: { _in: [').concat(e,'] } }, { type: { _eq: "tags" } }]\n          }\n        }\n      ]\n    }\n  ')),n}},59577:function(e,t,n){"use strict";n.d(t,{c:function(){return r}});var r=function(e){try{return JSON.parse(e)}catch(t){return!1}}},67797:function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var r=n(85893),o=n(11994),a=n(67294);function i(){var e=(0,a.useState)(null),t=e[0],n=e[1],i=(0,a.useCallback)(function(){n(null)},[]),l=(0,a.useMemo)(function(){if(null===t)return null;var e=t.content,n=t.keepMounted;return(0,r.jsx)(o.Z,{open:!0,keepMounted:n,onClose:i,children:e})},[t,i]),s=(0,a.useCallback)(function(e){var t=e.content,r=e.keepMounted;n({keepMounted:void 0===r||r,content:t({onClose:i})})},[i]);return[l,s]}},31312:function(e,t,n){"use strict";n.d(t,{AK:function(){return s},E6:function(){return o},cj:function(){return l},hD:function(){return d},iz:function(){return a},l8:function(){return u},yW:function(){return i}});var r=n(83372),o=[{text:"Quotation Requested",value:"supplierQuoteRequested",context:"info"},{text:"Quotation Completed",value:"supplierQuoteComplete",context:"help"},{text:"Draft Quotation",value:"supplierQuoteDraft",context:"info"},{text:"Awaiting threshold approval",value:"waitingThresholdApproval",context:"info"},{text:"Quotation Refused",value:"supplierQuoteRefused",context:"danger"},{text:"Quotation Sent",value:"supplierQuoteSent",context:"success"},{text:"Quotation Accepted",value:"quotationAccepted",context:"success"},{text:"Quotation Rejected",value:"quotationRejected",context:"danger"},{text:"Quotation Updated",value:"supplierQuoteUpdated",context:"success"}],a=[{text:"New Quote",value:"quoteNew",customerText:"Quote issued",supplierText:null},{text:"Sent to Supplier(s)",value:"quoteOffered",customerText:"Quote issued",supplierText:"Quote offered"},{text:"Received from Supplier(s)",value:"quoteReceived",customerText:"Final review",supplierText:"Quote submitted"},{text:"Sent to Customer",value:"quoteSent",customerText:"Awaiting approval",supplierText:"Awaiting approval"},{text:"Quote Accepted",value:"quoteAccepted",customerText:"Quote accepted",supplierText:"Quote accepted"},{text:"Quote Rejected",value:"quoteRejected",customerText:"Quote rejected",supplierText:"Quote rejected"},{text:"Canceled",value:"quoteCancelled",customerText:"Cancelled",supplierText:null},{text:"Closed",value:"quoteClosed",customerText:"Closed",supplierText:"Closed"}],i=[{text:"Pending",value:"pending",colour:r.Q.COLOUR.info},{text:"Raised",value:"raised",colour:r.Q.COLOUR.info},{text:"Offered",value:"offered",colour:r.Q.COLOUR.warning},{text:"Accepted",value:"accepted",colour:r.Q.COLOUR.success},{text:"In Progress",value:"inProgress",colour:r.Q.COLOUR.primary},{text:"Completed",value:"completed",colour:r.Q.COLOUR.muiLightGray},{text:"Awaiting threshold approval",value:"waitingThresholdApproval",colour:r.Q.COLOUR.info},{text:"Report Sent",value:"reportSent",colour:r.Q.COLOUR.muiGray},{text:"Invoice Sent",value:"invoiceSent",colour:r.Q.COLOUR.secondary},{text:"Customer Paid",value:"customerPaid",colour:r.Q.COLOUR.help},{text:"Supplier Paid",value:"supplierPaid",colour:r.Q.COLOUR.help},{text:"Canceled",value:"canceled",colour:r.Q.COLOUR.black},{text:"Closed",value:"closed",colour:r.Q.COLOUR.black},{text:"On Hold",value:"onHold",colour:r.Q.COLOUR.black},{text:"Continued",value:"continued",colour:r.Q.COLOUR.primary},{text:"Paused",value:"paused",colour:r.Q.COLOUR.black}],l=[{label:"Pending",value:"pending"},{label:"Raised",value:"raised"},{label:"Offered",value:"offered"},{label:"Accepted",value:"accepted"},{label:"In Progress",value:"inProgress"},{label:"Completed",value:"completed"},{label:"Awaiting threshold approval",value:"waitingThresholdApproval"},{label:"Report Sent",value:"reportSent"},{label:"Invoice Sent",value:"invoiceSent"},{label:"Customer Paid",value:"customerPaid"},{label:"Supplier Paid",value:"supplierPaid"},{label:"Quote",value:"quote"},{label:"Site Visit",value:"siteVisit"},{label:"Canceled",value:"canceled"},{label:"Closed",value:"closed"},{label:"On Hold",value:"onHold"},{label:"Continued",value:"continued"},{label:"Paused",value:"paused"}],s=[{text:"Uplift Draft",value:"upliftDraft",context:"info"},{text:"Supplier Uplift Requested",value:"supplierUpliftRequested",context:"secondary"},{text:"Uplift Requested Send to Customer",value:"upliftRequestSendCustomer",context:"secondary"},{text:"Uplift Approved",value:"customerUpliftApproved",context:"success"},{text:"Uplift Rejected",value:"customerUpliftRejected",context:"danger"}],u=[{text:"Offered",value:"offered",context:"info"},{text:"Raised",value:"raised",context:"info"},{text:"Pending",value:"pending",context:"info"},{text:"Accepted",value:"accepted",context:"info"},{text:"Uplift Requested by Supplier",value:"supplierUpliftRequested",context:"info"},{text:"Uplift Draft",value:"upliftDraft",context:"info"},{text:"Uplift Requested Send Customer",value:"upliftRequestSendCustomer",context:"info"},{text:"Uplift Requested Approved",value:"customerUpliftApproved",context:"success"},{text:"In Dispute",value:"inDispute",context:"info"},{text:"Resumed",value:"resumed",context:"Danger"},{text:"Quote Sent",value:"quoteSent",context:"info"},{text:"Quote Offered",value:"quoteOffered",context:"info"},{text:"Report Sent Supplier",value:"reportSentSupplier",context:"info"},{text:"Dispute Resolved",value:"disputeResolved",context:"info"},{text:"Validated",value:"validated",context:"success"},{text:"Un Validated",value:"unvalidated",context:"success"},{text:"Paused",value:"paused",context:"info"},{text:"TimingChanged",value:"timingChanged",context:"info"},{text:"Customer Paid",value:"customerPaid",context:"info"},{text:"In Progress",value:"inProgress",context:"info"},{text:"PPM Invoice Created",value:"ppmInvoiceCreated",context:"success"},{text:"Late Arrival",value:"lateArrival",context:"info"},{text:"Pricing Changed",value:"pricingChanged",context:"info"},{text:"Report Sent",value:"reportSent",context:"info"},{text:"Invoice Sent Supplier",value:"invoiceSentSupplier",context:"info"},{text:"Invoice Sent",value:"invoiceSent",context:"info"},{text:"Invoice Sent Customer",value:"invoiceSentCustomer",context:"info"},{text:"Quote Accepted",value:"quoteAccepted",context:"info"},{text:"On Hold",value:"onHold",context:"info"},{text:"Continued",value:"continued",context:"info"},{text:"Quote Received",value:"quoteReceived",context:"info"},{text:"Quote New",value:"quoteNew",context:"info"},{text:"Closed",value:"closed",context:"danger"},{text:"Re posted",value:"reposted",context:"info"},{text:"Supplier Paid",value:"supplierPaid",context:"info"},{text:"Rejected",value:"rejected",context:"info"},{text:"Completed",value:"completed",context:"info"},{text:"Canceled",value:"canceled",context:"danger"}],d=[{value:"complete",text:"Complete"},{value:"returnVisitByAnother",text:"Return Visit By Another"},{value:"returnVisit",text:"Return Visit"},{value:"completeCertificate",text:"Complete Certificate"},{value:"couldNotDo",text:"Could Not Do"}]},61472:function(e,t,n){"use strict";n.d(t,{FX:function(){return f},cj:function(){return c},jb:function(){return v}});var r=n(85893),o=n(83372),a=n(96540),i=n(90244),l=n(98441),s=n(422),u=n(38780),d=n(10105),c={DONE:"done",NEW:"new",IN_PROGRESS:"inprogress",TO_DO:"todo",BLOCKED:"blocked"},p={URGENT:"urgent",HIGH:"high",NORMAL:"normal",LOW:"low"},v=[{value:c.NEW,label:"New",icon:(0,r.jsx)(a.Z,{color:"white"}),color:o.Q.COLOUR.white,bgcolor:"#83BBDC"},{value:c.TO_DO,label:"To do",icon:(0,r.jsx)(i.Z,{color:"white"}),color:o.Q.COLOUR.white,bgcolor:o.Q.COLOUR.secondary},{value:c.IN_PROGRESS,label:"In progress",icon:(0,r.jsx)(l.Z,{color:"white"}),color:o.Q.COLOUR.white,bgcolor:o.Q.COLOUR.info},{value:c.DONE,label:"Done",icon:(0,r.jsx)(s.Z,{color:"white"}),color:o.Q.COLOUR.white,bgcolor:o.Q.COLOUR.success},{value:c.BLOCKED,label:"Blocked",icon:(0,r.jsx)(u.Z,{color:"white"}),color:o.Q.COLOUR.white,bgcolor:o.Q.COLOUR.danger}],f=[{value:p.URGENT,label:"Urgent",icon:(0,r.jsx)(d.Z,{color:"danger"})},{value:p.HIGH,label:"High",icon:(0,r.jsx)(d.Z,{color:"info"})},{value:p.NORMAL,label:"Normal",icon:(0,r.jsx)(d.Z,{color:"secondary"})},{value:p.LOW,label:"Low",icon:(0,r.jsx)(d.Z,{color:"muiGray"})}]},3001:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return tg}});var r=n(85893),o=n(53767),a=n(26042),i=n(828),l=n(45697),s=n.n(l),u=n(12632),d=n(67294),c=n(45451),p=n(11057),v=n(90629),f=n(51233),m=n(15861),x=n(21830),g=n(6812),h=n(50319),b=n(34187),y=n(67797),j=n(81261),T=n(79928),Z=n(47568),C=n(69396),w=n(97582),k=n(67720),S=n(86886),q=n(50135),I=n(90948),P=n(69661),D=n(93946),R=n(84808),O=n(98456),W=n(5616),_=n(91830),E=n(42283),L=n(40075),Q=n(6103),A=n(30381),U=n.n(A),F=n(61472),N=n(69368),V=n(69297),M=n(33754),$=n(74944),G=n(62547),H=n(42074),z=n(31312),B=[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],J=[{label:"Job status changes",value:"jobStatusChanges"},{label:"Quote status changes",value:"quoteStatusChanges"},{label:"Date is",value:"dateIs"}],X={jobStatusChanges:z.yW,quoteStatusChanges:z.iz},Y=[{label:"Reactive",value:"reactive"},{label:"PPM",value:"ppm"}],K=[{label:"Account manager is",value:"accountManager"},{label:"Priority is",value:"priority"},{label:"Customer is",value:"customer"},{label:"Supplier is",value:"supplier"},{label:"Location is",value:"location"},{label:"Short job description is",value:"shortJobDescription"},{label:"Service is",value:"service"},{label:"Job date is",value:"jobDateIs"},{label:"Job type is",value:"jobTypeIs"},{label:"Job status is",value:"jobStatusIs"}],ee=[{label:"Every",value:"every"},{label:"First",value:"first"},{label:"Second",value:"second"},{label:"Third",value:"third"},{label:"Fourth",value:"fourth"},{label:"Last",value:"last"}],et=[{label:"Day",value:"day"},{label:"Monday",value:"monday"},{label:"Tuesday",value:"tuesday"},{label:"Wednesday",value:"wednesday"},{label:"Thursday",value:"thursday"},{label:"Friday",value:"friday"},{label:"Saturday",value:"saturday"},{label:"Sunday",value:"sunday"},{label:"Weekday",value:"weekday"},{label:"Weekend day",value:"weekend"}],en=[{label:"Week",value:"week"},{label:"Month",value:"month"},{label:"Year",value:"year"}],er=[{label:"today",value:"today"},{label:"tomorrow",value:"tomorrow"},{label:"yesterday",value:"yesterday"},{label:"last 7 days",value:"lastSevenDays"},{label:"last month",value:"lastMonth"},{label:"last 30 days",value:"lastThirtyDays"},{label:"last 90 days",value:"lastNinetyDays"},{label:"last year",value:"lastYear"},{label:"in next 7 days",value:"inNextSevenDays"},{label:"in this month",value:"inThisMonth"},{label:"in next month",value:"inNextMonth"},{label:"in next 30 days",value:"inNextThirtyDays"},{label:"in next 90 days",value:"inNextNinetyDays"},{label:"in next year",value:"inNextYear"}],eo=[{label:"Create a task",value:"createTask"},{label:"Send an email",value:"sendEmail"}],ea=[{label:"Admin",value:"admin"},{label:"Customer",value:"customer"},{label:"Supplier",value:"supplier"},{label:"Tenant",value:"tenant"},{label:"Specific email address",value:"customEmail"}],ei=[{value:"jobNumber",label:"Job ID"},{value:"jobType",label:"Job type"},{value:"invoiceNumber",label:"Invoice number"},{value:"invoiceType",label:"Invoice type"},{value:"invoiceStatus",label:"Invoice status"},{value:"invoiceAmount",label:"Invoice amount"},{value:"outstandingDays",label:"Outstanding days"},{value:"customerName",label:"Customer"},{value:"customerManagerName",label:"Account Manager"},{value:"supplierName",label:"Supplier"},{value:"locationName",label:"Location"},{value:"addressMainName",label:"Address"},{value:"addressMainPostCode",label:"Post code"},{value:"addressInvoiceName",label:"Invoice address"},{value:"sublocationName",label:"Sublocation"},{value:"jobPriority",label:"Priority"},{value:"jobStatus",label:"Status"},{value:"jobTotal",label:"Job total"},{value:"dueFromCustomer",label:"Due from customer"},{value:"outstandingAmount",label:"Outstanding amount"},{value:"jobNetRevenue",label:"Net revenue"},{value:"supplierAmount",label:"Supplier total"},{value:"jobExpensesCustomer",label:"Expenses (Customer)"},{value:"jobExpensesSupplier",label:"Expenses (Supplier)"},{value:"jobServiceName",label:"Service line"},{value:"jobDate",label:"Job date"},{value:"jobReference",label:"Customer reference"},{value:"jobDescription",label:"Job description"},{value:"jobShortDescription",label:"Issue reported"},{value:"jobSource",label:"Source"},{value:"jobCostCategory",label:"Cost category"},{value:"adminUser",label:"Assigned to (Admin)"},{value:"customerUser",label:"Assigned to (Customer)"},{value:"supplierUser",label:"Assigned to (Supplier)"},{value:"jobCreatedAtDate",label:"Job created"},{value:"jobCreatedBy",label:"Created by"},{value:"jobPaidDate",label:"Paid date"},{value:"jobCompletedDate",label:"Completed date"},{value:"jobInvoicedDate",label:"Invoice date"},{value:"jobClosedDate",label:"Closed date"}],el=[{value:"daysAfterTriggerDay",label:"Days after trigger day"},{value:"onTriggerDate",label:"On trigger date"},{value:"chooseDate",label:"Choose a date"}],es=[{value:"customer",label:"Customer"},{value:"supplier",label:"Supplier"},{value:"location",label:"Location"},{value:"job",label:"Quote or work order id"},{value:"externalURL",label:"External URL"}],eu=n(18531),ed=n(57493),ec=function(e){var t,n,o,i=e.workflowId,l=e.register,s=e.watch,u=e.setValue,c=e.control,p=e.errors,v=(0,d.useState)(""),x=v[0],h=v[1],b=(0,$.x)().user,y=s("taskTemplate.workflowTags"),j=s("taskTemplate.relatedLinks"),T=s("taskTemplate.dueDateType"),Z=s("taskTemplate.relatedLinksType"),w=(0,g.a)(ed.A5,{variables:{accountId:b.adminId,q:""!==x?"%".concat(x,"%"):null}}),k=w.loading,S=w.data,I=(void 0===S?{items:[]}:S).items;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(f.Z,{direction:"column",spacing:3,pb:3,children:[(0,r.jsx)(E.Qr,{control:c,name:"taskTemplate.title",render:function(e){var t,n,o,a=e.value,i=e.onChange;return(0,r.jsx)(q.Z,{variant:"standard",color:"secondary",label:"Title",value:a,onChange:i,error:null===(t=p.taskTemplate)||void 0===t?void 0:t.title,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(o=n.title)||void 0===o?void 0:o.message,sx:{mt:"0 !important"}})}}),(0,r.jsx)(E.Qr,{control:c,name:"taskTemplate.content",render:function(e){var t,n,o,a=e.value,i=e.onChange;return(0,r.jsx)(q.Z,{multiline:!0,minRows:8,variant:"filled",color:"secondary",label:"Content",value:a,onChange:i,error:null===(t=p.taskTemplate)||void 0===t?void 0:t.content,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(o=n.content)||void 0===o?void 0:o.message})}}),(0,r.jsx)(E.Qr,{control:c,name:"taskTemplate.priority",render:function(e){var t,n,o,a=e.value,i=e.onChange;return(0,r.jsx)(V.E,{label:"Priority:",labelLeft:!0,stackProps:{direction:"row",flexWrap:"wrap"},options:F.FX,value:a,onChange:i,error:null===(t=p.taskTemplate)||void 0===t?void 0:t.priority,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(o=n.priority)||void 0===o?void 0:o.message})}}),(0,r.jsx)(E.Qr,{control:c,name:"taskTemplate.dueDateType",defaultValue:null,render:function(e){var t,n,o,a=e.value,i=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=p.taskTemplate)||void 0===t?void 0:t.dueDateType,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(o=n.dueDateType)||void 0===o?void 0:o.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Due date",value:a,onChange:i,options:el||[]})}}),"daysAfterTriggerDay"===T&&(0,r.jsx)(E.Qr,{control:c,name:"taskTemplate.dueDateDaysAfterTriggerDay",render:function(e){var t,n,o,a=e.value,i=e.onChange;return(0,r.jsx)(q.Z,{type:"number",placeholder:"Enter number of days",color:"secondary",variant:"standard",value:a,onChange:i,error:null===(t=p.taskTemplate)||void 0===t?void 0:t.dueDateDaysAfterTriggerDay,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(o=n.dueDateDaysAfterTriggerDay)||void 0===o?void 0:o.message})}}),"chooseDate"===T&&(0,r.jsx)(E.Qr,{control:c,name:"taskTemplate.dueDateChooseDate",defaultValue:null,render:function(e){var t=e.value,n=e.onChange;return(0,r.jsx)(M.M,{label:"Due date",inputFormat:"Do MMM YYYY",minDate:U()(),value:t,onChange:n,renderInput:function(e){var t,n,o;return(0,r.jsx)(q.Z,(0,C.Z)((0,a.Z)({},e),{color:"secondary",variant:"standard",error:null===(t=p.taskTemplate)||void 0===t?void 0:t.dueDateChooseDate,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(o=n.dueDateChooseDate)||void 0===o?void 0:o.message}))}})}}),(0,r.jsx)(E.Qr,{name:"taskTemplate.assignedUser",control:c,render:function(e){var t,n,o,a=e.value,i=e.onChange;return(0,r.jsx)(eu.q,{value:a,onChange:function(e,t){return i(t)},loading:k,options:I,setSearch:h,isOptionEqualToValue:function(e,t){return e.value===t.value},textFieldProps:{color:"secondary",variant:"standard",label:"Assigned to",error:null===(t=p.taskTemplate)||void 0===t?void 0:t.assignedUser,helperText:null===(n=p.taskTemplate)||void 0===n?void 0:null===(o=n.assignedUser)||void 0===o?void 0:o.message}})}}),(0,r.jsx)(f.Z,{direction:"row",width:"100%",alignItems:"center",children:(0,r.jsx)(H.n,{entityId:i,entity:"Workflow",name:"taskTemplate.workflowTags",values:y,setValue:u})}),(0,r.jsx)("input",(0,C.Z)((0,a.Z)({},l("taskTemplate.workflowTags")),{type:"hidden"})),(0,r.jsx)(E.Qr,{name:"taskTemplate.relatedLinksType",control:c,render:function(e){var t=e.value,n=e.onChange;return(0,r.jsx)(eu.q,{multiple:!0,value:t||[],onChange:function(e,t){return n(t)},options:es,color:"secondary",textFieldProps:{color:"secondary",variant:"standard",label:"Select link type"},sx:{width:"100%"},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var o=n.selected;return(0,d.createElement)("li",(0,C.Z)((0,a.Z)({},e),{key:t.value,children:[(0,r.jsx)(N.Z,{color:"secondary",style:{height:10,marginRight:8},checked:o}),t.label]}))}})}}),(null==Z?void 0:Z.some(function(e){return"externalURL"===e.value}))&&(0,r.jsxs)(W.Z,{children:[(0,r.jsx)(G.V,{values:j,setValue:u,name:"taskTemplate.relatedLinks"}),(0,r.jsx)("input",(0,C.Z)((0,a.Z)({},l("taskTemplate.relatedLinks")),{type:"hidden"})),(null===(t=p.taskTemplate)||void 0===t?void 0:t.relatedLinks)&&(null==j?void 0:j.length)===0&&(0,r.jsx)(m.Z,{variant:"subtitle2",color:"warning.main",children:null===(n=p.taskTemplate)||void 0===n?void 0:null===(o=n.relatedLinks)||void 0===o?void 0:o.message})]})]})})};ec.defaultProps={register:function(){return{}},watch:function(){},setValue:function(){},control:{},errors:{}},ec.propTypes={register:s().func,watch:s().func,setValue:s().func,control:s().object,errors:s().object};var ep=n(79665),ev=n(16310),ef=ev.Ry({title:ev.Z_().required("Title is required field"),status:ev.Z_().oneOf(B.map(function(e){return e.value})).required("Status is required field"),action:ev.Z_().when("trigger.type",{is:"dateIs",then:function(){return ev.Z_().oneOf(["sendEmail"],"Invalid action").required("Action is required")},otherwise:function(){return ev.Z_().oneOf(eo.map(function(e){return e.value}),"Invalid action").required("Action is required")}}),trigger:ev.Ry({type:ev.Z_().oneOf(J.map(function(e){return e.value})).required("Trigger is required field"),from:ev.Z_().when(["type"],function(e,t){var n;return"jobStatusChanges"===e||"quoteStatusChanges"===e?t.oneOf(null===(n=X[e])||void 0===n?void 0:n.map(function(e){return e.value})).required("From status is required field"):t}),to:ev.Z_().when(["type"],function(e,t){var n;return"jobStatusChanges"===e||"quoteStatusChanges"===e?t.oneOf(null===(n=X[e])||void 0===n?void 0:n.map(function(e){return e.value})).notOneOf([ev.iH("from")],'To status must be different from "From" status').required("To status is required field"):t}),frequency:ev.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(ee.map(function(e){return e.value})).required("Frequency is required field"):t}),daysIn:ev.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(et.map(function(e){return e.value})).required("Day is required field"):t}),inThePeriod:ev.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(en.map(function(e){return e.value})).required("Period is required field"):t}),jobType:ev.IX().when(["type"],function(e,t){return"jobStatusChanges"===e?t.of(ev.Z_().oneOf(Y.map(function(e){return e.value})).required("Job type is required field")).required("Job type is required field"):t})}),condition:ev.IX().of(ev.Ry({type:ev.Ry({value:ev.Z_().required("Condition type is required field"),label:ev.Z_().required("Condition type is required field")}).required("Condition type is required field").typeError("Condition type is required field"),value:ev.Ry({value:ev.Z_().required("Condition value is required field"),label:ev.Z_().required("Condition value is required field")}).required("Condition value is required field").typeError("Condition value is required field")})),taskTemplate:ev.nK().when("action",{is:"createTask",then:function(){return ev.Ry({title:ev.Z_().required("Title is required"),content:ev.Z_().required("Content is required"),priority:ev.Z_().oneOf(F.FX.map(function(e){return e.value})).required("Priority is required"),dueDateType:ev.Z_().oneOf(el.map(function(e){return e.value})).required("Due date type is required").typeError("Due date type is required"),dueDateDaysAfterTriggerDay:ev.nK().when("dueDateType",{is:"daysAfterTriggerDay",then:function(){return ev.Rx().integer("Days after trigger day must be an integer").min(0,"Days after trigger day must be greater than or equal to 0").required("Days after trigger day is required")}}),dueDateChooseDate:ev.hT().when("dueDateType",{is:"chooseDate",then:function(){return ev.hT().required("Due date is required")}}),assignedUser:ev.Ry().shape({value:ev.Z_().required(),label:ev.Z_().required()}).required("Assigned user is required").typeError("Assigned user is required"),workflowTags:ev.IX().of(ev.Ry().shape({id:ev.Rx().integer().nullable(),tag:ev.Ry().shape({id:ev.Rx().integer().required(),name:ev.Z_().required()}).required()})),relatedLinksType:ev.IX().of(ev.Ry().shape({value:ev.Z_().oneOf(es.map(function(e){return e.value})).required(),label:ev.Z_().required()})),relatedLinks:ev.nK().when("relatedLinksType",{is:function(e){return(null==e?void 0:e.length)>0&&e.some(function(e){return"externalURL"===e.value})},then:function(){return ev.IX().of(ev.Ry().shape({name:ev.Z_().required("Title is required"),url:ev.Z_().url("Invalid URL").required("URL is required")})).min(1,"Related links is required").required("Related links is required")}})})}}),emailTemplate:ev.nK().when("action",{is:"sendEmail",then:function(){return ev.Ry({sendToCategory:ev.Z_().oneOf(ea.map(function(e){return e.value})).required("Send to category is required"),sendTo:ev.nK().when("sendToCategory",{is:"customEmail",then:function(){return ev.Z_().email("Invalid email address").required("Email is required")},otherwise:function(){return ev.IX().of(ev.Ry({value:ev.Rx().integer().required("Value is required field"),label:ev.Z_().required("Label is required field")})).required("Send to is required")}}),subject:ev.Z_().required("Subject is required"),content:ev.Z_().required("Content is required"),buttonTitle:ev.Z_().required("Button title is required"),buttonLink:ev.Z_().url("Invalid URL").required("Button link is required"),columns:ev.IX().of(ev.Ry({value:ev.Z_().required("Value is required field"),label:ev.Z_().required("Label is required field")})),sendToTestEmail:ev.Z_().when("$sendTestEmailIsRequired",{is:!0,then:function(){return ev.Z_().email("Invalid email address").required("Email is required")}})})}})}),em=n(20320),ex=function(e){var t=e.control,n=e.errors,o=e.watch,i=e.setValue,l=e.reset,s=["jobStatusChanges","quoteStatusChanges"],u=o("action"),c=o("trigger.type"),p=o("trigger.from"),v=o("trigger.to"),x=(0,d.useMemo)(function(){return J.filter(function(e){var t=e.value;return"sendEmail"===u?"dateIs"===t:void 0===u||"dateIs"!==t})},[u]),g=(0,d.useMemo)(function(){var e,t;return null===(t=null===(e=X[c])||void 0===e?void 0:e.filter(function(e){return e.value!==v}))||void 0===t?void 0:t.map(function(e){var t;return{label:e.text,value:e.value}})},[c,v]),h=(0,d.useMemo)(function(){var e,t;return null===(t=null===(e=X[c])||void 0===e?void 0:e.filter(function(e){return e.value!==p}))||void 0===t?void 0:t.map(function(e){var t;return{label:e.text,value:e.value}})},[c,p]);return(0,r.jsx)(eg,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,r.jsxs)(f.Z,{direction:"row",alignItems:"center",width:"100%",children:[(0,r.jsxs)(f.Z,{spacing:1,width:"100%",children:[(0,r.jsx)(E.Qr,{name:"trigger.type",control:t,render:function(e){var t,o,a,l=e.value,s=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.type,helperText:null===(o=n.trigger)||void 0===o?void 0:null===(a=o.type)||void 0===a?void 0:a.message},selectProps:{fullWidth:!0},label:"Select trigger",value:l,onChange:function(e){i("trigger.from",""),i("trigger.to",""),s(e)},options:x||[]})}}),!!s.includes(c)&&(0,r.jsxs)(f.Z,{direction:"row",alignItems:"flex-end",width:"100%",children:[(0,r.jsx)(m.Z,{sx:{fontWeight:700,mb:"5px",mr:"24px"},children:"From"}),(0,r.jsx)(E.Qr,{name:"trigger.from",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.from,helperText:null===(o=n.trigger)||void 0===o?void 0:null===(a=o.from)||void 0===a?void 0:a.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select status",value:i,onChange:l,options:g||[]})}})]}),!!s.includes(c)&&(0,r.jsxs)(f.Z,{direction:"row",alignItems:"flex-end",width:"100%",children:[(0,r.jsx)(m.Z,{sx:{fontWeight:700,mb:"5px",mr:"40px"},children:"To"}),(0,r.jsx)(E.Qr,{name:"trigger.to",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.to,helperText:null===(o=n.trigger)||void 0===o?void 0:null===(a=o.to)||void 0===a?void 0:a.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select status",value:i,onChange:l,options:h||[]})}})]}),"dateIs"===c&&(0,r.jsxs)(f.Z,{direction:"row",alignItems:"baseline",width:"100%",spacing:2,children:[(0,r.jsx)(E.Qr,{name:"trigger.frequency",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.frequency,helperText:null===(o=n.trigger)||void 0===o?void 0:null===(a=o.frequency)||void 0===a?void 0:a.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Repeat",value:i,onChange:l,options:ee||[]})}}),(0,r.jsx)(E.Qr,{name:"trigger.daysIn",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.daysIn,helperText:null===(o=n.trigger)||void 0===o?void 0:null===(a=o.daysIn)||void 0===a?void 0:a.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Day",value:i,onChange:l,options:et||[]})}}),(0,r.jsx)(m.Z,{sx:{textWrap:"nowrap"},children:"in the"}),(0,r.jsx)(E.Qr,{name:"trigger.inThePeriod",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.inThePeriod,helperText:null===(o=n.trigger)||void 0===o?void 0:null===(a=o.inThePeriod)||void 0===a?void 0:a.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Period",value:i,onChange:l,options:en||[]})}})]}),"jobStatusChanges"===c&&(0,r.jsx)(E.Qr,{name:"trigger.jobType",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.jobType,helperText:null===(o=n.trigger)||void 0===o?void 0:null===(a=o.jobType)||void 0===a?void 0:a.message,fullWidth:!0},selectComponent:"checkbox",selectProps:{fullWidth:!0,multiple:!0},label:"Select job type",value:i||[],onChange:function(e){var t=e.target.value;l("string"==typeof t?t.split(","):t)},options:Y||[]})}})]}),(0,r.jsx)(f.Z,{children:(0,r.jsx)(D.Z,{sx:{mb:"-8px"},onClick:function(){l((0,C.Z)((0,a.Z)({},o()),{trigger:{type:"",from:"",to:"",frequency:"",daysIn:"",inThePeriod:"",jobType:[]},condition:[]}))},children:(0,r.jsx)(em.Z,{sx:{color:"danger.main"}})})})]})})};ex.propTypes={control:s().object.isRequired,errors:s().object.isRequired,watch:s().func.isRequired,setValue:s().func.isRequired,reset:s().func.isRequired},ex.defaultProps={errors:{}};var eg=(0,I.ZP)(v.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eh={"jobStatusChanges-reactive":"reactive",quoteStatusChanges:"quote"},eb={"jobStatusChanges-reactive":["jobTypeIs","jobStatusIs"],"jobStatusChanges-ppm":["priority","jobTypeIs","jobStatusIs"],quoteStatusChanges:["jobTypeIs","jobStatusIs"],dateIs:[]},ey=function(e){var t=e.index,n=e.field,o=e.control,a=e.errors,i=e.watch,l=e.remove,s=(0,$.x)().user,u=(0,d.useState)(""),c=u[0],p=u[1],v=i("trigger.type"),m=i("trigger.jobType"),x=i("condition[".concat(t,"].type")),h=(0,d.useMemo)(function(){return K.filter(function(e){var t=e.value,n=eb["".concat(v).concat(m?"-"+m:"")];return!(null==n?void 0:n.includes(t))})},[v,m]),b=(0,d.useMemo)(function(){return eh["".concat(v).concat(m?"-"+m:"")]},[v,m]),y=(0,g.a)(ed.yR,{skip:(null==x?void 0:x.value)!=="accountManager",variables:{accountId:s.adminId,limit:50,offset:0}}),j=y.loading,T=y.data,Z=(void 0===T?{items:[]}:T).items,C=(0,g.a)(ed.SW,{skip:(null==x?void 0:x.value)!=="customer",variables:{q:""!==c?"%".concat(c,"%"):null,limit:50,offset:0}}),w=C.loading,k=C.data,S=(void 0===k?{items:[]}:k).items,q=(0,g.a)(ed._d,{skip:(null==x?void 0:x.value)!=="location",variables:{where:{name:{_ilike:""!==c?"%".concat(c,"%"):null},status:{_eq:"active"}},limit:50,offset:0}}),I=q.loading,P=q.data,R=(void 0===P?{items:[]}:P).items,O=(0,g.a)(ed.by,{skip:(null==x?void 0:x.value)!=="supplier",variables:{where:{name:{_ilike:""!==c?"%".concat(c,"%"):null},type:{_eq:"supplier"}},limit:50,offset:0}}),W=O.loading,_=O.data,L=(void 0===_?{items:[]}:_).items,Q=(0,g.a)(ed.T_,{skip:(null==x?void 0:x.value)!=="priority"&&!b,variables:{where:{name:{_ilike:""!==c?"%".concat(c,"%"):null},subtype:{_eq:b}},limit:50,offset:0}}),A=Q.loading,U=Q.data,F=(void 0===U?{items:[]}:U).items,N=(0,g.a)(ed._f,{skip:(null==x?void 0:x.value)!=="shortJobDescription",variables:{where:{name:{_ilike:""!==c?"%".concat(c,"%"):null},status:{_eq:"active"},type:{_eq:"jobTags"}},orderBy:{name:"asc"},limit:50,offset:0}}),V=N.loading,M=N.data,G=(void 0===M?{items:[]}:M).items,H=(0,g.a)(ed.kx,{skip:(null==x?void 0:x.value)!=="service",variables:{q:""!==c?"%".concat(c,"%"):null,limit:50,offset:0}}),z=H.loading,B=H.data,J=(void 0===B?{items:[]}:B).items,ee=(0,d.useCallback)(function(){if(!(null==x?void 0:x.value))return[];switch(x.value){case"priority":return F;case"accountManager":return Z;case"customer":return S;case"supplier":return L;case"location":return R;case"shortJobDescription":return G;case"service":return J;case"jobDateIs":return er;case"jobTypeIs":return Y;case"jobStatusIs":return X.jobStatusChanges.map(function(e){var t;return{label:e.text,value:e.value}})}},[null==x?void 0:x.value,F,Z,S,L,R,G,J]);return(0,r.jsx)(ej,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,r.jsxs)(f.Z,{width:"100%",spacing:1,children:[(0,r.jsxs)(f.Z,{width:"100%",direction:"row",alignItems:"center",children:[(0,r.jsx)(E.Qr,{defaultValue:null==n?void 0:n.type,name:"condition[".concat(t,"].type"),control:o,render:function(e){var n,o,i,l,s,u,d,c,v,f=e.value,m=e.onChange;return(0,r.jsx)(eu.q,{fullWidth:!0,color:"secondary",value:f,onChange:function(e,t){p(""),m(t)},isOptionEqualToValue:function(e,t){return e.value===t.value},options:h,textFieldProps:{label:"Condition",variant:"standard",color:"secondary",error:null===(n=a.condition)||void 0===n?void 0:null===(o=n[t])||void 0===o?void 0:o.type,helperText:(null===(i=a.condition)||void 0===i?void 0:null===(l=i[t])||void 0===l?void 0:null===(s=l.type)||void 0===s?void 0:s.message)||(null===(u=a.condition)||void 0===u?void 0:null===(d=u[t])||void 0===d?void 0:null===(c=d.type)||void 0===c?void 0:null===(v=c.value)||void 0===v?void 0:v.message)}})}}),(0,r.jsx)(D.Z,{sx:{mb:"-8px"},onClick:function(){return l(t)},children:(0,r.jsx)(em.Z,{sx:{color:"danger.main"}})})]}),!!x&&(0,r.jsx)(E.Qr,{defaultValue:null==n?void 0:n.value,name:"condition[".concat(t,"].value"),control:o,render:function(e){var n,o,i,l,s,u,d,c,v,f=e.value,m=e.onChange;return(0,r.jsx)(eu.q,{color:"secondary",filterSelectedOptions:!0,loading:j||w||I||W||A||V||z,value:f,onChange:function(e,t){m(t)},isOptionEqualToValue:function(e,t){return e.value===t.value},options:ee(),setSearch:p,textFieldProps:{label:"Select ".concat(null==x?void 0:x.label),variant:"standard",color:"secondary",error:null===(n=a.condition)||void 0===n?void 0:null===(o=n[t])||void 0===o?void 0:o.value,helperText:(null===(i=a.condition)||void 0===i?void 0:null===(l=i[t])||void 0===l?void 0:null===(s=l.value)||void 0===s?void 0:s.message)||(null===(u=a.condition)||void 0===u?void 0:null===(d=u[t])||void 0===d?void 0:null===(c=d.value)||void 0===c?void 0:null===(v=c.value)||void 0===v?void 0:v.message)}})}})]})})};ey.propTypes={index:s().number,field:s().object,control:s().object,errors:s().object,watch:s().func,remove:s().func};var ej=(0,I.ZP)(v.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eT=n(7297),eZ=n(75063);function eC(){var e=(0,eT.Z)(["\n  mutation CreateTaskWorkflow($data: jsonb!) {\n    createTaskWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return eC=function(){return e},e}function ew(){var e=(0,eT.Z)(["\n  mutation CreateEmailWorkflow($data: jsonb!) {\n    createEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return ew=function(){return e},e}function ek(){var e=(0,eT.Z)(["\n  mutation UpdateTaskWorkflow($data: jsonb!) {\n    updateTaskWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return ek=function(){return e},e}function eS(){var e=(0,eT.Z)(["\n  mutation UpdateEmailWorkflow($data: jsonb!) {\n    updateEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return eS=function(){return e},e}function eq(){var e=(0,eT.Z)(["\n  mutation SnedTestEmailWorkflow($data: jsonb!) {\n    sendTestEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]);return eq=function(){return e},e}var eI=(0,eZ.Ps)(eC()),eP=(0,eZ.Ps)(ew()),eD=(0,eZ.Ps)(ek()),eR=(0,eZ.Ps)(eS()),eO=(0,eZ.Ps)(eq()),eW=n(19512);function e_(){var e=(0,eT.Z)(["\n  fragment WorkflowFields on Workflow {\n    id\n    status\n    title\n    action\n    fired\n    taskTemplate\n    emailTemplate\n    meta\n    createdAt\n    updatedAt\n    userId\n    adminId\n  }\n"]);return e_=function(){return e},e}function eE(){var e=(0,eT.Z)(["\n  fragment WorkflowConditionFields on WorkflowCondition {\n    id\n    isTrigger\n    trigger\n    condition\n    meta\n    createdAt\n    updatedAt\n    workflowId\n  }\n"]);return eE=function(){return e},e}function eL(){var e=(0,eT.Z)(['\n  query GetWorkflow($id: Int!) {\n    workflow: Workflow_by_pk(id: $id) {\n      ...WorkflowFields\n      conditions: WorkflowConditions {\n        ...WorkflowConditionFields\n      }\n      tags: Taxonomy(\n        where: {\n          entity: { _eq: "Workflow" }\n          Taxonomy: { status: { _eq: "active" }, type: { _eq: "taskTags" } }\n        }\n      ) {\n        id\n        tag: Taxonomy {\n          id\n          name\n          meta\n        }\n      }\n      user: User {\n        id\n        fullName\n      }\n    }\n  }\n  ',"\n  ","\n"]);return eL=function(){return e},e}function eQ(){var e=(0,eT.Z)(["\n  query GetWorkflows(\n    $q: String\n    $status: workflow_status\n    $tags: [Int]\n    $limit: Int = 50\n    $offset: Int = 0\n    $orderBy: [Workflow_order_by!]\n  ) {\n    workflows: Workflow(\n      where: { title: { _ilike: $q }, status: { _eq: $status }, ",' }\n      limit: $limit\n      offset: $offset\n      order_by: $orderBy\n    ) {\n      ...WorkflowFields\n      conditions: WorkflowConditions {\n        ...WorkflowConditionFields\n      }\n      tags: Taxonomy(\n        where: {\n          entity: { _eq: "Workflow" }\n          Taxonomy: { status: { _eq: "active" }, type: { _eq: "tags" } }\n        }\n      ) {\n        id\n        tag: Taxonomy {\n          id\n          name\n          meta\n        }\n      }\n      user: User {\n        fullName\n      }\n    }\n    meta: Workflow_aggregate(\n      where: { title: { _ilike: $q }, status: { _eq: $status },  '," })\n      {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n\n  ","\n  ","\n"]);return eQ=function(){return e},e}function eA(){var e=(0,eT.Z)(["\n  mutation DeleteWorkflow($workflowId: Int!) {\n    delete_Workflow_by_pk(id: $workflowId) {\n      id\n    }\n  }\n"]);return eA=function(){return e},e}var eU=(0,eZ.Ps)(e_()),eF=(0,eZ.Ps)(eE()),eN=(0,eZ.Ps)(eL(),eU,eF),eV=function(e){var t=e.tagsWhere;return(0,eZ.Ps)(eQ(),t,t,eU,eF)},eM=(0,eZ.Ps)(eA()),e$=function(e){var t=e.control,n=e.errors,o=(0,e.watch)("trigger.type"),a=(0,d.useMemo)(function(){return eo.filter(function(e){var t=e.value;return"dateIs"===o?"sendEmail"===t:"jobStatusChanges"!==o&&"quoteStatusChanges"!==o||"createTask"===t})},[o]);return(0,r.jsx)(eG,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,r.jsx)(f.Z,{width:"100%",spacing:1,children:(0,r.jsx)(f.Z,{width:"100%",direction:"row",alignItems:"flex-end",children:(0,r.jsx)(E.Qr,{name:"action",control:t,render:function(e){var t,o=e.value,i=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:n.action,helperText:null===(t=n.action)||void 0===t?void 0:t.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select action",value:o,onChange:i,options:a})}})})})})};e$.propTypes={control:s().object.isRequired,errors:s().object.isRequired,watch:s().func.isRequired};var eG=(0,I.ZP)(v.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eH=n(21023),ez=(0,I.ZP)(k.Z)(function(){return{width:"50%",height:"40px",borderRightWidth:"2px",borderStyle:"dashed"}}),eB=n(74721),eJ=function(e){e.register;var t=e.control,n=e.errors,o=e.watch,i=e.setValue,l=e.sendTestEmail,s=(0,$.x)().user,u=(0,d.useState)(""),c=u[0],v=u[1],x=(0,d.useState)(""),h=x[0],b=x[1],y=o("emailTemplate.sendToCategory"),j=(0,g.a)(ed.qd,{skip:!y||"customEmail"===y||"admin"===y,variables:{q:""!==c?"%".concat(c,"%"):null,type:y,limit:50,offset:0}}),T=j.loading,Z=j.data,w=(void 0===Z?{items:[]}:Z).items,S=(0,g.a)(ed.yR,{skip:"admin"!==y,variables:{q:""!==h?"%".concat(h,"%"):null,accountId:s.adminId,limit:50,offset:0}}),I=S.loading,P=S.data,R=(void 0===P?{items:[]}:P).items;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(eX,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,r.jsxs)(f.Z,{spacing:1,children:[(0,r.jsxs)(f.Z,{direction:"row",width:"100%",alignItems:"baseline",children:[(0,r.jsx)(m.Z,{sx:{fontWeight:700,mb:"5px",mr:"24px",textWrap:"nowrap"},children:"Send to"}),(0,r.jsx)(E.Qr,{name:"emailTemplate.sendToCategory",control:t,render:function(e){var t,o,a,l=e.value,s=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendToCategory,helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(a=o.sendToCategory)||void 0===a?void 0:a.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select category",value:l,onChange:function(e){i("emailTemplate.sendTo",null),s(e.target.value)},options:ea||[]})}})]}),["customer","supplier","tenant"].includes(y)&&(0,r.jsx)(E.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,o,i,l=e.value,s=e.onChange;return(0,r.jsx)(eu.q,{multiple:!0,disableCloseOnSelect:!0,color:"secondary",filterSelectedOptions:!0,loading:T,value:Array.isArray(l)?l:[],onChange:function(e,t){s(t)},options:w,setSearch:v,textFieldProps:{label:"Select ".concat(y),variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendTo,helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(i=o.sendTo)||void 0===i?void 0:i.message},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var o=n.selected;return(0,d.createElement)("li",(0,C.Z)((0,a.Z)({},e),{key:t.value,children:[(0,r.jsx)(N.Z,{color:"secondary",style:{height:10,marginRight:8},checked:o}),t.label]}))}})}}),"admin"===y&&(0,r.jsx)(E.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,o,i,l=e.value,s=e.onChange;return(0,r.jsx)(eu.q,{multiple:!0,disableCloseOnSelect:!0,color:"secondary",loading:I,value:Array.isArray(l)?l:[],onChange:function(e,t){s(t)},options:R,setSearch:b,textFieldProps:{label:"Select ".concat(y),variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendTo,helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(i=o.sendTo)||void 0===i?void 0:i.message},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var o=n.selected;return(0,d.createElement)("li",(0,C.Z)((0,a.Z)({},e),{key:t.value,children:[(0,r.jsx)(N.Z,{color:"secondary",style:{height:10,marginRight:8},checked:o}),t.label]}))}})}}),"customEmail"===y&&(0,r.jsx)(E.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(q.Z,{color:"secondary",variant:"standard",label:"Specific email address",value:i,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.sendTo),helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(a=o.sendTo)||void 0===a?void 0:a.message})}})]})}),(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(eX,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,r.jsxs)(f.Z,{spacing:4,children:[(0,r.jsx)(E.Qr,{name:"emailTemplate.subject",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(q.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Subject",value:i,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.subject),helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(a=o.subject)||void 0===a?void 0:a.message})}}),(0,r.jsx)(E.Qr,{name:"emailTemplate.content",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(q.Z,{fullWidth:!0,multiline:!0,minRows:6,color:"secondary",variant:"filled",label:"Content",value:i,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.content),helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(a=o.content)||void 0===a?void 0:a.message})}}),(0,r.jsxs)(f.Z,{spacing:1,children:[(0,r.jsxs)(f.Z,{direction:"row",alignItems:"flex-end",spacing:1,children:[(0,r.jsx)(E.Qr,{name:"emailTemplate.buttonTitle",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(q.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Button title",value:i,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.buttonTitle),helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(a=o.buttonTitle)||void 0===a?void 0:a.message})}}),(0,r.jsx)(eH.Z,(0,C.Z)((0,a.Z)({title:"This is the text that will show on the button in the email.",placement:"left-end",leaveDelay:1500,arrow:!0},eY),{children:(0,r.jsx)(D.Z,{size:"small",children:(0,r.jsx)(eB.Z,{color:"secondary"})})}))]}),(0,r.jsxs)(f.Z,{direction:"row",alignItems:"flex-end",spacing:1,children:[(0,r.jsx)(E.Qr,{name:"emailTemplate.buttonLink",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(q.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Button link",value:i,onChange:l,error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.buttonLink),helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(a=o.buttonLink)||void 0===a?void 0:a.message})}}),(0,r.jsx)(eH.Z,(0,C.Z)((0,a.Z)({title:"This is where the user will be directed upon clicking the button.",placement:"left-end",leaveDelay:1500,arrow:!0},eY),{children:(0,r.jsx)(D.Z,{size:"small",children:(0,r.jsx)(eB.Z,{color:"secondary"})})}))]})]})]})}),(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(eX,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,r.jsxs)(f.Z,{spacing:1,children:[(0,r.jsx)(m.Z,{variant:"h6",children:"Column selector"}),(0,r.jsx)(m.Z,{children:"Select the columns you would like to see in the report"}),(0,r.jsx)(k.Z,{}),(0,r.jsx)(E.Qr,{name:"emailTemplate.columns",control:t,render:function(e){var t=e.value,n=e.onChange;return(0,r.jsx)(eu.q,{multiple:!0,disableCloseOnSelect:!0,value:t||[],onChange:function(e,t){return n(t)},options:ei,color:"secondary",textFieldProps:{color:"secondary",variant:"standard",label:"Columns"},sx:{width:"100%"},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var o=n.selected;return(0,d.createElement)("li",(0,C.Z)((0,a.Z)({},e),{key:t.value,children:[(0,r.jsx)(N.Z,{color:"secondary",style:{height:10,marginRight:8},checked:o}),t.label]}))}})}})]})}),(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(eX,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,r.jsxs)(f.Z,{direction:"row",alignItems:"flex-end",spacing:2,children:[(0,r.jsx)(E.Qr,{name:"emailTemplate.sendToTestEmail",control:t,render:function(e){var t,o,a,i=e.value,l=e.onChange;return(0,r.jsx)(q.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Send test email",error:!!(null===(t=n.emailTemplate)||void 0===t?void 0:t.sendToTestEmail),helperText:null===(o=n.emailTemplate)||void 0===o?void 0:null===(a=o.sendToTestEmail)||void 0===a?void 0:a.message,value:i,onChange:l})}}),(0,r.jsx)(p.Z,{color:"secondary",variant:"contained",sx:{width:120},type:"submit",onClick:l,children:"Send test"})]})})]})};eJ.defaultProps={sendTestEmail:function(){}},eJ.propTypes={register:s().func.isRequired,control:s().object.isRequired,errors:s().object.isRequired,watch:s().func.isRequired,setValue:s().func.isRequired};var eX=(0,I.ZP)(v.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eY={slotProps:{tooltip:{sx:{backgroundColor:"secondary.main"}},arrow:{sx:{color:"secondary.main"}}}},eK=function(e){var t,n;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,from:e.trigger.from,to:e.trigger.to,jobType:e.trigger.jobType},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),taskTemplate:{status:"new",title:e.taskTemplate.title,content:e.taskTemplate.content,priority:e.taskTemplate.priority,dueDateType:e.taskTemplate.dueDateType,dueDateDaysAfterTriggerDay:e.taskTemplate.dueDateDaysAfterTriggerDay,dueDateChooseDate:e.taskTemplate.dueDateChooseDate,assignedUser:{value:e.taskTemplate.assignedUser.value,label:e.taskTemplate.assignedUser.label},relatedLinksType:e.taskTemplate.relatedLinksType,relatedLinks:e.taskTemplate.relatedLinks},tags:null===(n=e.taskTemplate.workflowTags)||void 0===n?void 0:n.map(function(e){return{entity:"Workflow",taxonomyId:e.tag.id}})}},e0=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}},e1=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,from:e.trigger.from,to:e.trigger.to,jobType:e.trigger.jobType},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),taskTemplate:{status:"new",title:e.taskTemplate.title,content:e.taskTemplate.content,priority:e.taskTemplate.priority,dueDateType:e.taskTemplate.dueDateType,dueDateDaysAfterTriggerDay:e.taskTemplate.dueDateDaysAfterTriggerDay,dueDateChooseDate:e.taskTemplate.dueDateChooseDate,assignedUser:{value:e.taskTemplate.assignedUser.value,label:e.taskTemplate.assignedUser.label},relatedLinksType:e.taskTemplate.relatedLinksType,relatedLinks:e.taskTemplate.relatedLinks}}},e2=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}},e6=function(e){var t;return{sendToTestEmail:e.emailTemplate.sendToTestEmail,title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}},e5=p.Z,e9=function(e){var t,n,o=e.workflowId,l=e.close,s=(0,eW.D)(),u=(0,d.useState)(!1),c=u[0],p=u[1],v=(0,E.cI)({defaultValues:{status:"active",taskTemplate:{status:"new",priority:"urgent",workflowTags:[],relatedLinks:[]}},context:{sendTestEmailIsRequired:c},resolver:(0,ep.S)(ef)}),x=v.handleSubmit,b=v.register,y=v.watch,j=v.setValue,T=v.reset,k=v.control,I=v.errors,D=(0,E.Dq)({control:k,name:"condition"}),A=D.fields,U=D.append,F=D.remove,N=(0,g.a)(eN,{skip:!o,variables:{id:o},onCompleted:function(){var e,t,n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{workflow:{}}).workflow,r=(null===(e=n.conditions)||void 0===e?void 0:e.find(function(e){return e.isTrigger}))||{},o=(null===(t=n.conditions)||void 0===t?void 0:t.filter(function(e){return!e.isTrigger}))||[];T({title:n.title,status:n.status,action:n.action,trigger:r.trigger,condition:o.map(function(e){return{type:e.condition.type,value:e.condition.value}}),taskTemplate:(0,C.Z)((0,a.Z)({},n.taskTemplate||{}),{workflowTags:n.tags}),emailTemplate:(0,a.Z)({},n.emailTemplate||{})})}}).loading,V=(0,i.Z)((0,h.D)(eI,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){s.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){s.show({content:"Workflow was created"}),l()}}),2),M=V[0],$=V[1].loading,G=(0,i.Z)((0,h.D)(eP,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){s.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){s.show({content:"Workflow was created"}),l()}}),2),H=G[0],z=G[1].loading,J=(0,i.Z)((0,h.D)(eD,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){s.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){s.show({content:"Workflow was updated"}),l()}}),2),X=J[0],Y=J[1].loading,K=(0,i.Z)((0,h.D)(eR,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){s.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){s.show({content:"Workflow was updated"}),l()}}),2),ee=K[0],et=K[1].loading,en=(0,i.Z)((0,h.D)(eO,{onError:function(e){s.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){s.show({content:"Email was sent"})}}),2),er=en[0],eo=en[1].loading,ea=(t=(0,Z.Z)(function(e){var t,n,r,i;return(0,w.__generator)(this,function(l){if(o)switch(e.action){case"createTask":r=e1(e),X({variables:{data:(0,C.Z)((0,a.Z)({},r),{workflowId:o})}});break;case"sendEmail":i=e2(e),ee({variables:{data:(0,C.Z)((0,a.Z)({},i),{workflowId:o})}})}else switch(e.action){case"createTask":t=eK(e),M({variables:{data:t}});break;case"sendEmail":n=e0(e),H({variables:{data:n}})}return[2]})}),function(e){return t.apply(this,arguments)}),ei=(n=(0,Z.Z)(function(e){var t;return(0,w.__generator)(this,function(n){return t=e6(e),er({variables:{data:t}}),[2]})}),function(e){return n.apply(this,arguments)}),el=y("trigger.type"),es=y("action");return(0,r.jsxs)(r.Fragment,{children:[(N||$||z||Y||et||eo)&&(0,r.jsx)(R.Z,{sx:{zIndex:1e5},open:!0,children:(0,r.jsx)(O.Z,{color:"secondary"})}),(0,r.jsx)("form",{onSubmit:x(c?ei:ea),children:(0,r.jsx)(e4,{children:(0,r.jsxs)(f.Z,{height:"100%",width:"100%",spacing:2,children:[(0,r.jsx)(W.Z,{sx:{pl:1,pr:1},children:(0,r.jsxs)(S.ZP,{container:!0,columnSpacing:2,children:[(0,r.jsx)(S.ZP,{item:!0,xs:9,children:(0,r.jsx)(E.Qr,{name:"title",control:k,render:function(e){var t,n=e.value,o=e.onChange;return(0,r.jsx)(q.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Title",value:n,onChange:o,error:I.title,helperText:null===(t=I.title)||void 0===t?void 0:t.message,InputLabelProps:{shrink:""!==n&&void 0!==n}})}})}),(0,r.jsx)(S.ZP,{item:!0,xs:3,children:(0,r.jsx)(E.Qr,{name:"status",control:k,render:function(e){var t,n=e.value,o=e.onChange;return(0,r.jsx)(_.P,{formControl:{variant:"standard",color:"secondary",error:I.status,helperText:null===(t=I.status)||void 0===t?void 0:t.message},selectProps:{fullWidth:!0},label:"Status",value:n,onChange:o,options:B})}})})]})}),(0,r.jsxs)(S.ZP,{container:!0,sx:{height:"100%",overflow:"auto",p:1},children:[(0,r.jsxs)(S.ZP,{item:!0,xs:5.5,children:[(0,r.jsx)(te,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,r.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,r.jsx)(P.Z,{src:"/static/logo/icon-white.png"}),(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(m.Z,{variant:"h6",sx:{lineHeight:1},children:"When"}),(0,r.jsx)(m.Z,{sx:{color:"#757575"},children:"This happens"})]})]})}),(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(ex,{control:k,errors:I,watch:y,setValue:j,reset:T,remove:F}),A.map(function(e,t){return(0,r.jsxs)("div",{children:[(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(ey,{index:t,field:e,control:k,errors:I,watch:y,remove:F})]},e.id)}),(0,r.jsxs)(f.Z,{width:"100%",height:"100%",children:[(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(e8,{disabled:!el,onClick:function(){return U({type:null,value:null})},children:(0,r.jsx)(Q.Z,{sx:{alignSelf:"center"}})})]})]}),(0,r.jsx)(S.ZP,{item:!0,xs:1,children:(0,r.jsx)(e3,{orientation:"vertical",children:(0,r.jsx)(e7,{children:(0,r.jsx)(L.Z,{})})})}),(0,r.jsxs)(S.ZP,{item:!0,xs:5.5,children:[(0,r.jsx)(te,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,r.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,r.jsx)(P.Z,{src:"/static/logo/icon-white.png"}),(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(m.Z,{variant:"h6",sx:{lineHeight:1},children:"Then"}),(0,r.jsx)(m.Z,{sx:{color:"#757575"},children:"Do the following"})]})]})}),(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(e$,{control:k,errors:I,watch:y}),"createTask"===es&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,r.jsx)(te,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,r.jsx)(ec,{workflowId:o,register:b,watch:y,setValue:j,control:k,errors:I})})]}),"sendEmail"===es&&(0,r.jsx)(eJ,{workflowId:o,register:b,watch:y,setValue:j,control:k,errors:I,sendTestEmail:function(){p(!0)}})]})]}),(0,r.jsxs)(f.Z,{width:"100%",direction:"row",justifyContent:"center",spacing:2,children:[(0,r.jsx)(e5,{variant:"outlined",color:"black",size:"medium",onClick:l,children:"Cancel"}),(0,r.jsx)(e5,{variant:"contained",color:"secondary",size:"medium",type:"submit",onClick:function(){p(!1)},children:o?"Update":"Create"})]})]})})})]})};e9.defaultProps={close:function(){}},e9.propTypes={workflowId:s().number,close:s().func};var e4=(0,I.ZP)(v.Z)(function(){return{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"90vw",height:"90vh",padding:"35px 27px 16px 27px",borderRadius:"8px"}}),e3=(0,I.ZP)(k.Z)(function(){return{display:"flex",alignItems:"center"}}),e7=(0,I.ZP)("div")(function(){return{display:"flex",justifyContent:"center",alignItems:"center",width:"50px",height:"50px",borderRadius:"50%",border:"1px solid #949494","& .MuiSvgIcon-root":{width:"70%",height:"70%",fill:"#949494"}}}),e8=(0,I.ZP)(D.Z)(function(){return{alignSelf:"center",display:"flex",alignItems:"center",justifyContent:"center",width:"25px",height:"25px",borderRadius:"4px",padding:0,boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)","&.Mui-disabled":{cursor:"not-allowed",pointerEvents:"unset"},"& .MuiSvgIcon-root":{width:"100%",height:"100%",fill:"#949494"}}}),te=(0,I.ZP)(v.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),tt=n(11994),tn=n(45307),tr=n(4585),to=S.ZP,ta=p.Z,ti=function(e){var t=e.open,n=e.close,o=e.initialFilters,l=e.setFilters,s=(0,i.Z)((0,tn.X)("form_data_".concat(o.filterType),o),2),u=s[0],d=s[1],c=(0,E.cI)({defaultValues:u}),p=c.control,v=c.handleSubmit,m=c.reset,x=c.getValues,g=function(e){try{var t,r,o={q:e.search?"%".concat(e.search,"%"):null,status:e.status,tags:(null===(t=e.tags)||void 0===t?void 0:t.length)>0?null===(r=e.tags)||void 0===r?void 0:r.map(function(e){return e.value}):null},i=x();l(function(e){return(0,a.Z)({},e,o)}),d(function(e){return(0,a.Z)({},e,i)})}finally{n()}},h=function(){l(o),m(o),d(o),n()};return(0,r.jsx)(tt.Z,{open:t,onClose:n,keepMounted:!0,children:(0,r.jsx)("form",{onSubmit:v(g),children:(0,r.jsx)(ts,{children:(0,r.jsxs)(to,{container:!0,rowGap:4,columnSpacing:4,children:[(0,r.jsx)(to,{item:!0,xs:12,children:(0,r.jsx)(E.Qr,{control:p,name:"search",render:function(e){var t=e.value,n=e.onChange;return(0,r.jsx)(q.Z,{fullWidth:!0,label:"Title",variant:"standard",color:"secondary",value:t,onChange:n})}})}),(0,r.jsx)(to,{item:!0,xs:12,xs2:6,children:(0,r.jsx)(E.Qr,{control:p,name:"status",render:function(e){var t=e.value,n=e.onChange;return(0,r.jsx)(_.P,{label:"Status",value:t,onChange:n,options:tl,formControl:{fullWidth:!0,variant:"standard",color:"secondary"},selectProps:{fullWidth:!0}})}})}),(0,r.jsx)(to,{item:!0,xs:12,xs2:6,children:(0,r.jsx)(tr.r,{control:p})}),(0,r.jsx)(to,{container:!0,item:!0,xs:12,children:(0,r.jsxs)(f.Z,{width:"100%",direction:"row",justifyContent:"flex-end",spacing:2,children:[(0,r.jsx)(ta,{variant:"contained",color:"danger",onClick:h,children:"Cancel"}),(0,r.jsx)(ta,{variant:"contained",color:"secondary",type:"submit",children:"Search"})]})})]})})})})};ti.propTypes={open:s().bool,close:s().func,initialFilters:s().object,setFilters:s().func};var tl=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],ts=(0,I.ZP)(v.Z)(function(){return{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"100vw",maxWidth:"600px",maxHeight:"100vh",padding:"16px",borderRadius:"8px",overflow:"auto"}}),tu=n(87918),td=function(e){var t=e.conditions,n=(0,d.useMemo)(function(){return t.find(function(e){return e.isTrigger})},[t]),o=(0,d.useMemo)(function(){return t.filter(function(e){return!e.isTrigger})},[t]),a=(0,d.useCallback)(function(e){var t=e.trigger,n=(J.find(function(e){return e.value===t.type})||{label:""}).label;switch(t.type){case"jobStatusChanges":case"quoteStatusChanges":var r=X[t.type].find(function(e){return e.value===t.from}),o=X[t.type].find(function(e){return e.value===t.to});return"When ".concat(n.toLowerCase()," from ").concat(r.text," to ").concat(o.text);case"dateIs":var a=ee.find(function(e){return e.value===t.frequency}),i=et.find(function(e){return e.value===t.daysIn}),l=en.find(function(e){return e.value===t.inThePeriod});return"When ".concat(n.toLowerCase(),"\n        //@ts-ignore\n        ").concat(a.label.toLowerCase(),"\n        //@ts-ignore\n        ").concat(i.label.toLowerCase()," in\n        //@ts-ignore\n        ").concat(l.label.toLowerCase())}},[]),i=(0,d.useCallback)(function(e){var t=e.type;return(K.find(function(e){return e.value===t.value})||{label:""}).label},[]);return(0,r.jsxs)(r.Fragment,{children:[!!n&&(0,r.jsx)(tu.Z,{label:"".concat(a(n)),sx:{mr:1}}),o.map(function(e){return(0,r.jsx)(tu.Z,{label:"".concat(i(e.condition)," ").concat(e.condition.value.label),sx:{mr:1}})})]})};td.defaultProps={conditions:[]},td.propTypes={conditions:s().array};var tc=n(71559),tp=function(e){var t=e.initialFilters,n=e.containerHeight,o=e.tableHeight,l=(0,i.Z)((0,y.d)(),2),s=l[0],Z=l[1],C=(0,eW.D)(),w=(0,d.useState)(!1),k=w[0],S=w[1],q=(0,d.useState)((0,a.Z)({},t)),I=q[0],P=q[1],D=(0,u.x)({filters:I}),R=D.initialData,O=D.ref,W=(0,tc.Y)(R.tags,"Workflow"),_=(0,g.a)(eV({tagsWhere:W}),{variables:R}),E=_.data,L=void 0===E?{workflows:[],meta:{aggregate:{totalCount:0}}}:E,Q=L.workflows,A=L.meta,F=_.loading,N=_.refetch,V=(0,i.Z)((0,h.D)(eM,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){C.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){C.show({content:"Workflow was deleted"}),close()}}),1)[0],M=(0,d.useCallback)(function(e){var t=e.workflowId;Z({content:function(e){var n=e.onClose;return(0,r.jsx)(e9,{workflowId:t,close:n})}})},[Z]),$=(0,d.useCallback)(function(e){return[{icon:"edit",onClick:function(t){t.stopPropagation(),M({workflowId:e.id})},tooltip:"Edit"},{icon:"delete",onClick:function(t){t.stopPropagation(),V({variables:{workflowId:e.id}})},tooltip:"Delete"}]},[V,M]),G=(0,d.useMemo)(function(){return[{flex:1,field:"title",headerName:"Title"},{sortable:!1,flex:1,field:"conditions",headerName:"Trigger",renderCell:function(e){var t=e.row;return(0,r.jsx)(td,{conditions:t.conditions})}},{sortable:!1,flex:1,field:"tags",headerName:"Tags",renderCell:function(e){var t=e.row;return"sendEmail"!==t.action?(0,r.jsx)(T.K,{row:t,entity:"Workflow",refetchQueries:["GetWorkflows"]}):null}},{flex:1,field:"fired",headerName:"Fired"},{flex:1,field:"createdBy",headerName:"Created by",sortName:'{"User": {"fullName": "ORDER"}}'},{flex:1,field:"createdAt",headerName:"Created at"},{flex:1,field:"status",headerName:"Status"},{width:50,field:"actions",headerName:"Actions",sortable:!1,renderCell:function(e){var t=e.row;return(0,r.jsx)(x.C,{row:t,actionsData:$})}}]},[$]),H=(0,d.useMemo)(function(){return Q.map(function(e){return{id:e.id,title:e.title,conditions:e.conditions,tags:e.tags,fired:e.fired,createdBy:e.user.fullName,createdAt:U()(e.createdAt).format("YYYY-MM-DD"),status:e.status,action:e.action}})},[Q]),z=function(e){e.stopPropagation(),Z({content:function(e){var t=e.onClose;return(0,r.jsx)(e9,{close:t})}})};return(0,r.jsxs)(r.Fragment,{children:[s,(0,r.jsx)(ti,{open:k,close:function(){return S(!1)},initialFilters:t,filters:I,setFilters:P}),(0,r.jsxs)(f.Z,{width:"100%",spacing:2,children:[(0,r.jsxs)(f.Z,{direction:"row",justifyContent:"space-between",children:[(0,r.jsx)(p.Z,{variant:"contained",startIcon:(0,r.jsx)(j.Z,{}),onClick:function(){return S(!0)},children:"Filters"}),(0,r.jsx)(p.Z,{variant:"contained",color:"secondary",onClick:z,children:"Add Automation"})]}),(0,r.jsxs)(v.Z,{sx:{paddingTop:"16px",paddingBottom:"16px",height:n},children:[!!(null==H?void 0:H.length)&&(0,r.jsx)(f.Z,{direction:"row",justifyContent:"space-between",children:(0,r.jsx)(m.Z,{ml:2,variant:"h5",sx:{fontWeight:600},children:"Automation"})}),(null==H?void 0:H.length)?(0,r.jsx)(c.i,{autoHeight:!1,loading:F,ref:O,columns:G,rows:H,meta:A,refetch:N,onRowClick:function(e){return M({workflowId:e.row.id})},containerHeight:o}):!F&&(0,r.jsx)(b.C,{imageSrc:"/static/icons/no_automations_found.svg",title:"Create your first automation",subtitleFirstLine:"Task automations help you stay on top of work;\n            streamline your workflow",subtitleSecondLine:"processes and integrate with other apps\n            for increased productivity.",buttonText:"Add Automation",onAction:z})]})]})]})};tp.defaultProps={initialFilters:{},containerHeight:"calc(100vh - 86px)",tableHeight:"calc(100% - 32px)"},tp.propTypes={initialFilters:s().object,containerHeight:s().string,tableHeight:s().string};var tv=n(24716),tf=n(11163),tm=n.n(tf),tx=function(){var e,t,n=(0,o.q)();return(null==n?void 0:null===(e=n.admin)||void 0===e?void 0:null===(t=e.modules)||void 0===t?void 0:t.workflows)?(0,r.jsx)(tp,{initialFilters:{filterType:"workflow_table"}}):(tm().push("/404"),null)};tx.getLayout=function(e){return(0,r.jsx)(tv.Z,{children:e})};var tg=tx}},function(e){e.O(0,[3662,2283,212,8890,9511,2583,6310,4599,4135,8579,4244,3776,2329,778,1023,3911,9957,1870,8062,2429,5497,4447,116,4716,6937,9774,2888,179],function(){return e(e.s=6315)}),_N_E=e.O()}]);