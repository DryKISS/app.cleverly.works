(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8521,3425],{36191:function(e,n,t){"use strict";var o=t(64836);n.Z=void 0;var a=o(t(64938)),i=t(85893);n.Z=(0,a.default)((0,i.jsx)("path",{d:"M18.3 5.71a.9959.9959 0 0 0-1.41 0L12 10.59 7.11 5.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"}),"CloseRounded")},86532:function(e,n,t){"use strict";var o=t(87462),a=t(63366),i=t(67294);t(76607);var r=t(63961),l=t(58510),s=t(78114),c=t(90948),d=t(57922),u=t(90629),m=t(64861),p=t(49299),h=t(80560),v=t(12814),x=t(85893);let f=["children","className","defaultExpanded","disabled","disableGutters","expanded","onChange","square","slots","slotProps","TransitionComponent","TransitionProps"],g=(0,s.U)("MuiAccordion"),b=e=>{let{classes:n,square:t,expanded:o,disabled:a,disableGutters:i}=e;return(0,l.Z)({root:["root",!t&&"rounded",o&&"expanded",a&&"disabled",!i&&"gutters"],region:["region"]},v.k,n)},y=(0,c.ZP)(u.Z,{name:"MuiAccordion",slot:"Root",overridesResolver(e,n){let{ownerState:t}=e;return[{[`& .${v.Z.region}`]:n.region},n.root,!t.square&&n.rounded,!t.disableGutters&&n.gutters]}})(({theme:e})=>{let n={duration:e.transitions.duration.shortest};return{position:"relative",transition:e.transitions.create(["margin"],n),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(e.vars||e).palette.divider,transition:e.transitions.create(["opacity","background-color"],n)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${v.Z.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${v.Z.disabled}`]:{backgroundColor:(e.vars||e).palette.action.disabledBackground}}},({theme:e})=>({variants:[{props:e=>!e.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(e.vars||e).shape.borderRadius,borderBottomRightRadius:(e.vars||e).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:e=>!e.disableGutters,style:{[`&.${v.Z.expanded}`]:{margin:"16px 0"}}}]})),Z=i.forwardRef(function(e,n){let t=g({props:e,name:"MuiAccordion"}),{children:l,className:s,defaultExpanded:c=!1,disabled:u=!1,disableGutters:v=!1,expanded:Z,onChange:j,square:C=!1,slots:I={},slotProps:w={},TransitionComponent:S,TransitionProps:A}=t,k=(0,a.Z)(t,f),[_,q]=(0,p.Z)({controlled:Z,default:c,name:"Accordion",state:"expanded"}),R=i.useCallback(e=>{q(!_),j&&j(e,!_)},[_,j,q]),[M,...T]=i.Children.toArray(l),N=i.useMemo(()=>({expanded:_,disabled:u,disableGutters:v,toggle:R}),[_,u,v,R]),P=(0,o.Z)({},t,{square:C,disabled:u,disableGutters:v,expanded:_}),D=b(P),F=(0,o.Z)({transition:S},I),L=(0,o.Z)({transition:A},w),[E,$]=(0,h.Z)("transition",{elementType:d.Z,externalForwardedProps:{slots:F,slotProps:L},ownerState:P});return(0,x.jsxs)(y,(0,o.Z)({className:(0,r.Z)(D.root,s),ref:n,ownerState:P,square:C},k,{children:[(0,x.jsx)(m.Z.Provider,{value:N,children:M}),(0,x.jsx)(E,(0,o.Z)({in:_,timeout:"auto"},$,{children:(0,x.jsx)("div",{"aria-labelledby":M.props.id,id:M.props["aria-controls"],role:"region",className:D.region,children:T})}))]}))});n.Z=Z},64861:function(e,n,t){"use strict";var o=t(67294);let a=o.createContext({});n.Z=a},22797:function(e,n,t){"use strict";t.d(n,{Z:function(){return b}});var o=t(87462),a=t(63366),i=t(67294),r=t(63961),l=t(58510),s=t(78114),c=t(90948),d=t(1977),u=t(8027);function m(e){return(0,u.ZP)("MuiAccordionDetails",e)}(0,d.Z)("MuiAccordionDetails",["root"]);var p=t(85893);let h=["className"],v=(0,s.U)("MuiAccordionDetails"),x=e=>{let{classes:n}=e;return(0,l.Z)({root:["root"]},m,n)},f=(0,c.ZP)("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,n)=>n.root})(({theme:e})=>({padding:e.spacing(1,2,2)})),g=i.forwardRef(function(e,n){let t=v({props:e,name:"MuiAccordionDetails"}),{className:i}=t,l=(0,a.Z)(t,h),s=x(t);return(0,p.jsx)(f,(0,o.Z)({className:(0,r.Z)(s.root,i),ref:n,ownerState:t},l))});var b=g},38895:function(e,n,t){"use strict";t.d(n,{Z:function(){return I}});var o=t(87462),a=t(63366),i=t(67294),r=t(63961),l=t(58510),s=t(78114),c=t(90948),d=t(49990),u=t(64861),m=t(1977),p=t(8027);function h(e){return(0,p.ZP)("MuiAccordionSummary",e)}let v=(0,m.Z)("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]);var x=t(85893);let f=["children","className","expandIcon","focusVisibleClassName","onClick"],g=(0,s.U)("MuiAccordionSummary"),b=e=>{let{classes:n,expanded:t,disabled:o,disableGutters:a}=e;return(0,l.Z)({root:["root",t&&"expanded",o&&"disabled",!a&&"gutters"],focusVisible:["focusVisible"],content:["content",t&&"expanded",!a&&"contentGutters"],expandIconWrapper:["expandIconWrapper",t&&"expanded"]},h,n)},y=(0,c.ZP)(d.Z,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(e,n)=>n.root})(({theme:e})=>{let n={duration:e.transitions.duration.shortest};return{display:"flex",minHeight:48,padding:e.spacing(0,2),transition:e.transitions.create(["min-height","background-color"],n),[`&.${v.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${v.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`&:hover:not(.${v.disabled})`]:{cursor:"pointer"},variants:[{props:e=>!e.disableGutters,style:{[`&.${v.expanded}`]:{minHeight:64}}}]}}),Z=(0,c.ZP)("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(e,n)=>n.content})(({theme:e})=>({display:"flex",flexGrow:1,margin:"12px 0",variants:[{props:e=>!e.disableGutters,style:{transition:e.transitions.create(["margin"],{duration:e.transitions.duration.shortest}),[`&.${v.expanded}`]:{margin:"20px 0"}}}]})),j=(0,c.ZP)("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(e,n)=>n.expandIconWrapper})(({theme:e})=>({display:"flex",color:(e.vars||e).palette.action.active,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),[`&.${v.expanded}`]:{transform:"rotate(180deg)"}})),C=i.forwardRef(function(e,n){let t=g({props:e,name:"MuiAccordionSummary"}),{children:l,className:s,expandIcon:c,focusVisibleClassName:d,onClick:m}=t,p=(0,a.Z)(t,f),{disabled:h=!1,disableGutters:v,expanded:C,toggle:I}=i.useContext(u.Z),w=e=>{I&&I(e),m&&m(e)},S=(0,o.Z)({},t,{expanded:C,disabled:h,disableGutters:v}),A=b(S);return(0,x.jsxs)(y,(0,o.Z)({focusRipple:!1,disableRipple:!0,disabled:h,component:"div","aria-expanded":C,className:(0,r.Z)(A.root,s),focusVisibleClassName:(0,r.Z)(A.focusVisible,d),onClick:w,ref:n,ownerState:S},p,{children:[(0,x.jsx)(Z,{className:A.content,ownerState:S,children:l}),c&&(0,x.jsx)(j,{className:A.expandIconWrapper,ownerState:S,children:c})]}))});var I=C},35576:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/properties/view",function(){return t(27913)}])},19441:function(e,n,t){"use strict";t.d(n,{P:function(){return p}});var o=t(26042),a=t(69396),i=t(99534),r=t(85893),l=t(90948),s=t(94054),c=t(47312),d=t(18972),u=t(18360),m=t(56815),p=function(e){var n=e.fullWidth,t=e.variant,l=e.label,s=e.options,c=e.value,p=e.onChange,x=e.helperText,f=(0,i.Z)(e,["fullWidth","variant","label","options","value","onChange","helperText"]);return(0,r.jsxs)(h,{variant:t,fullWidth:n,children:[(0,r.jsx)(v,{children:l}),(0,r.jsx)(u.Z,(0,a.Z)((0,o.Z)({fullWidth:n,displayEmpty:!0,value:c||"",onChange:p,renderValue:function(){var e,n=s.find(function(e){return e.value===c});return n?n.label:""}},f),{children:s.map(function(e){return(0,r.jsx)(d.Z,{value:e.value,children:e.label},e.value)})})),x&&(0,r.jsx)(m.Z,{children:x})]})},h=(0,l.ZP)(s.Z)(function(e){return e.theme,{"&.MuiFormControl-root":{display:"flex",flexDirection:"column",alignItems:"flex-start"}}}),v=(0,l.ZP)(c.Z)(function(e){return{"&.MuiFormLabel-root.MuiInputLabel-root.Mui-focused":{color:e.theme.palette.secondary.main}}})},71181:function(e,n,t){"use strict";t.d(n,{C:function(){return k}});var o=t(85893),a=t(67294),i=t(93946),r=t(25464),l=t(18972),s=t(57976),c=t(73890),d=t(69008),u=t(41687),m=t(60888),p=t(40535),h=t(63441),v=t(41733),x=t(77957),f=t(2548),g=t(24519),b=t(2391),y=t(69308),Z=t(79369),j=t(22961),C=t(28201),I=t(51233),w=t(15861),S={add:(0,o.jsx)(u.Z,{}),archive:(0,o.jsx)(c.Z,{}),avatar:(0,o.jsx)(C.Z,{}),check:(0,o.jsx)(m.Z,{}),delete:(0,o.jsx)(v.Z,{}),description:(0,o.jsx)(p.Z,{}),download:(0,o.jsx)(h.Z,{}),info:(0,o.jsx)(f.Z,{}),edit:(0,o.jsx)(x.Z,{}),location:(0,o.jsx)(y.Z,{}),unarchive:(0,o.jsx)(d.Z,{}),uploadFile:(0,o.jsx)(g.Z,{}),receipt:(0,o.jsx)(b.Z,{}),visibility:(0,o.jsx)(j.Z,{})},A={default:(0,o.jsx)(s.Z,{}),defaultHoriz:(0,o.jsx)(Z.Z,{}),description:(0,o.jsx)(p.Z,{})},k=function(e){var n=e.actions,t=e.icon,s=e.disabled,c=(0,a.useState)(null),d=c[0],u=c[1],m=function(e){e.stopPropagation(),u(e.currentTarget)},p=function(){u(null)};return(0,o.jsxs)("div",{children:[(0,o.jsx)(i.Z,{sx:{":hover":{backgroundColor:"#DDDDDD"}},disabled:s,"aria-controls":"simple-menu","aria-haspopup":"true",onClick:m,children:A[void 0===t?"default":t]}),(0,o.jsx)(r.Z,{id:"simple-menu",anchorEl:d,keepMounted:!0,open:Boolean(d),onClose:p,PaperProps:{sx:{borderRadius:2}},children:n.map(function(e,n){return(0,o.jsx)(l.Z,{disabled:e.disabled,onClick:function(n){e.onClick(n),p()},sx:{pl:3,pr:4},children:(0,o.jsxs)(I.Z,{direction:"row",alignItems:"center",spacing:2,children:[e.icon?S[e.icon]:null,(0,o.jsx)(w.Z,{children:e.tooltip})]})},n)})})]})}},29059:function(e,n,t){"use strict";t.d(n,{i:function(){return w}});var o=t(14924),a=t(26042),i=t(69396),r=t(99534),l=t(85893),s=t(67294),c=t(11163),d=t(61870),u=t(5616),m=t(51233),p=t(15861),h=t(90948),v=t(41796),x=t(29217),f=t(45111),g=t(98209),b=t(70872),y=t(58886),Z=t(61730),j=function(e){var n=e.currentPage,t=e.totalCount,o=e.pageSize,i=e.onPageChange,r=(0,Z.Z)("(max-width:400px)"),s=(0,Z.Z)("(max-width:500px)");return(0,l.jsx)(C,{page:n,count:Math.ceil(t/o),onChange:function(e,n){return i(n)},variant:"outlined",shape:"rounded",size:r?"small":"medium",hidePrevButton:1===n,hideNextButton:n===Math.ceil(t/o),siblingCount:s?0:1,renderItem:function(e){return(0,l.jsx)(y.Z,(0,a.Z)({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},e))}})},C=(0,h.ZP)(b.Z)(function(e){var n,t=e.hidePrevButton,i=e.hideNextButton,r=e.theme;return n={},(0,o.Z)(n,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,o.Z)(n,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,o.Z)(n,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,o.Z)(n,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,o.Z)(n,"& button.Mui-selected",(0,a.Z)({color:r.palette.white.main,backgroundColor:r.palette.secondary.main},i?{borderRadius:"0 5px 5px 0"}:{},t?{borderRadius:"5px 0 0 5px"}:{})),n}),I={item:"id",order:"desc"},w=function(e){var n=e.columns,t=(e.history,e.totalCount),o=e.paginationSize,i=e.containerHeight,d=e.noResultsMessage,u=void 0===d?"There are no results.":d,h=e.autoHeight,v=e.onTableStateChange,b=(0,r.Z)(e,["columns","history","totalCount","paginationSize","containerHeight","noResultsMessage","autoHeight","onTableStateChange"]),y=(0,c.useRouter)().query,Z=(0,s.useMemo)(function(){var e,n;return(null==y?void 0:null===(e=y.page)||void 0===e?void 0:null===(n=e.toString)||void 0===n?void 0:n.call(e))?parseInt(y.page.toString(),10):1},[y.page]),C=(0,s.useState)(Z||1),w=C[0],k=C[1],_=(0,s.useState)(o||g.C1.paginationSize)[0],q=(0,s.useState)({item:I.item,order:I.order}),R=q[0],M=q[1];(0,s.useEffect)(function(){v&&v({currentPage:w-1,pageSize:_,sorting:[R]})},[w,_,R,v]);var T=function(e){k(e)},N=function(e){e&&e.field&&e.sort?M({item:e.field,order:e.sort}):M({item:I.item,order:I.order})};return(0,l.jsxs)(S,{containerHeight:i,children:[(0,l.jsx)(A,(0,a.Z)({hideFooter:!0,disableColumnMenu:!0,disableRowSelectionOnClick:!0,autoHeight:h,sortingMode:"server",onSortModelChange:function(e){return N(e[0])},columns:n,initialState:{pagination:{paginationModel:{pageSize:_}}},slots:{columnSortedAscendingIcon:function(){return(0,l.jsx)(x.Z,{})},columnSortedDescendingIcon:function(){return(0,l.jsx)(f.Z,{})},columnUnsortedIcon:function(){return(0,l.jsxs)(m.Z,{alignItems:"center",sx:{width:"33px"},children:[(0,l.jsx)(x.Z,{sx:{marginBottom:"-15px"}}),(0,l.jsx)(f.Z,{})]})},noResultsOverlay:function(){return(0,l.jsx)(m.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,l.jsx)(p.Z,{children:u})})},noRowsOverlay:function(){return(0,l.jsx)(m.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,l.jsx)(p.Z,{children:u})})}}},b)),t&&Math.ceil(t/_)>1?(0,l.jsx)(j,{currentPage:w,totalCount:t,pageSize:_,onPageChange:T}):null]})},S=(0,h.ZP)(u.Z)(function(e){return{height:e.containerHeight,display:"flex",flexDirection:"column"}}),A=(0,h.ZP)(d.s)(function(e){var n,t=e.theme,r=e.hideHeader;return n={"--DataGrid-overlayHeight":"40px"},(0,o.Z)(n,"&.MuiDataGrid-root",{color:t.palette.black.main,border:"none"}),(0,o.Z)(n,"& .MuiDataGrid-columnHeaders",(0,i.Z)((0,a.Z)({},r&&{display:"none"}),{"& .MuiDataGrid-iconButtonContainer":{visibility:"visible","& .MuiButtonBase-root.MuiIconButton-root":{backgroundColor:"inherit",color:t.palette.black.main,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"}}}})),(0,o.Z)(n,"& .MuiDataGrid-virtualScroller",(0,a.Z)({},r&&{marginTop:"0 !important"})),(0,o.Z)(n,"& .MuiDataGrid-iconSeparator",{opacity:0}),(0,o.Z)(n,"& .MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,o.Z)(n,"& .MuiButtonBase-root.MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,o.Z)(n,"& .MuiDataGrid-overlayWrapper",(0,o.Z)({},"& .MuiCircularProgress-root",{color:t.palette.secondary.main})),(0,o.Z)(n,"& .MuiDataGrid-row.even",{backgroundColor:t.palette.muiLightGray.main,"&:hover, &.Mui-hovered":{backgroundColor:(0,v.Fq)(t.palette.muiLightGray.main,.3),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,v.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,v.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,v.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity)}}}}),n})},25267:function(e,n,t){"use strict";t.d(n,{MI:function(){return r},UF:function(){return i},gz:function(){return a}});var o=t(24341),a={active:"success",inactive:"danger"},i=[{label:"Active",value:o.b.ACTIVE},{label:"Inactive",value:o.b.INACTIVE}],r=[{label:o.D.WEEKLY,value:o.D.WEEKLY},{label:o.D.MONTHLY,value:o.D.MONTHLY},{label:o.D.QUARTERLY,value:o.D.QUARTERLY},{label:o.D.ANNUALLY,value:o.D.ANNUALLY},{label:o.D.EVERY_FIVE_YEARS,value:o.D.EVERY_FIVE_YEARS}]},24341:function(e,n,t){"use strict";var o,a,i,r;t.d(n,{D:function(){return o},b:function(){return a}}),(i=o||(o={})).WEEKLY="Weekly",i.MONTHLY="Monthly",i.QUARTERLY="Quarterly",i.ANNUALLY="Annually",i.EVERY_FIVE_YEARS="Every 5 years",(r=a||(a={})).ACTIVE="active",r.INACTIVE="inactive"},24572:function(e,n,t){"use strict";t.d(n,{V:function(){return i}});var o=t(14924),a=t(67294),i=function(){var e=(0,a.useState)({currentPage:0,pageSize:50,sorting:[]}),n=e[0],t=e[1],i=(0,a.useMemo)(function(){return n.sorting.map(function(e){return(0,o.Z)({},e.item,e.order)},[])},[n.sorting]);return{reference:{onTableStateChange:t},pagination:{offset:n.currentPage*n.pageSize,limit:n.pageSize},order:i}}},49408:function(e,n,t){"use strict";t.d(n,{E:function(){return W}});var o=t(26042),a=t(85893),i=t(11163),r=t.n(i),l=t(45697),s=t.n(l),c=t(74492),d=t(45451),u=t(12632),m=t(80426),p=t(6812),h=t(30381),v=t.n(h),x=t(11994),f=t(11057),g=t(90629),b=t(51233),y=t(15861),Z=t(83162),j=t(81261),C=t(89591),I=t(21830),w=t(69396),S=t(828),A=t(86886),k=t(50135),_=t(61730),q=t(45307),R=t(42283),M=t(73359),T=t(67294),N=t(4595),P=t(57493),D=t(10166),F=A.ZP,L=f.Z,E=function(e){var n,t=e.open,i=e.setOpen,r=e.initialFilters,l=e.filters,s=e.setFilters,c=(0,_.Z)("(max-width: 400px)")?4:0,d=(0,S.Z)((0,q.X)("form_data_".concat(r.filterType),r),2),u=d[0],m=d[1],p=(0,R.cI)({defaultValues:u}),h=p.control,v=p.handleSubmit,x=p.register,f=p.reset,g=(0,p.watch)(),y=(0,S.Z)((0,M.t)(P.SW),2),Z=y[0],j=y[1],C=j.loading,I=j.data,A=(void 0===I?{items:[]}:I).items,D=(0,S.Z)((0,M.t)(P._d,{variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:null===(n=g.customer)||void 0===n?void 0:n.value}}}}}),2),E=D[0],W=D[1],B=W.loading,H=W.data,Y=(void 0===H?{items:[]}:H).items,V=(0,S.Z)((0,M.t)(P.UM),2),U=V[0],z=V[1],Q=z.loading,G=z.data,J=(void 0===G?{items:[]}:G).items;(0,T.useEffect)(function(){t&&f(u)},[t]),(0,T.useEffect)(function(){m((0,w.Z)((0,o.Z)({},g),{filterType:r.filterType}))},[l]);var X=function(e){try{var n,t,a,r={customerId:null===(n=e.customer)||void 0===n?void 0:n.value,locationId:null===(t=e.location)||void 0===t?void 0:t.value,categoryId:null===(a=e.assetCategory)||void 0===a?void 0:a.value,q:e.search?"%".concat(e.search,"%"):null};s(function(e){return(0,o.Z)({},e,r)})}finally{i(!1)}},K=function(){s(r),f(r),i(!1)};return(0,a.jsx)($,{keepMounted:!0,open:t,onClose:function(){return i(!1)},children:(0,a.jsx)("form",{onSubmit:v(X),children:(0,a.jsx)(O,{children:(0,a.jsxs)(F,{container:!0,rowGap:4,children:[(0,a.jsx)(F,{container:!0,children:(0,a.jsx)(F,{item:!0,xs:12,children:(0,a.jsx)(k.Z,{fullWidth:!0,variant:"standard",color:"secondary",label:"Search...",name:"search",inputRef:x})})}),(0,a.jsxs)(F,{container:!0,columnSpacing:4,rowGap:c,children:[(0,a.jsx)(F,{item:!0,xs:12,xs2:6,children:(0,a.jsx)(R.Qr,{name:"customer",control:h,render:function(e){var n=e.value,t=e.onChange;return(0,a.jsx)(N.F,{value:n,onChange:function(e,n){return t(n)},label:"Select customer",loading:C,onOpen:function(){return Z()},options:A})}})}),(0,a.jsx)(F,{item:!0,xs:12,xs2:6,children:(0,a.jsx)(R.Qr,{name:"location",control:h,render:function(e){var n=e.value,t=e.onChange;return(0,a.jsx)(N.F,{value:n,onChange:function(e,n){return t(n)},label:"Select location",loading:B,onOpen:function(){return E()},options:Y})}})})]}),(0,a.jsx)(F,{container:!0,columnSpacing:4,rowGap:c,children:(0,a.jsx)(F,{item:!0,xs:12,xs2:6,children:(0,a.jsx)(R.Qr,{name:"assetCategory",control:h,render:function(e){var n=e.value,t=e.onChange;return(0,a.jsx)(N.F,{value:n,onChange:function(e,n){return t(n)},label:"Select asset category",loading:Q,onOpen:function(){return U()},options:J})}})})}),(0,a.jsx)(F,{container:!0,item:!0,xs:12,children:(0,a.jsxs)(b.Z,{width:"100%",direction:"row",justifyContent:"flex-end",spacing:2,children:[(0,a.jsx)(L,{variant:"contained",color:"danger",onClick:function(){return K()},children:"Cancel"}),(0,a.jsx)(L,{variant:"contained",color:"secondary",type:"submit",children:"Search"})]})})]})})})})};E.defaultProps={open:!1,setOpen:function(){},initialFilters:{},filters:{},setFilters:function(){}},E.propTypes={open:s().bool,setOpen:s().func,initialFilters:s().object,filters:s().object,setFilters:s().func};var $=(0,D.Z)(x.Z)(function(){return{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"}}),O=(0,D.Z)(g.Z)(function(){return{padding:"24px",maxWidth:"700px",maxHeight:"100vh",overflowY:"scroll"}}),W=function(e){var n,t=e.hideLink,i=e.hideCustomerInfo,l=e.hideLocationInfo,s=e.showHeader,h=e.initialFilters,w=e.editable,S=e.createFormDefaultValues,A=(0,c.a)(),k=(0,T.useState)(!1),_=k[0],q=k[1],R=(0,T.useState)(null),M=R[0],N=R[1],P=(0,T.useState)((0,o.Z)({},h)),D=P[0],F=P[1],L=(0,u.x)({filters:D}),$=L.initialData,O=L.ref,W=(0,p.a)(m.tG,{variables:(0,o.Z)({},$)}),B=W.data,H=void 0===B?{assets:[],meta:{aggregate:{totalCount:0}}}:B,Y=H.assets,V=H.meta,U=W.loading,z=W.refetch,Q=function(){A.show({content:(0,a.jsx)(C.R,{offCanvas:A,defaultValues:S}),title:"Add Asset",submit:!0})},G=function(e){A.show({content:(0,a.jsx)(C.R,{assetId:e.id,offCanvas:A,defaultValues:S}),title:"Edit Asset",submit:!0})},J=function(e){var n=[];return w&&n.push({icon:"edit",onClick:function(n){n.stopPropagation(),G(e)},tooltip:"Edit"}),n.push({icon:"info",onClick:function(n){n.stopPropagation(),r().push("/dashboard/assets/view?id=".concat(e.id))},tooltip:"Info"}),n},X=function(e){var n=e.row;r().push("/dashboard/assets/view?id=".concat(n.id))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(b.Z,{width:"100%",spacing:2,sx:{height:"calc(100% - 58px)"},children:[s&&(0,a.jsxs)(b.Z,{width:"100%",direction:"row",justifyContent:"space-between",children:[(0,a.jsx)(f.Z,{variant:"contained",startIcon:(0,a.jsx)(j.Z,{}),onClick:function(){return q(!0)},children:"Filters"}),w&&(0,a.jsx)(b.Z,{direction:"row",spacing:2,children:(0,a.jsx)(f.Z,{variant:"contained",color:"secondary",onClick:Q,children:"Create Asset"})})]}),(0,a.jsxs)(g.Z,{sx:{paddingTop:"16px",paddingBottom:"16px",height:"100%"},children:[(0,a.jsxs)(b.Z,{direction:"row",justifyContent:"space-between",children:[(0,a.jsx)(y.Z,{ml:2,variant:"h5",sx:{fontWeight:600},children:"Assets"}),w&&!s&&(0,a.jsx)(f.Z,{sx:{mr:2},variant:"contained",color:"secondary",onClick:Q,children:"Create Asset"})]}),s&&(0,a.jsx)(E,{initialFilters:h,filters:D,setFilters:F,open:_,setOpen:q}),(0,a.jsx)(d.i,{autoHeight:!1,loading:U,ref:O,columns:[{field:"mainPhoto",headerName:"Main photo",minWidth:120,sortable:!1,renderCell:function(e){var n,t=e.row;return t.mainPhoto?(0,a.jsx)("img",{loading:"lazy",onClick:function(e){var n;e.stopPropagation(),N("".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(null===(n=t.mainPhoto)||void 0===n?void 0:n.filename))},style:{width:"70px",height:"50px"},alt:"mainPhoto",src:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(null===(n=t.mainPhoto)||void 0===n?void 0:n.filename)}):null}},{minWidth:80,flex:1,field:"name",headerName:"Name",sortable:!1},{minWidth:100,flex:1,field:"description",headerName:"Description",sortable:!1},{minWidth:80,flex:1,field:"categoryName",headerName:"Category",sortable:!1},{minWidth:120,flex:1,field:"locationName",headerName:"Location",sortable:!1,renderCell:function(e){var n=e.row;return(0,a.jsx)(Z.r,{color:"secondary",href:"/dashboard/properties/view?id=".concat(n.locationId),children:n.locationName})}},{minWidth:80,flex:1,field:"sublocationName",headerName:"Sublocation",sortable:!1,renderCell:function(e){var n=e.row;return(0,a.jsx)(Z.r,{noWrap:t,color:"secondary",href:"/dashboard/properties/view?id=".concat(n.locationId,"&tab=sublocations"),children:n.sublocationName})}},{minWidth:120,flex:1,field:"customerName",headerName:"Customer",sortable:!1,renderCell:function(e){var n=e.row;return(0,a.jsx)(Z.r,{color:"secondary",href:"/dashboard/customers/view?id=".concat(n.customerId),children:n.customerName})}},{minWidth:60,flex:1,field:"type",headerName:"Type",sortable:!1},{minWidth:60,flex:1,field:"status",headerName:"Status",sortable:!1},{minWidth:100,flex:1,field:"createdAt",headerName:"Created",sortable:!0,sortName:"createdAt"},{width:50,field:"actions",headerName:"Actions",sortable:!1,renderCell:function(e){var n=e.row;return(0,a.jsx)(I.C,{row:n,actionsData:J})}}],rows:Y.map(function(e){var t,o,a,i,r,l,s,c,d,u,m,p,h,x,f,g,b,y,Z;return{id:e.id,customer:{label:null===(t=e.customer)||void 0===t?void 0:t.name,value:null===(o=e.customer)||void 0===o?void 0:o.id},assetCategory:{label:null===(a=e.category)||void 0===a?void 0:a.name,value:null===(i=e.category)||void 0===i?void 0:i.id},description:e.description,name:e.name,location:{label:null===(r=e.location)||void 0===r?void 0:r.name,value:null===(l=e.location)||void 0===l?void 0:l.id},sublocation:{label:null===(s=e.sublocation)||void 0===s?void 0:s.name,value:null===(c=e.sublocation)||void 0===c?void 0:c.id},parent:{label:null===(d=e.parentId)||void 0===d?void 0:d.label,value:null===(u=e.parentId)||void 0===u?void 0:u.value},status:e.status,mainPhoto:null!==(n=null===(m=e.mainPhoto)||void 0===m?void 0:null===(p=m[0])||void 0===p?void 0:p.item)&&void 0!==n?n:null,locationId:null===(h=e.location)||void 0===h?void 0:h.id,customerId:null===(x=e.customer)||void 0===x?void 0:x.id,categoryName:null===(f=e.category)||void 0===f?void 0:f.name,locationName:null===(g=e.location)||void 0===g?void 0:g.name,sublocationName:null===(b=e.sublocation)||void 0===b?void 0:b.name,type:(null===(y=e.parentId)||void 0===y?void 0:y.value)?"Child":"Parent",customerName:null===(Z=e.customer)||void 0===Z?void 0:Z.name,createdAt:v()(e.createdAt).format("YYYY-MM-DD")}}),meta:V,refetch:z,onRowClick:X,containerHeight:"calc(100% - 32px)",columnVisibilityModel:{locationName:!l,customerName:!i}})]})]}),M&&(0,a.jsx)(x.Z,{open:!!M,onClose:function(){return N(null)},sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:(0,a.jsx)("img",{style:{width:"500px",height:"500px"},alt:"mainPhoto",src:M})})]})};W.defaultProps={initialFilters:{},hideLink:!1,hideCustomerInfo:!1,hideLocationInfo:!1,showHeader:!0,editable:!0},W.propTypes={initialFilters:s().shape({filterType:s().string.isRequired}),hideLink:s().bool,hideCustomerInfo:s().bool,hideLocationInfo:s().bool,showHeader:s().bool,editable:s().bool,createFormDefaultValues:s().object}},23789:function(e,n,t){"use strict";t.d(n,{CX:function(){return M},UH:function(){return Z}});var o=t(85893),a=t(84059),i=t(45697),r=t.n(i),l=t(51233),s=t(11057),c=t(86532),d=t(22797),u=t(38895),m=t(15861),p=t(5616),h=t(27434),v=t(63441),x=t(35374),f=t(67294),g=s.Z,b=function(e){var n=e.id,t=e.value,i=e.isExpandedByDefault,r=e.collapsible,s=(0,x.a)(),b=(0,f.useState)(i),Z=b[0],j=b[1],C=function(){return j(function(e){return!e})},I=function(e){e.stopPropagation();var t=document.querySelector("#qr-".concat(n," > canvas")).toDataURL(),o=document.createElement("a");o.href=t,o.download="".concat(n,".png"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},w=(0,f.useMemo)(function(){var e={Main:l.Z,Header:l.Z,Body:l.Z};return r&&(e={Main:c.Z,Header:u.Z,Body:d.Z}),e},[r]);return(0,o.jsx)(p.Z,{children:(0,o.jsxs)(w.Main,{expanded:Z,onChange:C,children:[(0,o.jsx)(w.Header,{expandIcon:(0,o.jsx)(h.Z,{}),children:(0,o.jsxs)(l.Z,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,o.jsx)(m.Z,{variant:"h6",children:"QR Code"}),(0,o.jsx)(g,{disabled:s,disableMinWidth:!0,size:"small",color:"info",variant:"contained",onClick:I,sx:y.downloadButton,children:(0,o.jsx)(v.Z,{sx:y.downloadIcon})})]})}),(0,o.jsx)(w.Body,{sx:y.body,children:(0,o.jsx)(l.Z,{id:"qr-".concat(n),alignItems:"center",children:(0,o.jsx)(a.Qd,{bgColor:"#ffffff",fgColor:"#000000",value:t,level:"H",size:256})})})]})})},y={downloadIcon:{height:"17px",width:"17px"},downloadButton:{mr:2},body:{marginTop:"20px"}};b.propTypes={id:r().string,value:r().string,isExpandedByDefault:r().bool,collapsible:r().bool},b.defaultProps={id:"new-qr-code",isExpandedByDefault:!1,collapsible:!0};var Z=b,j=t(93946),C=t(78394),I=function(e){var n=e.id,t=e.value,i=function(e){e.stopPropagation();var t=document.querySelector("#qr-".concat(n," > canvas")).toDataURL(),o=document.createElement("a");o.href=t,o.download="".concat(n,".png"),document.body.appendChild(o),o.click(),document.body.removeChild(o)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(j.Z,{onClick:i,size:"large",sx:{borderRadius:"10px!important",width:"130px"},children:(0,o.jsxs)(l.Z,{alignItems:"center",children:[(0,o.jsx)(C.Z,{sx:{width:"50px",height:"50px"},color:"secondary"}),(0,o.jsx)(m.Z,{children:"Qr Code"})]})}),(0,o.jsx)(l.Z,{id:"qr-".concat(n),alignItems:"center",display:"none",children:(0,o.jsx)(a.Qd,{style:{display:"none"},bgColor:"#ffffff",fgColor:"#000000",value:t,level:"H",size:256})})]})};I.propTypes={id:r().string,value:r().string},I.defaultProps={id:"new-qr-code",isExpandedByDefault:!1,collapsible:!0};var w=t(78566),S=t.n(w),A=t(28842),k=S(),_=function(e){var n=e.id,t=e.value,a=function(e){e.stopPropagation();var t=document.querySelector("#barcode-".concat(n," > svg")).outerHTML,o=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download="".concat(n,".svg"),document.body.appendChild(i),i.click(),document.body.removeChild(i)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(j.Z,{onClick:a,size:"large",sx:{borderRadius:"10px!important",width:"130px"},children:(0,o.jsxs)(l.Z,{alignItems:"center",children:[(0,o.jsx)(A.Z,{sx:{width:"50px",height:"50px"},color:"secondary"}),(0,o.jsx)(m.Z,{children:"Barcode"})]})}),(0,o.jsx)(l.Z,{id:"barcode-".concat(n),alignItems:"center",display:"none",children:(0,o.jsx)(k,{value:"".concat(t),style:{display:"none"}})})]})};_.defaultProps={id:"asset",value:""},_.propTypes={id:r().string.isRequired,value:r().string.isRequired};var q=s.Z,R=function(e){var n=e.id,t=e.value,a=e.expanded,i=e.onChangeExpanded,r=e.collapsible,s=(0,x.a)(),g=function(e){e.stopPropagation();var t=document.querySelector("#barcode-".concat(n," > svg")).outerHTML,o=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download="".concat(n,".svg"),document.body.appendChild(i),i.click(),document.body.removeChild(i)},b=(0,f.useMemo)(function(){var e={Main:l.Z,Header:l.Z,Body:l.Z};return r&&(e={Main:c.Z,Header:u.Z,Body:d.Z}),e},[r]);return(0,o.jsx)(p.Z,{children:(0,o.jsxs)(b.Main,{expanded:a,onChange:i,children:[(0,o.jsx)(b.Header,{expandIcon:(0,o.jsx)(h.Z,{}),children:(0,o.jsxs)(l.Z,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,o.jsx)(m.Z,{variant:"h6",children:"Barcode"}),(0,o.jsx)(q,{disabled:s,disableMinWidth:!0,size:"small",color:"info",variant:"contained",onClick:g,sx:{mr:2},children:(0,o.jsx)(v.Z,{sx:{height:"17px",width:"17px"}})})]})}),(0,o.jsx)(b.Body,{children:(0,o.jsx)(l.Z,{id:"barcode-".concat(n),alignItems:"center",children:(0,o.jsx)(S(),{value:"".concat(t)})})})]})})};R.defaultProps={expanded:!1,onChangeExpanded:function(){},collapsible:!0,id:"asset",value:""},R.propTypes={expanded:r().bool,onChangeExpanded:r().func,collapsible:r().bool,id:r().string.isRequired,value:r().string.isRequired};var M=R},461:function(e,n,t){"use strict";t.d(n,{V:function(){return s},z:function(){return l}});var o=t(7297),a=t(75063);function i(){var e=(0,o.Z)(["\n  mutation CreateCompliance($data: jsonb!) {\n    createCompliance(data: $data) {\n      message\n    }\n  }\n"]);return i=function(){return e},e}function r(){var e=(0,o.Z)(["\n  mutation UpdateCompliance($data: jsonb!) {\n    updateCompliance(data: $data) {\n      message\n    }\n  }\n"]);return r=function(){return e},e}var l=(0,a.Ps)(i()),s=(0,a.Ps)(r())},27913:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return tG}});var o=t(85893),a=t(26042),i=t(69396),r=t(67294),l=t(6812),s=t(11163),c=t.n(s),d=t(5616),u=t(98456),m=t(51233),p=t(61730),h=t(7297),v=t(75063);function x(){var e=(0,h.Z)(["\n  query GetProperty($id: Int!) {\n    location: Location_by_pk(id: $id) {\n      id\n      name\n    }\n  }\n"]);return x=function(){return e},e}var f=(0,v.Ps)(x()),g=t(31220),b=t(83336),y=t(86574),Z=t(86858),j=t(52619),C=function(e){var n=e.propertyId,t=(0,p.Z)("(max-width:600px)"),h=(0,s.useRouter)().query,v=(0,r.useMemo)(function(){return h.tab||"planned-maintenance"},[h.tab]),x=(0,r.useState)(v),C=x[0],w=x[1],S=function(e,n){w(n)},A=(0,l.a)(f,{variables:{id:n}}),k=A.loading,_=A.data,q=(void 0===_?{location:{}}:_).location;if(k)return(0,o.jsx)(m.Z,{height:"100%",width:"100%",justifyContent:"center",alignItems:"center",children:(0,o.jsx)(u.Z,{color:"secondary"})});if(!q)return c().push("/404"),!1;var R={maxWidth:t?"100%":"calc(100vw - 280px)","& .MuiTabs-flexContainer>.MuiTab-root:first-child":(0,a.Z)({},!t&&{borderTopLeftRadius:0,borderBottomLeftRadius:0})};return(0,o.jsxs)(d.Z,{sx:{width:"100%",height:"100%"},children:[(0,o.jsxs)(m.Z,{direction:t?"column":"row",children:[(0,o.jsx)(g.c,{withoutRightBorderRadius:!t,fullWidth:t,locationId:q.id,locationName:q.name}),(0,o.jsx)(b.m,{value:C,onChange:S,changeQuery:!0,sx:R,children:(0,o.jsx)(y.O,{value:"planned-maintenance",label:"Planned Maintenance"})})]}),(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:C,index:"planned-maintenance"},I),{label:"Planned Maintenance",children:(0,o.jsx)(j.A,{locationId:q.id,locationName:q.name,calendarInitialFilters:{filterType:"location_".concat(q.id),locationId:q.id},hideCalendarFilters:["location"],tableInitialFilters:{filterType:"location_".concat(q.id),locationId:q.id},hideTableFilters:["location"],itemsInitialFilters:{locationId:q.id,filterType:"location_".concat(q.id)},hideItemsFilters:["location","complianceCategory"]})}))]})},I={sx:{height:"calc(100% - 32px)"},boxSx:{height:"100%"}},w=t(74944),S=t(24716);function A(){var e=(0,h.Z)(['\n  query GetProperty($id: Int!) {\n    location: Location_by_pk(id: $id) {\n      id\n      access\n      createdAt\n      name\n      contactUserId\n      status\n      meta\n      permitsRequired\n      expenses: Expenses(where: { entity: { _eq: "Location" } }) {\n        id\n        amount\n        description\n        markup\n        total\n        unit\n        vat\n        paid\n        occurredAt\n        recurring\n      }\n      addresses: Addresses(order_by: { id: asc }, where: { entity: { _eq: "Location" } }) {\n        id\n        registered\n        operating\n        trading\n        invoice\n        status\n        createdAt\n        address: Address {\n          id\n          name\n          addressLine1\n          addressLine2\n          addressLine3\n          city\n          county\n          geo\n          postCode\n          country: Country {\n            id\n            name\n            code\n          }\n        }\n      }\n      bookings: Jobs {\n        id\n        title\n        createdAt\n        customerId\n        amount\n        locationId\n        managerId\n        quoteNumber\n        reference\n        status\n        serviceId\n        meta\n        customer: Customer {\n          id\n          name\n        }\n        location: Location {\n          id\n          name\n          addresses: Addresses(where: { entity: { _eq: "Location" } }) {\n            id\n            registered\n            operating\n            trading\n            invoice\n            status\n            createdAt\n            address: Address {\n              id\n              name\n              addressLine1\n              addressLine2\n              addressLine3\n              city\n              county\n              geo\n              postCode\n              country: Country {\n                id\n                name\n              }\n            }\n          }\n        }\n        manager: Manager {\n          id\n          nameFirst\n          nameLast\n        }\n        sla: SLA {\n          id\n          name\n          notes\n        }\n        supplier: Supplier {\n          id\n          companyNumber\n          createdAt\n          name\n          status\n          type\n          updatedAt\n          website\n          clientType\n          managerId\n          vatId\n          meta\n          media: Media {\n            id\n            medium: Medium {\n              id\n              category\n              filename\n              meta\n              type\n            }\n          }\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n        supplierOffers: SupplierOffers {\n          status\n          rate\n          supplier: Supplier {\n            id\n            companyNumber\n            createdAt\n            name\n            status\n            type\n            updatedAt\n            website\n            clientType\n            managerId\n            vatId\n            meta\n            media: Media {\n              id\n              medium: Medium {\n                id\n                category\n                filename\n                meta\n                type\n              }\n            }\n            manager: Manager {\n              id\n              fullName\n            }\n          }\n        }\n        timings: JobTimings {\n          id\n          status\n          createdAt\n        }\n      }\n      customer: Account_Locations(where: { Account: { type: { _eq: "customer" } } }) {\n        account: Account {\n          id\n          companyNumber\n          createdAt\n          name\n          status\n          type\n          updatedAt\n          website\n          clientType\n          managerId\n          vatId\n          meta\n\n          media: Media {\n            id\n            medium: Medium {\n              id\n              category\n              filename\n              meta\n              type\n            }\n          }\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n      }\n      supplier: Account_Locations(where: { Account: { type: { _eq: "supplier" } } }) {\n        id\n        account: Account {\n          id\n          companyNumber\n          createdAt\n          name\n          status\n          type\n          updatedAt\n          website\n          clientType\n          managerId\n          vatId\n          meta\n          media: Media {\n            id\n            medium: Medium {\n              id\n              category\n              filename\n              meta\n              type\n            }\n          }\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n      }\n      user: User {\n        id\n        name: nameFirst\n        nameFirst\n        nameLast\n        phone\n        status\n        email\n        createdAt\n        fullName\n        accounts: Account_Users {\n          id\n          role\n          position\n          isContact\n          status\n          account: Account {\n            id\n            name\n            type\n          }\n        }\n      }\n      assets: Assets {\n        id\n        name\n        manufacturer\n        model\n        serialNumber\n        createdAt\n        customer: Account {\n          id\n          name\n          type\n        }\n        location: Location {\n          id\n          name\n        }\n      }\n    }\n  }\n']);return A=function(){return e},e}var k=(0,v.Ps)(A()),_=t(47568),q=t(97582),R=t(19192),M=t(98209),T=t(26535),N=t(81777),P=t(74280),D=t(56236),F=t(19611),L=t(32725),E=t(11585),$=t(41890),O=t(30381),W=t.n(O),B=t(32791),H=function(e){var n,t,a,i,r,l,s=e.property,d=e.offCanvas,u=e.refetch,m="/dashboard/properties/",p=(0,T.WE)(s,"registered"),h=(0,T.WE)(s,"invoice"),v=function(e){e&&u()};return[{id:1,label:"Create location",date:s.createdAt,content:[{id:1,active:s.createdAt&&s.name,data:"Name: ".concat(s.name)},{id:2,active:s.createdAt,data:"Access: ".concat(s.access)}]},{id:2,label:"Complete profile",info:"",date:(null==p?void 0:p.createdAt)||null,actions:[{id:1,active:!0,content:"Main address",context:"secondary",handleClick:function(){var e;d.show({content:(0,o.jsx)(B.H,{addressId:(null==p?void 0:null===(e=p.address)||void 0===e?void 0:e.id)||null,entity:"Location",entityId:s.id,id:(null==p?void 0:p.id)||null,onSubmit:v,type:"registered"}),submit:!1,title:"Manage addresses"})},type:"button"},{id:2,active:!0,content:"Invoice address",context:"secondary",handleClick:function(){var e;d.show({content:(0,o.jsx)(B.H,{addressId:(null==h?void 0:null===(e=h.address)||void 0===e?void 0:e.id)||null,entity:"Location",entityId:s.id,id:(null==h?void 0:h.id)||null,onSubmit:v,type:"invoice"}),submit:!1,title:"Manage addresses"})},type:"button"}]},{id:3,label:"Add assets",info:"",date:(null===(n=s.assets)||void 0===n?void 0:n.length)?s.assets[0].createdAt:null,content:[{id:1,active:(null===(t=s.assets)||void 0===t?void 0:t.length)>0,data:"".concat(null===(a=s.assets)||void 0===a?void 0:a.length," assets added")}],actions:[{id:1,active:!0,content:"Submit sublocations",context:"secondary",handleClick:function(){c().push("".concat(m,"view?id=").concat(s.id,"&tab=assets"))},type:"button"},{id:2,active:!0,content:"Submit products",context:"secondary",handleClick:function(){c().push("".concat(m,"view?id=").concat(s.id,"&tab=assets"))},type:"button"},{id:3,active:!0,content:"Submit sensors",context:"secondary",handleClick:function(){c().push("".concat(m,"view?id=").concat(s.id,"&tab=assets"))},type:"button"}]},{id:6,label:"Start issuing work orders",info:"submit work orders",date:(null===(i=s.bookings)||void 0===i?void 0:i.length)?s.bookings[0].createdAt:null,content:[{id:1,active:(null===(r=s.assets)||void 0===r?void 0:r.length)>0,data:"".concat(null===(l=s.assets)||void 0===l?void 0:l.length," jobs created")}]}]},Y=function(e,n,t){var o=H({property:e,offCanvas:n,refetch:t});return o.forEach(function(e){e.date&&(e.date=W()(e.date).format("D MMM YYYY HH:mm"))}),o},V=t(74492),U=function(e){var n=e.location,t=e.refetch,a=(0,V.a)();return(0,o.jsx)(E.Z,{open:!0,title:"Profile",children:(0,o.jsx)($.Z,{items:Y(n,a,t),summary:[]},"stepper-".concat(n.id))})},z=t(97637),Q=t(23789),G=t(53767),J=t(78067),X=function(e){var n,t,a,i,l,c,d,u,p,h,v=e.location,x=e.refetch,f=(0,G.q)(),g=(0,V.a)(),b=(0,w.x)(),y=b.user,Z=b.hasRole,j=(0,s.useRouter)().query,C=(0,r.useState)([]),I=C[0],S=C[1],A=(0,r.useState)(!1),k=A[0],E=A[1],$=(0,R.RM)(y.accountId),O=Z("tenant"),W="".concat(M.C1.issueReportUrl,"?locationId=").concat(v.id,"&locationName=").concat(v.name,"&customerId=").concat(null===(n=v.customer[0])||void 0===n?void 0:n.account.id),B=(0,R.BR)({adminId:y.id,xeroClientId:null==j?void 0:j.clientId},[f.admin]),H=B.onCallAuthorize,Y=B.onGetXeroContacts;(0,r.useEffect)(function(){var e,n=(e=(0,_.Z)(function(e){var n,t;return(0,q.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Y(e)];case 1:return t=n.sent().map(function(e){return{label:"".concat(e.name," - ").concat(e.contactID),value:e.contactID}}),E(!1),S(t),[3,3];case 2:return n.sent(),E(!0),[3,3];case 3:return[2]}})}),function(n){return e.apply(this,arguments)});(null==$?void 0:$.companyId)&&n($.companyId)},[null==$?void 0:$.companyId]);var X,K=v.createdAt,ee=v.customer,en=v.id,et=v.supplier,eo=v.user,ea=(0,T.WE)(v,"registered"),ei=(0,T.WE)(v,"invoice"),er=function(){H(window.location.href)},el=function(e){var n,t,a,i;e.stopPropagation(),g.show({content:(0,o.jsx)(J.m,{data:v,refetch:x,xeroContactId:null===(n=v.customer)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:null===(a=t.account)||void 0===a?void 0:null===(i=a.meta)||void 0===i?void 0:i.xeroContactId,displayXeroContacts:!!(null==$?void 0:$.clientId),xeroContacts:I,displaySignin:k,handleXeroAuthorize:er,onClose:g.close}),title:"Edit property"})};return(0,o.jsxs)(m.Z,{direction:"row",spacing:4,width:"100%",children:[(0,o.jsxs)(m.Z,{sx:{flex:1},children:[(0,o.jsx)(N.g,{avatar:(0,P.Q)(null===(t=v.customer[0].account)||void 0===t?void 0:t.media),entity:{id:v.id,description:v.customer[0].account.name,name:v.name||"Not Specified"},entityName:"Location",icons:O?[]:[{icon:"edit",onClick:el}]}),(0,o.jsx)("div",{children:(0,o.jsx)(D.J,{data:{accountName:ee.length&&ee[0].account.name||et.length&&et[0].account.name,country:null==ea?void 0:null===(a=ea.address)||void 0===a?void 0:null===(i=a.country)||void 0===i?void 0:i.name,createdAt:K,fullName:null==eo?void 0:eo.fullName,position:null==eo?void 0:eo.position,phone:null==eo?void 0:eo.phone,permitsRequired:null==v?void 0:v.permitsRequired,xeroContactId:null===(l=v.customer)||void 0===l?void 0:null===(c=l[0])||void 0===c?void 0:null===(d=c.account)||void 0===d?void 0:null===(u=d.meta)||void 0===u?void 0:u.xeroContactId}})}),ea&&(0,o.jsx)("div",{children:(0,o.jsx)(F.f,{address:ea.address,entity:"Location",entityId:v.id,id:ea.id,refetch:x,showMap:!0,title:"Address",type:"registered"})}),ei&&(0,o.jsx)("div",{children:(0,o.jsx)(F.f,{address:ei.address,entity:"Location",entityId:v.id,id:ei.id,refetch:x,title:"Invoice Address",type:"invoice"})}),Z("admin")&&(0,o.jsxs)("div",{children:[" ",(0,o.jsx)(L.E,{entity:"Location",entityId:v.id,open:!0,title:"Notes"})]})]}),!O&&(0,o.jsx)(m.Z,{sx:{flex:1},children:(0,o.jsxs)("div",{children:[" ",(0,o.jsx)(U,{refetch:x,location:v})]})}),(0,o.jsxs)(m.Z,{sx:{flex:1},children:[(0,o.jsx)("div",{children:(0,o.jsx)(z.G,{details:!0,entity:"Location",entityId:en,showActionButtons:!O})}),!O&&(0,o.jsx)("div",{}),(null==f?void 0:null===(p=f.admin)||void 0===p?void 0:null===(h=p.modules)||void 0===h?void 0:h.nonLoggedUser)&&(0,o.jsxs)("div",{children:[" ",(0,o.jsx)(Q.UH,{id:"location-qr-".concat(v.id),value:W,isExpandedByDefault:!0})]})]})]})},K=t(39453),ee=function(e){var n,t,a,i,r,l,s,c=e.location,d=e.refetch;return(0,o.jsx)(K.b,{type:"customer",accountId:null===(n=c.customer[0])||void 0===n?void 0:null===(t=n.account)||void 0===t?void 0:t.id,accountName:null===(a=c.customer[0])||void 0===a?void 0:null===(i=a.account)||void 0===i?void 0:i.name,locationId:c.id,meta:null!==(s=null===(r=null==c?void 0:c.customer[0])||void 0===r?void 0:null===(l=r.account)||void 0===l?void 0:l.meta)&&void 0!==s?s:{},accountRefetch:d})},en=t(29815),et=t(45697),eo=t.n(et),ea=t(42283),ei=t(90629),er=t(15861),el=t(11057),es=t(45451),ec=t(83162),ed=t(18531),eu=t(828),em=t(79665),ep=t(50319),eh=t(76600),ev=t(55563),ex=t(49501),ef=t(95103),eg=t(6710),eb=t(15897),ey=t(16310),eZ=ey.Ry({id:ey.Rx(),name:ey.Z_(),description:ey.Z_(),active:ey.Z_().oneOf(["active","inactive"]).required(),locationId:ey.Rx().required(),customerId:ey.Rx().required()});function ej(){var e=(0,h.Z)(["\n  query GetSublocations($locationId: Int!, $active: Boolean, $limit: Int = 50, $offset: Int = 0) {\n    sublocations: Sublocation(\n      where: { locationId: { _eq: $locationId }, active: { _eq: $active } }\n    ) {\n      id\n      name\n      description\n      active\n      createdAt\n      updatedAt\n      location: Location {\n        id\n        name\n      }\n    }\n    meta: Sublocation_aggregate(where: { locationId: { _eq: $locationId } }) {\n      aggregate {\n        count\n      }\n    }\n  }\n"]);return ej=function(){return e},e}function eC(){var e=(0,h.Z)(['\n  query GetSublocationDataForQrCode($locationId: Int!) {\n    sublocation: Sublocation(where: { locationId: { _eq: $locationId }, active: { _eq: true } }) {\n      id\n      name\n      location: Location {\n        id\n        name\n        customer: Account_Locations(where: { Account: { type: { _eq: "customer" } } }) {\n          account: Account {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n']);return eC=function(){return e},e}function eI(){var e=(0,h.Z)(["\n  mutation UpsertSublocation($objects: [Sublocation_insert_input!]!) {\n    insert_Sublocation(\n      objects: $objects\n      on_conflict: {\n        constraint: Sublocation_pkey\n        update_columns: [name, description, active, locationId]\n      }\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return eI=function(){return e},e}var ew=(0,v.Ps)(ej()),eS=(0,v.Ps)(eC()),eA=(0,v.Ps)(eI()),ek=function(e){var n=e.defaultValues,t=e.offCanvas,r=(0,ea.cI)({defaultValues:n,resolver:(0,em.S)(eZ)}),l=r.control,s=r.errors,c=r.register,m=r.handleSubmit,p=(0,eu.Z)((0,ep.D)(eA,{refetchQueries:["GetSublocations"],onCompleted:function(){t&&t.close()}}),2),h=p[0],v=p[1].loading,x=function(e){var n=(0,i.Z)((0,a.Z)({},e),{active:"active"===e.active});delete n.customerId,h({variables:{objects:[n]}})},f={control:l,errors:s,register:c};return v?(0,o.jsx)(d.Z,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,o.jsx)(u.Z,{})}):(0,o.jsxs)(eh.Z,{id:"offCanvasForm",handleSubmit:m(x),children:[n.id&&(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},f),{name:"id",type:"hidden"})),(0,o.jsx)(ex.Z,{label:"Customer",children:(0,o.jsx)(ef.Z,(0,i.Z)((0,a.Z)({},f),{name:"customerId",options:n.customerOptions}))}),(0,o.jsx)(ex.Z,{label:"Property",children:(0,o.jsx)(ef.Z,(0,i.Z)((0,a.Z)({},f),{name:"locationId",options:n.locationOptions}))}),(0,o.jsx)(ex.Z,{label:"Name",children:(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},f),{name:"name"}))}),(0,o.jsx)(ex.Z,{label:"Description",children:(0,o.jsx)(eg.Z,(0,i.Z)((0,a.Z)({},f),{name:"description",rows:3}))}),(0,o.jsx)(ex.Z,{label:"Status",children:(0,o.jsx)(ef.Z,(0,i.Z)((0,a.Z)({},f),{name:"active",options:eb.bg}))})]})};ek.defaultProps={defaultValues:{}},ek.propTypes={defaultValues:eo().shape({id:eo().number,locationId:eo().number.isRequired,customerId:eo().number.isRequired,locationOptions:eo().shape({text:eo().string.isRequired,value:eo().number.isRequired}).isRequired,customerOptions:eo().shape({text:eo().string.isRequired,value:eo().number.isRequired}).isRequired,name:eo().string,description:eo().string,status:eo().oneOf(["active","inactive"])})};var e_=t(34187),eq=t(12632),eR=t(21830),eM=function(e){var n=e.locationId,t=(0,l.a)(eS,{variables:{locationId:n}}),a=t.data,i=(void 0===a?{sublocation:[]}:a).sublocation,s=t.loading,c=(0,r.useMemo)(function(){var e,n,t,o,a,r,l,c=null!==(l=null==i?void 0:i[0])&&void 0!==l?l:{};return c&&!s?"".concat(M.C1.issueReportUrl,"?locationId=").concat(null==c?void 0:null===(e=c.location)||void 0===e?void 0:e.id,"&locationName=").concat(null==c?void 0:null===(n=c.location)||void 0===n?void 0:n.name,"&sublocationId=").concat(c.id,"&sublocationName=").concat(c.name,"&customerId=").concat(null==c?void 0:null===(t=c.location)||void 0===t?void 0:null===(o=t.customer)||void 0===o?void 0:o[0].account.id,"&customerName=").concat(null==c?void 0:null===(a=c.location)||void 0===a?void 0:null===(r=a.customer)||void 0===r?void 0:r[0].account.name):""},[s,i]);return(0,o.jsx)(m.Z,{children:(0,o.jsx)(Q.UH,{id:"new-firstSublocation-qr-".concat(n),value:c,collapsible:!1})})};eM.propTypes={locationId:eo().string},eM.defaultProps={};var eT=function(e){var n,t=e.location,s=e.customer,c=(0,r.useRef)(),d=(0,V.a)(),u=(0,G.q)(),p=(0,w.x)().hasRole,h=p("tenant"),v=(0,ea.cI)({defaultValues:{status:{label:"Active",value:"active"}}}),x=v.control,f=v.watch,g=(0,r.useState)({active:!0}),b=g[0],y=g[1],Z=(0,eq.x)({filters:b}).initialData,j=f("status"),C=(0,l.a)(ew,{variables:(0,i.Z)((0,a.Z)({},Z),{locationId:t.id})}),I=C.data,S=void 0===I?{sublocations:[],meta:{aggregate:{totalCount:0}}}:I,A=S.sublocations,k=S.meta,_=C.loading,q=C.refetch;(0,r.useEffect)(function(){y({active:(null==j?void 0:j.value)==="active"})},[null==j?void 0:j.value]);var R=function(e){e.stopPropagation();var n={customerOptions:[{value:s.id,text:s.name}],locationOptions:[{value:t.id,text:t.name}],customerId:s.id,locationId:t.id};d.show({content:(0,o.jsx)(ek,{defaultValues:n,offCanvas:d}),title:"Add sublocation"})},M=function(e,n){e.stopPropagation();var a={id:n.id,name:n.name,description:n.description,active:n.item.active?"active":"inactive",customerOptions:[{value:s.id,text:s.name}],locationOptions:[{value:t.id,text:t.name}],customerId:s.id,locationId:t.id};d.show({content:(0,o.jsx)(ek,{defaultValues:a,offCanvas:d}),title:"Edit sublocation"})},T=function(e){e.stopPropagation(),d.show({content:(0,o.jsx)(eM,{locationId:t.id}),title:"Sublocation info",submit:!1})},N=function(e){var n,t;return(0,en.Z)(p("tenant")?[]:[{context:"secondary",icon:"edit",onClick:function(n){return M(n,e)},tooltip:"Edit"}]).concat((0,en.Z)((null==u?void 0:null===(n=u.admin)||void 0===n?void 0:null===(t=n.modules)||void 0===t?void 0:t.nonLoggedUser)?[{context:"secondary",icon:"info",onClick:T,tooltip:"Info"}]:[]))},P=function(){return A.map(function(e){return{name:e.name,locationName:e.location.name,description:e.description,status:e.active?"Active":"Inactive",actions:"",id:e.id,locationId:e.location.id,item:e}})};return(0,o.jsxs)(m.Z,{width:"100%",spacing:2,sx:{height:"100%"},children:[(0,o.jsxs)(m.Z,{width:"100%",direction:"row",justifyContent:"space-between",children:[(0,o.jsx)(ea.Qr,{name:"status",control:x,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(ed.q,{value:n,disableClearable:!0,textFieldProps:{color:"secondary",variant:"standard",label:"Select status"},sx:{width:"200px"},onChange:function(e,n){return t(n)},options:[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}]})}}),!p("tenant")&&(0,o.jsx)(el.Z,{variant:"contained",color:"secondary",onClick:R,children:"Create Sublocation"})]}),(0,o.jsxs)(ei.Z,{sx:{padding:"16px 0px",height:"calc(90vh - 52px)"},children:[(0,o.jsx)(er.Z,{ml:2,variant:"h5",sx:{fontWeight:600,marginBottom:"15px"},children:"Sublocations"}),(null===(n=P())||void 0===n?void 0:n.length)?(0,o.jsx)(es.i,{ref:c,loading:_,columns:[{headerName:"Name",field:"name",flex:1},{headerName:"Location",field:"locationName",flex:1,minWidth:200,renderCell:function(e){var n=e.row;return(0,o.jsx)(ec.r,{color:"secondary",noWrap:!(null==n?void 0:n.locationId),children:(null==n?void 0:n.locationName)||"-"})}},{headerName:"Description",field:"description",flex:1},{headerName:"Status",field:"status",flex:1},{headerName:"Actions",field:"actions",flex:1,renderCell:function(e){var n=e.row;return(0,o.jsx)(eR.C,{row:n,actionsData:N})}}],rows:P(),meta:k,refetch:q,autoHeight:!1,containerHeight:"calc(100% - 52px)"}):!_&&(0,o.jsx)(e_.C,{imageSrc:"/static/icons/no_locations_found.svg",title:"No sublocations",subtitleFirstLine:"You currently have no sublocations set up in the system",subtitleSecondLine:"Click\xa0create sublocation\xa0to get started building.",buttonText:h?null:"Create sublocation",onAction:h?null:R})]})]})};eT.defaultProps={customer:{},location:{}},eT.propTypes={customer:eo().object.isRequired,location:eo().object.isRequired};var eN=t(49408),eP=t(21913),eD=t(53371),eF=t(246),eL=t(66267),eE=t(43427),e$=t(15487),eO=t(14924);function eW(){var e=(0,h.Z)(['\n  query GetTenantBookings(\n    $limit: Int\n    $locationId: Int\n    $offset: Int\n    $orderBy: TenantBooking_order_by!\n    $q: Int\n    $userId: Int\n  ) {\n    tenantBookings: TenantBooking(\n      limit: $limit\n      offset: $offset\n      where: { id: { _eq: $q }, locationId: { _eq: $locationId }, userId: { _eq: $userId } }\n      order_by: [$orderBy]\n    ) {\n      id\n      bookingStart\n      bookingEnd\n      notes\n      status\n      createdAt\n      location: Location {\n        id\n        name\n        customer: Account_Locations {\n          id\n          account: Account {\n            id\n            name\n            admin: Admins {\n              id: adminId\n            }\n            manager: Manager {\n              id\n              fullName\n            }\n            contactUsers: Account_Users(where: { isContact: { _eq: true } }) {\n              id\n              user: User {\n                id\n                fullName\n              }\n            }\n          }\n        }\n      }\n      user: User {\n        id\n        fullName\n        email\n        phone\n        accountUsers: Account_Users(where: { Account: { type: { _eq: "tenant" } } }) {\n          id\n          accountId\n          modules\n        }\n      }\n    }\n    meta: TenantBooking_aggregate(\n      where: { id: { _eq: $q }, locationId: { _eq: $locationId }, userId: { _eq: $userId } }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']);return eW=function(){return e},e}var eB=(0,v.Ps)(eW());function eH(){var e=(0,h.Z)(["\n  mutation AddTenantBooking(\n    $nameFirst: String\n    $nameLast: String\n    $email: String\n    $phone: String\n    $bookingStart: timestamptz\n    $bookingEnd: timestamptz\n    $notes: String\n    $status: String\n    $locationId: Int!\n    $userId: Int\n    $modules: jsonb\n  ) {\n    createTenant(\n      nameFirst: $nameFirst\n      nameLast: $nameLast\n      email: $email\n      phone: $phone\n      bookingStart: $bookingStart\n      bookingEnd: $bookingEnd\n      notes: $notes\n      status: $status\n      locationId: $locationId\n      userId: $userId\n      modules: $modules\n    ) {\n      data\n      success\n    }\n  }\n"]);return eH=function(){return e},e}function eY(){var e=(0,h.Z)(['\n  mutation UpdateTenantBooking(\n    $id: Int!\n    $changes: TenantBooking_set_input\n    $userId: Int!\n    $accountUser: Account_User_set_input\n  ) {\n    update_TenantBooking_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n    update_Account_User(\n      where: { userId: { _eq: $userId }, Account: { type: { _eq: "tenant" } } }\n      _set: $accountUser\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n']);return eY=function(){return e},e}function eV(){var e=(0,h.Z)(["\n  mutation DeleteTenantBooking($id: Int!) {\n    delete_TenantBooking_by_pk(id: $id) {\n      id\n    }\n  }\n"]);return eV=function(){return e},e}var eU=(0,v.Ps)(eH()),ez=(0,v.Ps)(eY());(0,v.Ps)(eV());var eQ=t(78289),eG=t(68956),eJ=t(26186),eX=t(77439),eK=t(87336),e0=t(9270),e1=t(62140),e2=t(40552),e3=t(536),e4=(0,ey.Ry)().shape({bookingStart:(0,ey.hT)(),bookingEnd:(0,ey.hT)().nullable(),notes:(0,ey.Z_)(),status:(0,ey.Z_)().oneOf(["active","inactive"]).required()}),e6=t(50480),e9=t(69368),e5=function(e){var n=e.name,t=e.control,a=e.permissions,i=e.styles;return(0,o.jsxs)(d.Z,{sx:i,children:[(0,o.jsx)(er.Z,{variant:"h6",color:"dark.main",sx:{fontFamily:"Arial, sans-serif, sans-serif",fontWeight:"normal"},children:"Permissions"}),(0,o.jsx)(m.Z,{spacing:1,direction:"row",children:a.map(function(e){return(0,o.jsx)(ea.Qr,{name:"".concat(n?n+".":"").concat(e.name),control:t,render:function(n){var t=n.value,a=n.onChange;return(0,o.jsx)(e6.Z,{color:"dark.main",control:(0,o.jsx)(e9.Z,{color:"secondary",checked:t,onChange:function(e){return a(e.target.checked)}}),label:e.label})}})})})]})};e5.defaultProps={permissions:[]},e5.propTypes={name:et.string,control:et.object.isRequired,permissions:et.object,styles:et.object};var e8=[{label:"Job reports",name:"jobReports"},{label:"Quotes",name:"quotes"},{label:"Finances",name:"finances"}],e7=function(e){var n,t,l,s=e.defaultValues,c=e.submit,d=(0,r.useState)(!1),u=d[0],m=d[1],p=(0,ea.cI)({defaultValues:s&&s,resolver:(0,em.S)(e4)}),h=p.control,v=p.errors,x=p.handleSubmit,f=p.register,g=p.watch,b={control:h,errors:v,register:f},y=g("tenantSelected");return(0,o.jsxs)(eh.Z,{id:"offCanvasForm",handleSubmit:x(c),children:[(0,o.jsx)(E.Z,{open:!0,title:"Tenant information",children:u?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(e0.Z,{children:[(0,o.jsx)(e1.Z,{md:6,children:(0,o.jsx)(ex.Z,{label:"First name",children:(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},b),{name:"nameFirst"}))})}),(0,o.jsx)(e1.Z,{md:6,children:(0,o.jsx)(ex.Z,{label:"Last name",children:(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},b),{name:"nameLast"}))})}),(0,o.jsx)(e1.Z,{md:6,children:(0,o.jsx)(ex.Z,{label:"Email",children:(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},b),{name:"email",type:"email"}))})}),(0,o.jsx)(e1.Z,{md:6,children:(0,o.jsx)(ex.Z,{label:"Mobile",children:(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},b),{name:"phone"}))})})]}),(0,o.jsx)(eX.Z,{content:"Cancel",context:"secondary",onClick:function(){return m(!1)},size:"sm"})]}):(null==s?void 0:s.id)?(0,o.jsxs)("div",{children:[null==s?void 0:null===(n=s.user)||void 0===n?void 0:n.fullName," ",(0,o.jsx)("br",{}),null==s?void 0:null===(t=s.user)||void 0===t?void 0:t.email," ",(0,o.jsx)("br",{}),null==s?void 0:null===(l=s.user)||void 0===l?void 0:l.phone," ",(0,o.jsx)("br",{})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e3.P,(0,i.Z)((0,a.Z)({},b),{errors:(0,a.Z)({},v),label:"Tenant",name:"tenantSelected",type:"tenant"})),y&&(0,o.jsxs)("div",{children:[y.label," ",(0,o.jsx)("br",{}),y.email," ",(0,o.jsx)("br",{}),y.phone," ",(0,o.jsx)("br",{}),(0,o.jsx)("br",{})]}),"or"," ",(0,o.jsx)(eX.Z,{content:"Add new tenant",context:"secondary",onClick:function(){return m(!0)},size:"sm"})]})}),(0,o.jsxs)(E.Z,{open:!0,title:"Booking information",children:[(0,o.jsxs)(e0.Z,{children:[(0,o.jsxs)(e1.Z,{md:6,children:[(0,o.jsx)(ex.Z,{label:"Booked from"}),(0,o.jsx)(e2.M,(0,i.Z)((0,a.Z)({},b),{name:"bookingStart",placeholderText:"Click to select date"}))]}),(0,o.jsxs)(e1.Z,{md:6,children:[(0,o.jsx)(ex.Z,{label:"Booked to"}),(0,o.jsx)(e2.M,(0,i.Z)((0,a.Z)({},b),{name:"bookingEnd",placeholderText:"Click to select date"}))]})]}),(0,o.jsx)(ex.Z,{label:"Notes",children:(0,o.jsx)(eg.Z,(0,i.Z)((0,a.Z)({},b),{name:"notes",rows:3}))}),(0,o.jsx)(ex.Z,{label:"Status",children:(0,o.jsx)(ef.Z,(0,i.Z)((0,a.Z)({},b),{name:"status",options:eb.bg}))})]}),(0,o.jsx)(e5,{name:"modules",control:h,permissions:e8,styles:{mb:2}}),(null==s?void 0:s.id)&&(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},b),{name:"id",type:"hidden"})),(null==s?void 0:s.userId)&&(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},b),{name:"userId",type:"hidden"})),(null==s?void 0:s.locationId)&&(0,o.jsx)(ev.Z,(0,i.Z)((0,a.Z)({},b),{name:"locationId",type:"hidden"}))]})};e7.propTypes={defaultValues:et.object,submit:et.func.isRequired};var ne=function(e,n){var t,o,a={id:(null==e?void 0:e.id)||null,bookingStart:(null==e?void 0:e.bookingStart)?new Date(e.bookingStart):null,bookingEnd:(null==e?void 0:e.bookingEnd)?new Date(e.bookingEnd):null,notes:(null==e?void 0:e.notes)||"",locationId:n,status:(null==e?void 0:e.status)||"active"};return(null==e?void 0:e.id)&&(null==e?void 0:e.user)?(a.user={id:e.user.id,fullName:e.user.fullName,email:e.user.email,phone:e.user.phone},a.userId=e.user.id,a.modules=(null===(t=e.user.accountUsers)||void 0===t?void 0:null===(o=t[0])||void 0===o?void 0:o.modules)||{}):(a.email="",a.nameFirst="",a.nameLast="",a.phone=""),a},nn=function(e){var n,t,s,c=e.filters,d=(0,r.useRef)(),u=(0,r.useContext)(eQ.Z),m=c.locationId,p=(0,l.a)(eB,{variables:(0,i.Z)((0,a.Z)({},c),{limit:M.C1.paginationSize,offset:((null===(n=d.current)||void 0===n?void 0:n.currentPage)-1||0)*M.C1.paginationSize,orderBy:(0,eO.Z)({},null===(t=d.current)||void 0===t?void 0:t.sort.item,null===(s=d.current)||void 0===s?void 0:s.sort.order)})}),h=p.data,v=void 0===h?{tenantBookings:[],meta:{aggregate:{totalCount:0}}}:h,x=v.tenantBookings,f=v.meta,g=p.loading,b=p.refetch,y=(0,eu.Z)((0,ep.D)(eU,{onCompleted:function(e){u.close(),b()}}),1)[0],Z=(0,eu.Z)((0,ep.D)(ez,{onCompleted:function(e){u.close(),b()}}),1)[0],j=function(e){e.id?Z({variables:{id:e.id,changes:{bookingStart:e.bookingStart,bookingEnd:e.bookingEnd,notes:e.notes,status:e.status},userId:e.userId,accountUser:{modules:e.modules}}}):y({variables:{nameFirst:e.nameFirst,nameLast:e.nameLast,email:e.email,phone:e.phone,bookingStart:e.bookingStart,bookingEnd:e.bookingEnd,notes:e.notes,status:e.status,locationId:e.locationId,userId:e.userId,modules:e.modules}})},C=function(e,n){e.stopPropagation();var t=ne(x.find(function(e){return e.id===(null==n?void 0:n.id)}),m);u.show({title:n?"Edit tenant":"Add tenant",content:(0,o.jsx)(e7,{defaultValues:t,submit:j})})},I=[{text:"ID"},{text:"Tenant"},{text:"Email Address"},{text:"Booked from"},{text:"Booked to"},{text:"Status"},{text:"Date Added",sortable:!0,sortName:"createdAt"},{formatter:eG.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:C,tooltip:"Edit"}],text:"Actions"},{hidden:!0}];return(0,o.jsx)(E.Z,{fitParentHeight:!0,open:!0,title:"Tenant bookings",toolbar:m&&(0,o.jsx)(eX.Z,{content:"Add tenant",context:"secondary",onClick:C,size:"sm"}),children:(0,o.jsx)(eK.t,{columns:I,loading:g,meta:f,ref:d,refetch:b,rows:x.map(function(e){var n=null==e?void 0:e.user;return{id:e.id,name:null==n?void 0:n.fullName,email:null==n?void 0:n.email,bookingStart:e.bookingStart,bookingEnd:e.bookingEnd?e.bookingEnd:"-",status:"active"===e.status?"Active":"Inactive",createdAt:(0,eJ.Z)(e.createdAt),actions:"",locationId:e.locationId}})})})};nn.propTypes={filters:et.object};var nt=t(90948),no=t(3892),na=t(40044),ni=t(87918),nr=t(29059),nl=t(24572),ns=t(66252);function nc(){var e=(0,h.Z)(['\n  query GetCompliances(\n    $where: Compliance_bool_exp\n    $order: [Compliance_order_by!]\n    $limit: Int\n    $offset: Int\n  ) {\n    compliances: Compliance(where: $where, limit: $limit, offset: $offset, order_by: $order) {\n      id\n      name\n      registeredNumber\n      repeat\n      expiryDate\n      lastCompleted\n      previousExpiryDates\n      status\n      createdAt\n      updatedAt\n      location: Location {\n        id\n        name\n      }\n      sublocation: Sublocation {\n        id\n        name\n      }\n      assetCategory: AssetCategory {\n        id\n        name\n      }\n      complianceCategory: ComplianceCategory {\n        id\n        name\n      }\n      parentCompliance: ParentCompliance {\n        id\n        name\n      }\n      assets: Assets(where: { entity: { _eq: "Compliance" } }) {\n        id\n        entity\n        entityId\n        assetId\n        asset: Asset {\n          id\n          name\n        }\n      }\n      jobs: Jobs(where: { timingStart: { _gte: "now()" } }, order_by: { timingStart: asc }) {\n        id\n        number\n        status\n        shortJobDesc: Taxonomy(where: { Taxonomy: { type: { _eq: "jobTags" } } }) {\n          id\n          taxonomyId\n          comments\n          taxonomy: Taxonomy {\n            name\n            meta\n          }\n        }\n      }\n      jobTotal: Jobs_aggregate {\n        aggregate {\n          count\n        }\n      }\n    }\n    meta: Compliance_aggregate(where: $where) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']);return nc=function(){return e},e}function nd(){var e=(0,h.Z)(["\n  query GetCompliancesFromSettings(\n    $where: Compliance_bool_exp\n    $order: [Compliance_order_by!]\n    $limit: Int\n    $offset: Int\n  ) {\n    compliances: Compliance(where: $where, limit: $limit, offset: $offset, order_by: $order) {\n      id\n      name\n      status\n      createdAt\n      updatedAt\n      complianceCategory: ComplianceCategory {\n        id\n        name\n      }\n    }\n    meta: Compliance_aggregate(where: $where) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]);return nd=function(){return e},e}var nu=(0,v.Ps)(nc());(0,v.Ps)(nd());var nm=t(6775),np=t(59505),nh=function(e,n){var t=W()(),o=W()(e);switch(n){case"Weekly":if(t.isAfter(o))return"warning";if(t.isAfter(o.clone().subtract(2,"days")))return"warning";if(t.isAfter(o.clone().subtract(4,"days")))return"info";return"success";case"Monthly":if(t.isAfter(o))return"warning";if(t.isAfter(o.clone().subtract(5,"days")))return"warning";if(t.isAfter(o.clone().subtract(10,"days")))return"info";return"success";case"Quarterly":case"Annually":case"Every 5 years":if(t.isAfter(o))return"warning";if(t.isAfter(o.clone().subtract(5,"days")))return"warning";if(t.isAfter(o.clone().subtract(30,"days")))return"info";return"success";default:throw Error("Unsupported frequency")}},nv=t(8842),nx=t(25267),nf=t(71181),ng=function(e){var n=e.locationId,t=e.q,o=e.complianceCategory,r=e.parentCompliance,l=e.sublocation,s=e.assetCategory,c=e.asset,d=e.repeat,u=e.status,m=e.expiryDate,p=e.lastCompleted,h=e.hideExpiredCompliance,v={type:{_eq:"location"}},x=[];return n&&(v.locationId={_eq:n}),t&&(v.name={_ilike:"%".concat(t,"%")}),o&&(v.complianceCategoryId={_eq:o}),r&&(v.complianceId={_eq:r}),l&&(v.sublocationId={_eq:l}),s&&(v.assetCategoryId={_eq:s}),c&&(v.Assets={entity:{_eq:"Compliance"},assetId:{_eq:c}}),d&&(v.repeat={_eq:d}),u&&(v.status={_eq:u}),m&&x.push({expiryDate:{_eq:W()(m).utc(!0).toISOString()}}),p&&(v.lastCompleted={_eq:W()(p).utc(!0).toISOString()}),h&&x.push({expiryDate:{_gte:W()().startOf("day").utc(!0).toISOString()}}),{where:(0,i.Z)((0,a.Z)({},v),{_and:x.length>0?x:void 0})}},nb=t(24341),ny=ey.Ry({search:ey.Z_(),complianceCategory:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()}).nullable(),parentCompliance:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()}).nullable(),sublocation:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()}).nullable(),assetCategory:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()}).nullable(),asset:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()}).nullable(),repeat:ey.Z_().oneOf(Object.values(nb.D)).nullable(),status:ey.Z_().oneOf(Object.values(nb.b)).nullable(),expiryDate:ey.hT().nullable(),lastCompleted:ey.hT().nullable(),hideExpiredCompliance:ey.O7().nullable()}),nZ={search:"",complianceCategory:null,parentCompliance:null,sublocation:null,assetCategory:null,asset:null,repeat:null,status:null,expiryDate:null,lastCompleted:null,hideExpiredCompliance:!1};ey.Ry({search:ey.Z_(),status:ey.Z_().oneOf(Object.values(nb.b)).nullable()});var nj=t(52553),nC=t(11994),nI=t(15843),nw=t(93946),nS=t(50135),nA=t(36191),nk=t(33754),n_=t(73359),nq=t(182),nR=function(e){var n=e.locationId,t=(0,r.useState)(""),o=t[0],a=t[1],i=(0,r.useState)(""),l=i[0],s=i[1],c=(0,r.useState)(""),d=c[0],u=c[1],m=(0,r.useState)(""),p=m[0],h=m[1],v=(0,r.useState)(""),x=v[0],f=v[1],g=(0,eu.Z)((0,n_.t)(nq.OZ,{variables:{q:""!==o?"%".concat(o,"%"):null}}),2),b=g[0],y=g[1],Z=y.data,j=(void 0===Z?{items:[]}:Z).items,C=y.loading,I=(0,eu.Z)((0,n_.t)(nq.r6,{variables:{q:""!==l?"%".concat(l,"%"):null}}),2),w=I[0],S=I[1],A=S.data,k=(void 0===A?{items:[]}:A).items,_=S.loading,q=(0,eu.Z)((0,n_.t)(nq.zR,{variables:{locationId:n,q:""!==d?"%".concat(d,"%"):null}}),2),R=q[0],M=q[1],T=M.data,N=(void 0===T?{items:[]}:T).items,P=M.loading,D=(0,eu.Z)((0,n_.t)(nq.UM,{variables:{q:""!==p?"%".concat(p,"%"):null}}),2),F=D[0],L=D[1],E=L.data,$=(void 0===E?{items:[]}:E).items,O=L.loading,W=(0,eu.Z)((0,n_.t)(nq.UH,{variables:{locationId:n,q:""!==x?"%".concat(x,"%"):null}}),2),B=W[0],H=W[1],Y=H.data,V=(void 0===Y?{items:[]}:Y).items;return{complianceCategory:{onSearchChange:function(e){return a(e)},onOpen:function(){return b()},loading:C,options:j},parentCompliance:{onSearchChange:function(e){return s(e)},onOpen:function(){return w()},loading:_,options:k},sublocation:{onSearchChange:function(e){return u(e)},onOpen:function(){return R()},loading:P,options:N},assetCategory:{onSearchChange:function(e){return h(e)},onOpen:function(){return F()},loading:O,options:$},asset:{onSearchChange:function(e){return f(e)},onOpen:function(){return B()},loading:H.loading,options:V}}},nM=t(19441),nT=function(e){var n=e.location,t=e.setFilters,l=e.onTableStateChange,s=(0,r.useState)(!1),c=s[0],d=s[1],u=(0,ea.cI)({defaultValues:(0,a.Z)({},nZ),resolver:(0,em.S)(ny)}),p=nR({locationId:null==n?void 0:n.id}),h=function(e){var o,r,s,c,u;t({locationId:null==n?void 0:n.id,q:e.search,complianceCategory:null===(o=e.complianceCategory)||void 0===o?void 0:o.value,parentCompliance:null===(r=e.parentCompliance)||void 0===r?void 0:r.value,sublocation:null===(s=e.sublocation)||void 0===s?void 0:s.value,assetCategory:null===(c=e.assetCategory)||void 0===c?void 0:c.value,asset:null===(u=e.asset)||void 0===u?void 0:u.value,repeat:e.repeat,status:e.status,expiryDate:e.expiryDate,lastCompleted:e.lastCompleted,hideExpiredCompliance:!!e.hideExpiredCompliance}),l(function(e){return(0,i.Z)((0,a.Z)({},e),{currentPage:0})}),d(!1)},v=function(){u.reset(),t({}),d(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(el.Z,{variant:"contained",startIcon:(0,o.jsx)(nI.Z,{}),onClick:function(){return d(!0)},children:"Filters"}),(0,o.jsx)(nC.Z,{keepMounted:!0,open:c,onClose:function(){return d(!1)},children:(0,o.jsx)(nN,{children:(0,o.jsxs)(nP,{onSubmit:u.handleSubmit(h),children:[(0,o.jsxs)(nD,{children:[(0,o.jsx)(er.Z,{variant:"h6",children:"Filters"}),(0,o.jsx)(nw.Z,{onClick:function(){return d(!1)},children:(0,o.jsx)(nA.Z,{})})]}),(0,o.jsxs)(nF,{spacing:2,children:[(0,o.jsx)(ea.Qr,{name:"search",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nS.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Search",placeholder:"Search...",value:n,onChange:t})}}),(0,o.jsxs)(m.Z,{direction:"row",width:"100%",spacing:2,children:[(0,o.jsx)(ea.Qr,{name:"complianceCategory",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nj.F,(0,a.Z)({fullWidth:!0,label:"Primary category",placeholder:"Select primary category...",color:"secondary",variant:"standard",value:n,onChange:function(e,n){return t(n)}},p.complianceCategory))}}),(0,o.jsx)(ea.Qr,{name:"parentCompliance",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nj.F,(0,a.Z)({fullWidth:!0,label:"Secondary category",placeholder:"Select secondary category...",color:"secondary",variant:"standard",value:n,onChange:function(e,n){return t(n)}},p.parentCompliance))}})]}),(0,o.jsxs)(m.Z,{direction:"row",width:"100%",spacing:2,children:[(0,o.jsx)(ea.Qr,{name:"sublocation",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nj.F,(0,a.Z)({fullWidth:!0,label:"Sublocation",placeholder:"Select sublocation...",color:"secondary",variant:"standard",value:n,onChange:function(e,n){return t(n)}},p.sublocation))}}),(0,o.jsx)(ea.Qr,{name:"assetCategory",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nj.F,(0,a.Z)({fullWidth:!0,label:"Asset category",placeholder:"Select asset category...",color:"secondary",variant:"standard",value:n,onChange:function(e,n){return t(n)}},p.assetCategory))}})]}),(0,o.jsxs)(m.Z,{direction:"row",width:"100%",spacing:2,children:[(0,o.jsx)(ea.Qr,{name:"asset",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nj.F,(0,a.Z)({fullWidth:!0,label:"Asset",placeholder:"Select asset...",color:"secondary",variant:"standard",value:n,onChange:function(e,n){return t(n)}},p.asset))}}),(0,o.jsx)(ea.Qr,{name:"repeat",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nM.P,{fullWidth:!0,label:"Repeat",placeholder:"Select repeat...",color:"secondary",variant:"standard",value:n,onChange:t,options:nx.MI})}})]}),(0,o.jsxs)(m.Z,{direction:"row",spacing:2,children:[(0,o.jsx)(ea.Qr,{name:"status",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(nM.P,{fullWidth:!0,label:"Status",placeholder:"Select status...",color:"secondary",variant:"standard",value:n,onChange:t,options:nx.UF})}}),(0,o.jsx)(ea.Qr,{control:u.control,name:"expiryDate",defaultValue:null,render:function(e){return(0,o.jsx)(nk.M,(0,i.Z)((0,a.Z)({},e),{label:"Expiry date",inputFormat:"DD/MM/YYYY",renderInput:function(e){return(0,o.jsx)(nS.Z,(0,i.Z)((0,a.Z)({},e),{fullWidth:!0,color:"secondary",variant:"standard"}))}}))}})]}),(0,o.jsxs)(m.Z,{direction:"row",spacing:2,children:[(0,o.jsx)(ea.Qr,{control:u.control,name:"lastCompleted",defaultValue:null,render:function(e){return(0,o.jsx)(nk.M,(0,i.Z)((0,a.Z)({},e),{label:"Last completed",inputFormat:"DD/MM/YYYY",renderInput:function(e){return(0,o.jsx)(nS.Z,(0,i.Z)((0,a.Z)({},e),{fullWidth:!0,color:"secondary",variant:"standard",sx:{width:"50%"}}))}}))}}),(0,o.jsx)(e6.Z,{control:(0,o.jsx)(ea.Qr,{name:"hideExpiredCompliance",control:u.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(e9.Z,{color:"secondary",checked:n,onChange:function(e,n){return t(n)},sx:{marginLeft:"-8px"}})}}),label:"Hide expired compliances"})]})]}),(0,o.jsxs)(nL,{direction:"row",spacing:2,children:[(0,o.jsx)(el.Z,{variant:"contained",color:"danger",onClick:v,children:"Clear"}),(0,o.jsx)(el.Z,{variant:"contained",color:"secondary",type:"submit",children:"Search"})]})]})})})]})},nN=(0,nt.ZP)(ei.Z)(function(){return{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"700px",padding:"16px 27px 16px 27px",borderRadius:"8px"}}),nP=(0,nt.ZP)("form")(function(){return{}}),nD=(0,nt.ZP)(m.Z)(function(){return{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}}),nF=(0,nt.ZP)(m.Z)(function(){return{width:"100%"}}),nL=(0,nt.ZP)(m.Z)(function(){return{width:"100%",justifyContent:"flex-end",paddingTop:"16px"}}),nE=ey.Ry({location:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()}).required(),sublocation:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()}).nullable(),assetCategory:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()}).nullable(),assets:ey.IX(ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()})).nullable(),complianceCategory:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required(),category:ey.Ry({label:ey.Z_().required(),value:ey.Rx().required()})}).required("Compliance category is required"),name:ey.Z_().required("Name is required").trim(),registeredNumber:ey.Z_().required("Registered number is required").trim(),repeat:ey.Z_().oneOf(Object.values(nb.D)).required(),expiryDate:ey.hT().required().when("$edit",{is:!0,then:function(e){return e.min(W()().startOf("day").toDate(),"should be later that ".concat(W()().startOf("day").format("Do MMM YYYY")))},otherwise:function(e){return e}}),status:ey.Z_().oneOf(Object.values(nb.b)).required(),attachments:ey.IX(ey.Ry({caption:ey.Z_().required(),media:ey.nK().required(),type:ey.Z_().required(),mediaId:ey.Rx()})).when("$edit",{is:!0,then:function(e){return e},otherwise:function(e){return e.required()}})}),n$={sublocation:null,assetCategory:null,assets:[],name:"",registeredNumber:"",expiryDate:new Date,repeat:nb.D.ANNUALLY,status:nb.b.ACTIVE,attachments:[]},nO=function(e){var n=e.locationId,t=e.assetCategoryId,o=(0,r.useState)(""),a=o[0],i=o[1],l=(0,r.useState)(""),s=l[0],c=l[1],d=(0,r.useState)(""),u=d[0],m=d[1],p=(0,r.useState)(""),h=p[0],v=p[1],x=(0,eu.Z)((0,n_.t)(nq.zR,{variables:{locationId:n,q:""!==a?"%".concat(a,"%"):null}}),2),f=x[0],g=x[1],b=g.data,y=(void 0===b?{items:[]}:b).items,Z=g.loading,j=(0,eu.Z)((0,n_.t)(nq.UM,{variables:{q:""!==u?"%".concat(u,"%"):null}}),2),C=j[0],I=j[1],w=I.data,S=(void 0===w?{items:[]}:w).items,A=I.loading,k=(0,eu.Z)((0,n_.t)(nq.r6,{variables:{q:""!==s?"%".concat(s,"%"):null}}),2),_=k[0],q=k[1],R=q.data,M=(void 0===R?{items:[]}:R).items,T=q.loading,N=(0,eu.Z)((0,n_.t)(nq.UH,{variables:{locationId:n,categoryId:t,q:""!==h?"%".concat(h,"%"):null}}),2),P=N[0],D=N[1],F=D.data,L=(void 0===F?{items:[]}:F).items;return{sublocation:{onSearchChange:function(e){return i(e)},onOpen:function(){return f()},loading:Z,options:y},assetCategory:{onSearchChange:function(e){return m(e)},onOpen:function(){return C()},loading:A,options:S},assets:{onSearchChange:function(e){return v(e)},onOpen:function(){return P()},loading:D.loading,options:L},complianceCategory:{onSearchChange:function(e){return c(e)},onOpen:function(){return _()},loading:T,options:M}}};function nW(){var e=(0,h.Z)(['\n  query GetCompliance($id: Int!) {\n    compliance: Compliance_by_pk(id: $id) {\n      id\n      name\n      registeredNumber\n      repeat\n      status\n      expiryDate\n\n      location: Location {\n        id\n        name\n      }\n      sublocation: Sublocation {\n        id\n        name\n      }\n      assetCategory: AssetCategory {\n        id\n        name\n      }\n      complianceCategory: ComplianceCategory {\n        id\n        name\n      }\n      parentCompliance: ParentCompliance {\n        id\n        name\n      }\n      assets: Assets(where: { entity: { _eq: "Compliance" } }) {\n        id\n        entity\n        entityId\n        assetId\n        asset: Asset {\n          id\n          name\n        }\n      }\n    }\n  }\n']);return nW=function(){return e},e}function nB(){var e=(0,h.Z)(["\n  query GetComplianceFromSettings($id: Int!) {\n    compliance: Compliance_by_pk(id: $id) {\n      id\n      name\n      status\n\n      complianceCategory: ComplianceCategory {\n        id\n        name\n      }\n    }\n  }\n"]);return nB=function(){return e},e}function nH(){var e=(0,h.Z)(["\n  mutation ComplianceMediaAttached($id: Int!) {\n    complianceMediaAttached(id: $id) {\n      message\n    }\n  }\n"]);return nH=function(){return e},e}var nY=(0,v.Ps)(nW());(0,v.Ps)(nB());var nV=(0,v.Ps)(nH()),nU=function(e){var n,t=e.compliance;return{location:t.location?{label:t.location.name,value:t.location.id}:null,sublocation:t.sublocation?{label:t.sublocation.name,value:t.sublocation.id}:null,assetCategory:t.assetCategory?{label:t.assetCategory.name,value:t.assetCategory.id}:null,assets:(null===(n=t.assets)||void 0===n?void 0:n.map(function(e){return{value:e.asset.id,label:e.asset.name||"-"}}))||[],complianceCategory:{label:t.parentCompliance.name,value:t.parentCompliance.id,category:{label:t.complianceCategory.name,value:t.complianceCategory.id}},name:t.name,registeredNumber:t.registeredNumber||"",repeat:t.repeat,expiryDate:t.expiryDate?new Date(t.expiryDate):null,status:t.status}},nz=t(84808),nQ=t(19512),nG=t(76011),nJ=t(46242),nX=t(57779),nK=t(461),n0=function(e){var n,t=e.id,r=e.edit,s=void 0!==r&&r,c=e.location,d=e.close,p=e.refetchQueries,h=void 0===p?[]:p,v=(0,w.x)().user,x=(0,nQ.D)(),f=(0,nJ.z)("Compliance",v.adminId,v.id),g=f.createMediaInput,b=f.loadingAddMedia,y=(0,ea.cI)({defaultValues:(0,a.Z)({},n$,c?{location:{value:null==c?void 0:c.id,label:null==c?void 0:c.name}}:{}),context:{edit:s},resolver:(0,em.S)(nE)}),Z=y.watch("assetCategory"),j=y.watch("attachments"),C=(0,l.a)(nY,{skip:!t,variables:{id:t},onCompleted:function(e){var n=nU(e);y.reset(n)}}).loading,I=nO({locationId:null==c?void 0:c.id,assetCategoryId:null==Z?void 0:Z.value}),S=(0,eu.Z)((0,ep.D)(nK.z,{refetchQueries:h,onCompleted:function(){x.show({content:"Compliance was successfully created.",severity:"success"}),d&&d()},onError:function(e){x.show({content:"Error: ".concat(e.message),severity:"error"})}}),2),A=S[0],k=S[1].loading,R=(0,eu.Z)((0,ep.D)(nK.V,{refetchQueries:h,onCompleted:function(){x.show({content:"Compliance was successfully updated.",severity:"success"}),d&&d()},onError:function(e){x.show({content:"Error: ".concat(e.message),severity:"error"})}}),2),M=R[0],T=R[1].loading,N=(0,eu.Z)((0,ep.D)(nV,{refetchQueries:h,onError:function(e){x.show({content:"Error: ".concat(e.message),severity:"error"})}}),1)[0],P=(n=(0,_.Z)(function(e){var n,o,i,r,l;return(0,q.__generator)(this,function(c){switch(c.label){case 0:return[4,g(e.attachments)];case 1:return r=c.sent(),l=(0,a.Z)({id:t,name:e.name,registeredNumber:e.registeredNumber,repeat:e.repeat,expiryDate:e.expiryDate.toISOString(),status:e.status,locationId:e.location.value,sublocationId:null===(n=e.sublocation)||void 0===n?void 0:n.value,assetCategoryId:(null===(o=e.assetCategory)||void 0===o?void 0:o.value)||null,complianceCategoryId:e.complianceCategory.category.value,complianceId:e.complianceCategory.value,assets:(null===(i=e.assets)||void 0===i?void 0:i.map(function(e){return e.value}))||null},r||{}),s&&t?M({variables:{data:l}}):A({variables:{data:l}}),[2]}})}),function(e){return n.apply(this,arguments)}),D=function(){N({variables:{id:t}})};return(0,o.jsxs)(n1,{id:"offCanvas-manage-compliance",onSubmit:y.handleSubmit(P),children:[(0,o.jsx)(nz.Z,{sx:{zIndex:1e5},open:C||k||T||b,children:(0,o.jsx)(u.Z,{color:"secondary"})}),(0,o.jsxs)(m.Z,{spacing:3,children:[(0,o.jsx)(ea.Qr,{name:"location",control:y.control,render:function(e){var n,t,a=e.value,i=e.onChange;return(0,o.jsx)(nj.F,{freeSolo:!0,disabled:!!c,variant:"standard",color:"secondary",label:"Location",placeholder:"Location",value:a,onChange:function(e,n){return i(n)},options:[{label:"locationa asd",value:1}],error:!!y.errors.location,helperText:null===(n=y.errors.location)||void 0===n?void 0:null===(t=n.value)||void 0===t?void 0:t.message})}}),(0,o.jsx)(ea.Qr,{name:"sublocation",control:y.control,render:function(e){var n,t=e.value,r=e.onChange;return(0,o.jsx)(nj.F,(0,i.Z)((0,a.Z)({freeSolo:!0,variant:"standard",color:"secondary",label:"Sublocation",placeholder:"Sublocation",value:t,onChange:function(e,n){return r(n)}},I.sublocation),{error:!!y.errors.sublocation,helperText:null===(n=y.errors.sublocation)||void 0===n?void 0:n.message}))}}),(0,o.jsx)(ea.Qr,{name:"assetCategory",control:y.control,render:function(e){var n,t=e.value,r=e.onChange;return(0,o.jsx)(nj.F,(0,i.Z)((0,a.Z)({freeSolo:!0,variant:"standard",color:"secondary",label:"Asset category",placeholder:"Asset category",value:t,onChange:function(e,n){y.setValue("assets",[]),r(n)}},I.assetCategory),{error:!!y.errors.assetCategory,helperText:null===(n=y.errors.assetCategory)||void 0===n?void 0:n.message}))}}),(0,o.jsx)(ea.Qr,{name:"assets",control:y.control,render:function(e){var n,t=e.value,r=e.onChange;return(0,o.jsx)(nj.F,(0,i.Z)((0,a.Z)({freeSolo:!0,multiple:!0,disabled:!(null==Z?void 0:Z.value),variant:"standard",color:"secondary",label:"Asset",placeholder:"Asset",value:t,onChange:function(e,n){return r(n)}},I.assets),{error:!!y.errors.assets,helperText:null===(n=y.errors.assets)||void 0===n?void 0:n.message}))}}),(0,o.jsx)(ea.Qr,{name:"complianceCategory",control:y.control,defaultValue:null,render:function(e){var n,t=e.value,r=e.onChange;return(0,o.jsx)(nj.F,(0,i.Z)((0,a.Z)({freeSolo:!0,variant:"standard",color:"secondary",label:"Compliance category*",placeholder:"Compliance category",value:t||null,onChange:function(e,n){return r(n)}},I.complianceCategory,n2.groupedSelector),{groupBy:function(e){return e.category.label},error:!!y.errors.complianceCategory,helperText:null===(n=y.errors.complianceCategory)||void 0===n?void 0:n.message}))}}),(0,o.jsx)(ea.Qr,{name:"name",control:y.control,render:function(e){var n,t=e.value,a=e.onChange;return(0,o.jsx)(nS.Z,{variant:"standard",color:"secondary",label:"Name*",placeholder:"Name",value:t,onChange:a,error:!!y.errors.name,helperText:null===(n=y.errors.name)||void 0===n?void 0:n.message})}}),(0,o.jsx)(ea.Qr,{name:"registeredNumber",control:y.control,render:function(e){var n,t=e.value,a=e.onChange;return(0,o.jsx)(nS.Z,{variant:"standard",color:"secondary",label:"Registered number*",placeholder:"Registered number",value:t,onChange:a,error:!!y.errors.registeredNumber,helperText:null===(n=y.errors.registeredNumber)||void 0===n?void 0:n.message})}}),(0,o.jsx)(ea.Qr,{name:"repeat",control:y.control,render:function(e){var n,t=e.value,a=e.onChange;return(0,o.jsx)(nM.P,{fullWidth:!0,variant:"standard",color:"secondary",label:"Repeat*",placeholder:"Repeat",value:t,onChange:a,options:nx.MI,error:!!y.errors.repeat,helperText:null===(n=y.errors.repeat)||void 0===n?void 0:n.message})}}),(0,o.jsx)(ea.Qr,{control:y.control,name:"expiryDate",defaultValue:null,render:function(e){return(0,o.jsx)(nk.M,(0,i.Z)((0,a.Z)({},e),{label:"Expiry date*",inputFormat:"Do MMM YYYY",renderInput:function(e){var n;return(0,o.jsx)(nS.Z,(0,i.Z)((0,a.Z)({},e),{fullWidth:!0,color:"secondary",variant:"standard",error:!!y.errors.expiryDate,helperText:null===(n=y.errors.expiryDate)||void 0===n?void 0:n.message}))}}))}}),(0,o.jsx)(ea.Qr,{name:"status",control:y.control,render:function(e){var n,t=e.value,a=e.onChange;return(0,o.jsx)(nM.P,{fullWidth:!0,variant:"standard",color:"secondary",label:"Status*",placeholder:"Status",value:t,onChange:a,options:nx.UF,error:!!y.errors.status,helperText:null===(n=y.errors.status)||void 0===n?void 0:n.message})}}),s&&t?(0,o.jsx)(nX.G,{expanded:!0,entityId:t,entity:"Compliance",onMediaAdd:D,onMediaRemove:D}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nG.f,{values:j,setValue:y.setValue}),(0,o.jsx)(ea.Qr,{name:"attachments",control:y.control,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)("input",{value:n,onChange:t,type:"hidden"})}})]})]})]})},n1=(0,nt.ZP)("form")(function(){return{}}),n2={groupedSelector:{slotProps:{popper:{sx:{"& .MuiAutocomplete-groupLabel":{height:"30px",lineHeight:"30px",backgroundColor:"#f5f5f5",fontWeight:700}}}}}},n3=t(4791),n4=t(21813),n6=t(57460),n9=t.n(n6),n5=function(e,n){var t=document.createElement("a");"string"==typeof t.download?(document.body.appendChild(t),t.download=n,t.href=e,t.click(),document.body.removeChild(t)):location.replace(e)},n8=t(12978),n7=t(35374),te=function(e){var n=e.location,t=e.hideFilters,s=e.editable,c=void 0!==s&&s,d=(0,n7.s)(),p=(0,ns.x)(),h=(0,V.a)(),v=(0,r.useState)({}),x=v[0],f=v[1],g=(0,r.useState)(!1),b=g[0],y=g[1],Z=(0,nl.V)(),j=Z.reference,C=Z.order,I=Z.pagination,w=(0,l.a)(nu,{variables:(0,a.Z)({order:C},I,ng((0,a.Z)({locationId:null==n?void 0:n.id},x)))}),S=w.data,A=void 0===S?{compliances:[],meta:{aggregate:{totalCount:0}}}:S,k=A.compliances,R=A.meta.aggregate.totalCount,M=w.loading,T=(0,r.useCallback)(function(){h.show({content:(0,o.jsx)(n0,{location:n,close:h.close,refetchQueries:["GetCompliances"]}),submit:!0,title:"Add compliance",submitForm:"offCanvas-manage-compliance"})},[n,h]),N=(0,r.useCallback)(function(e){h.show({content:(0,o.jsx)(n0,{edit:!0,id:e,location:n,close:h.close,refetchQueries:["GetCompliances"]}),submit:!0,title:"Edit compliance",submitForm:"offCanvas-manage-compliance"})},[n,h]),P=(0,r.useCallback)(function(e){h.show({content:(0,o.jsx)(n3.w,{type:"Compliance",complianceId:e,onClose:h.close,hideFilters:t}),title:"Works orders",xs3:"100vw",sm:"100vw",sm2:"100vw",sm3:"90vw",md2:"85vw",lg:"75vw",lg2:"75vw",submit:!1})},[h,t]),D=(0,r.useCallback)((0,_.Z)(function(){var e,t,o,i,r;return(0,q.__generator)(this,function(e){switch(e.label){case 0:y(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,p.query({query:nu,variables:(0,a.Z)({order:C,limit:null,offset:0},ng((0,a.Z)({locationId:null==n?void 0:n.id},x)))})];case 2:var l;return o=(void 0===(t=e.sent().data)?{compliances:[]}:t).compliances,i=n9().unparse((l=o).map(function(e){var n,t,o,a,i,r,l=e.jobs[0];return{Item:e.name,Category:e.complianceCategory.name,Sublocation:(null===(n=e.sublocation)||void 0===n?void 0:n.name)||"-","Asset category":(null===(t=e.assetCategory)||void 0===t?void 0:t.name)||"-","Asset name":null===(o=e.assets)||void 0===o?void 0:o.map(function(e){return e.asset.name}).join(", "),"Registered number":e.registeredNumber,"Last completed":e.lastCompleted||"-","Expiry date":e.expiryDate,Repeat:e.repeat,"Next job(number)":(null==l?void 0:l.number)||"-","Next job(status)":(null==l?void 0:l.status)||"-","Next job(description)":(null==l?void 0:null===(a=l.shortJobDesc)||void 0===a?void 0:null===(i=a[0])||void 0===i?void 0:null===(r=i.taxonomy)||void 0===r?void 0:r.name)||"-","All jobs":e.jobTotal.aggregate.count,Status:e.status}})),r="data:application/octet-stream,"+encodeURIComponent(i),n5(r,"compliances_property_".concat((null==n?void 0:n.name)||"","_").concat((null==n?void 0:n.id)||"",".csv")),[3,4];case 3:return y(!1),[7];case 4:return[2]}})}),[p,x,null==n?void 0:n.id,null==n?void 0:n.name,C]),F=(0,r.useCallback)(function(e){h.show({content:(0,o.jsx)(n4.g,{jobId:e,toggleShow:h.close}),submit:!1,title:"Job Details",xs3:"100vw",sm:"100vw",sm2:"100vw",sm3:"40vw",md2:"40vw",lg:"40vw",lg2:"40vw"})},[h]),L=(0,r.useMemo)(function(){return[{minWidth:200,flex:1,sortable:!1,field:"id",headerName:"Item",renderCell:function(e){var n=e.row;if(!n.expiryDate)return null;var t=nh(n.expiryDate,n.repeat);return(0,o.jsxs)(m.Z,{direction:"row",alignItems:"center",children:["warning"===t&&(0,o.jsx)(nm.Z,{color:"danger",sx:{mr:2}}),(0,o.jsx)(er.Z,{children:n.name})]})}},{minWidth:200,flex:1,sortable:!1,field:"category",headerName:"Category",renderCell:function(e){var n=e.row;return(0,o.jsxs)(m.Z,{children:[(0,o.jsx)(er.Z,{children:n.complianceCategory.name}),(0,o.jsx)(er.Z,{children:n.parentCompliance.name})]})}},{minWidth:200,flex:1,sortable:!1,field:"details",headerName:"Details",renderCell:function(e){var n,t,a,i=e.row;return(0,o.jsxs)(m.Z,{children:[(0,o.jsxs)(er.Z,{children:["Sublocation: ",(0,o.jsx)("span",{children:(null===(n=i.sublocation)||void 0===n?void 0:n.name)||"-"})]}),(0,o.jsxs)(er.Z,{children:["Asset category: ",(0,o.jsx)("span",{children:(null===(t=i.assetCategory)||void 0===t?void 0:t.name)||"-"})]}),(0,o.jsxs)(er.Z,{children:["Asset name: ",(0,o.jsx)("span",{children:null===(a=i.assets)||void 0===a?void 0:a.map(function(e){return e.asset.name}).join(", ")})]})]})}},{minWidth:180,sortable:!1,flex:1,field:"registeredNumber",headerName:"Registered number"},{minWidth:180,sortable:!1,flex:1,field:"lastCompleted",headerName:"Last completed",renderCell:function(e){var n=e.row;return n.lastCompleted?W()(n.lastCompleted).format("DD-MM-YYYY"):null}},{minWidth:100,flex:1,sortable:!1,field:"expiryDate",headerName:"Expiry date",renderCell:function(e){var n=e.row;if(!n.expiryDate)return null;var t=nh(n.expiryDate,n.repeat);return(0,o.jsx)(er.Z,{color:"".concat(t,".main"),children:W()(n.expiryDate).format("DD-MM-YYYY")})}},{minWidth:100,flex:1,sortable:!1,field:"repeat",headerName:"Repeat"},{minWidth:200,flex:1,sortable:!1,field:"nextJob",headerName:"Next job",renderCell:function(e){var n,t,a=e.row.jobs[0];return a?(0,o.jsx)(el.Z,{variant:"text",onClick:function(){return F(a.id)},children:(0,o.jsxs)(m.Z,{spacing:.5,children:[(0,o.jsxs)(m.Z,{direction:"row",spacing:1,children:[(0,o.jsx)(ni.Z,{label:a.number,color:"primary",size:"small",sx:{borderRadius:1}}),(0,o.jsx)(np.B,{value:a.status,sx:{borderRadius:1}})]}),(0,o.jsx)(er.Z,{sx:{color:"#5C5C5C"},children:(0,o.jsx)(n8.O,{maxLength:20,children:null===(n=a.shortJobDesc[0])||void 0===n?void 0:null===(t=n.taxonomy)||void 0===t?void 0:t.name})})]})}):null}},{minWidth:180,flex:1,sortable:!1,field:"allJobs",headerName:"All jobs",renderCell:function(e){var n=e.row;return(0,o.jsxs)(m.Z,{direction:"row",spacing:1,children:[(0,o.jsxs)(el.Z,{disableMinWidth:!0,variant:"contained",color:"info",sx:{height:"30px"},onClick:function(){return P(n.id)},children:[n.jobTotal.aggregate.count," ",n.jobTotal.aggregate.count>1?"jobs":"job"]}),(0,o.jsx)(el.Z,{disableMinWidth:!0,variant:"contained",color:"info",sx:{height:"30px"},onClick:function(){return P(n.id)},children:(0,o.jsx)(nv.Z,{})})]})}},{minWidth:100,flex:1,sortable:!1,field:"status",headerName:"Status",renderCell:function(e){var n=e.row;return(0,o.jsx)(ni.Z,{label:"".concat(n.status.charAt(0).toLocaleUpperCase()).concat(n.status.substring(1)),color:nx.gz[n.status]})}},{minWidth:100,flex:1,sortable:!1,field:"updatedAt",headerName:"Updated",renderCell:function(e){var n=e.row;return n.updatedAt?W()(n.updatedAt).format("DD-MM-YYYY"):null}},{minWidth:100,flex:1,sortable:!1,field:"action",headerName:"Action",renderCell:function(e){var n=e.row;return(0,o.jsx)(nf.C,{actions:[{icon:"edit",tooltip:"Edit",onClick:function(){N(n.id)}}]})}}]},[N,F,P]);return(0,o.jsxs)(ei.Z,{sx:{height:"calc(100vh - 200px)"},children:[(0,o.jsx)(nz.Z,{sx:{zIndex:1e5},open:b,children:(0,o.jsx)(u.Z,{color:"secondary"})}),(0,o.jsxs)(m.Z,{direction:"row",justifyContent:"space-between",pl:2,pr:2,mt:1,mb:1,children:[(0,o.jsx)(nT,(0,i.Z)((0,a.Z)({},j),{location:n,setFilters:f})),(0,o.jsxs)(m.Z,{direction:"row",spacing:2,children:[!d&&(0,o.jsx)(el.Z,{variant:"contained",color:"info",onClick:D,children:(0,o.jsx)("img",{src:"/static/icons/csv.svg"})}),c&&(0,o.jsx)(el.Z,{variant:"contained",color:"success",onClick:T,children:"Add compliance"})]})]}),(0,o.jsx)(nr.i,(0,i.Z)((0,a.Z)({},j),{loading:M,columns:L,rows:k,totalCount:R,autoHeight:!1,rowHeight:100,containerHeight:"calc(100% - 80px)",columnVisibilityModel:{action:c}}))]})},tn=t(96830),tt=t(85427),to=t(53219),ta=t(71496),ti=t(64293),tr=function(e){var n=e.icon,t=e.children,a=e.expanded,i=e.onOpen;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(tl,{open:a,children:[(0,o.jsx)(ts,{onClick:i,children:n}),a&&(0,o.jsx)(td,{children:(0,o.jsx)(ta.Z,{sx:{height:"32px",width:"32px",color:"#FFFFFF"}})})]}),(0,o.jsx)(d.Z,{sx:{height:"300px"},children:a&&(0,o.jsx)(tc,{open:a,children:t})})]})},tl=(0,nt.ZP)(d.Z)(function(e){var n;return{display:"flex",alignItems:"center",borderRadius:"10px",flexDirection:"row",height:"fit-content",width:e.open?"80px":"42px",backgroundColor:e.theme.palette.secondary.main,transition:"width 400ms cubic-bezier(0.4, 0, 0.2, 1) 100ms"}}),ts=(0,nt.ZP)(d.Z)(function(e){return{display:"flex",width:"42px",height:"42px",borderRadius:"8px",backgroundColor:e.theme.palette.secondary.main,justifyContent:"center",alignItems:"center"}}),tc=(0,nt.ZP)(d.Z)(function(e){var n;return{position:"absolute",top:50,left:-2,borderRadius:"10px",display:e.open?"block":"none",marginTop:"15px",backgroundColor:e.theme.palette.secondary.main}}),td=(0,nt.ZP)(nw.Z)(function(e){return{height:"36px",width:"36px",transform:e.open?"rotate(180deg)":"rotate(0deg)",transition:"transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 100ms"}}),tu=function(e){var n=(0,r.useRef)();return(0,r.useEffect)(function(){n.current=e}),n.current},tm=function(e){var n=e.icon,t=e.children,a=e.expanded,i=void 0!==a&&a,l=e.onOpen,s=e.spacing,c=(0,r.useState)(i),d=c[0],u=c[1],m=(0,r.useState)(!1),p=m[0],h=m[1],v=(0,r.useState)(!1),x=v[0],f=v[1],g=(0,r.useRef)(null),b=tu(d);(0,r.useEffect)(function(){u(i),h(!1)},[i]);var y=function(){g.current&&f(g.current.scrollHeight>=69)};(0,r.useEffect)(function(){return y(),window.addEventListener("resize",y),function(){return window.removeEventListener("resize",y)}},[t]);var Z=function(){u(!0),l&&l()},j=function(){h(!p)},C=function(){y()};return(0,o.jsxs)(tp,{open:d,children:[(0,o.jsx)(th,{open:d,onClick:Z,children:n}),(0,o.jsxs)(tv,{open:d,wasOpen:!!b,more:p,direction:"row",alignItems:"center",justifyContent:"space-between",onTransitionEnd:C,children:[(0,o.jsx)(tx,{ref:g,open:d,more:p,direction:"row",spacebetween:void 0===s?2:s,children:t}),x&&(0,o.jsx)(tf,{open:p,color:"white",onClick:j,children:(0,o.jsx)(ta.Z,{sx:{height:"32px",width:"32px"}})})]})]})},tp=(0,nt.ZP)(d.Z)(function(e){return{display:"flex",flexDirection:"row",width:e.open?"100%":"42px",transition:"width 400ms cubic-bezier(0.4, 0, 0.2, 1) 100ms"}}),th=(0,nt.ZP)(d.Z)(function(e){var n;return{display:e.open?"none":"flex",width:"42px",height:"42px",borderRadius:"8px",backgroundColor:e.theme.palette.secondary.main,justifyContent:"center",alignItems:"center"}}),tv=(0,nt.ZP)(m.Z)(function(e){var n=e.open,t=e.wasOpen,o=e.more,i=e.theme;return(0,a.Z)({width:n?"100%":"0px",overflow:"hidden",display:!n&&t?"none":"flex",height:o?"100%":"42px",borderRadius:"8px",backgroundColor:i.palette.secondary.main,transition:"width 300ms cubic-bezier(0.4, 0, 0.2, 1) 100ms,\n  height 300ms cubic-bezier(0.4, 0, 0.2, 1) 100ms"},n&&{paddingLeft:"8px",paddingRight:"8px"})}),tx=(0,nt.ZP)(m.Z)(function(e){var n=e.open,t=e.more,o=e.spacebetween;return(0,a.Z)({alignItems:"center",flexWrap:"wrap",height:t?"auto":"42px",overflow:"hidden"},n&&{paddingTop:"10px",paddingBottom:"10px",rowGap:"10px","&>:not(style):not(style)":{marginRight:8*o+"px"}})}),tf=(0,nt.ZP)(nw.Z)(function(e){return{height:"36px",width:"36px",transform:e.open?"rotate(180deg)":"rotate(0deg)",transition:"transform 300ms cubic-bezier(0.4, 0, 0.2, 1) 100ms"}}),tg=function(e){return(0,p.Z)("(max-width: 600px)")?(0,o.jsx)(tr,(0,a.Z)({},e)):(0,o.jsx)(tm,(0,a.Z)({},e))},tb=t(41796),ty=t(14564),tZ=function(e){var n=e.children,t=e.popover,a=e.onOpen,i=e.clickOnly,l=(0,r.useState)(null),s=l[0],c=l[1],d=function(e){i||c(e.currentTarget),a&&a(e)},u=function(){c(null)},m=Boolean(s),p=m?"ribbon-select-button-popover":void 0;return(0,o.jsxs)("div",{children:[(0,o.jsx)(tj,{"aria-describedby":p,onClick:d,children:n}),(0,o.jsx)(ty.ZP,{id:p,open:m,anchorEl:s,onClose:u,anchorOrigin:{vertical:"bottom",horizontal:"left"},sx:{zIndex:1200},children:t})]})},tj=(0,nt.ZP)("button")(function(e){return{display:"flex",alignItems:"center",border:"none",borderRadius:"4px",color:e.theme.palette.white.main,backgroundColor:"#1394FF",fontSize:"0.875rem",lineHeight:1.25,padding:"2px 4px 2px 4px",cursor:"pointer","&:hover":{backgroundColor:(0,tb._j)("#1394FF",.1)}}});function tC(){var e=(0,h.Z)(['\n  query GetNextJob($locationId: Int, $now: timestamptz!) {\n    nextJob: Job(\n      where: {\n        type: { _eq: "ppm" }\n        status: { _nin: ["closed", "canceled"] }\n        locationId: { _eq: $locationId }\n        timingStart: { _gt: $now }\n        Compliance: { type: { _eq: "location" }, locationId: { _eq: $locationId } }\n      }\n      order_by: { timingStart: asc }\n      limit: 1\n    ) {\n      id\n      number\n      title\n      status\n      scheduledAt\n    }\n  }\n']);return tC=function(){return e},e}function tI(){var e=(0,h.Z)(['\n  query GetTotalCompliances($locationId: Int, $now: date) {\n    total: Compliance_aggregate(\n      where: { type: { _eq: "location" }, locationId: { _eq: $locationId } }\n    ) {\n      aggregate {\n        count\n      }\n    }\n    overdueTotal: Compliance_aggregate(\n      where: {\n        type: { _eq: "location" }\n        locationId: { _eq: $locationId }\n        expiryDate: { _lte: $now }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n  }\n']);return tI=function(){return e},e}function tw(){var e=(0,h.Z)(["\n  query GetComplianceSpend($locationId: Int!) {\n    totals: getComplianceTotals(locationId: $locationId) {\n      ltmTotal\n      ytdTotal\n    }\n  }\n"]);return tw=function(){return e},e}var tS=(0,v.Ps)(tC()),tA=(0,v.Ps)(tI()),tk=(0,v.Ps)(tw()),t_=t(97212),tq=t(98619),tR=t(58533),tM=function(e){var n=e.jobs,t=e.hasMore,a=e.handleFetchMore,i=e.onItemClick,r=(0,p.Z)("(max-width:600px)");return(0,o.jsx)(d.Z,{id:"scrollableDiv",sx:{display:"flex",flexDirection:"column",pt:1,overflowY:"scroll",maxHeight:r?"80vh":"50vh",width:"200px"},children:(0,o.jsx)(tR.Z,{dataLength:n.length,next:void 0===a?function(){}:a,hasMore:t,loader:(0,o.jsx)(u.Z,{color:"secondary"}),scrollableTarget:"scrollableDiv",children:n.map(function(e){return(0,o.jsx)(t_.ZP,{component:"div",disablePadding:!0,onClick:function(n){return i(n,e)},children:(0,o.jsxs)(tq.Z,{sx:{flexDirection:"column",alignItems:"flex-start"},children:[(0,o.jsxs)(m.Z,{direction:"row",width:"100%",spacing:2,children:[(0,o.jsx)(ni.Z,{label:e.number,color:"primary",size:"small",sx:{borderRadius:1}}),(0,o.jsx)(np.B,{value:e.status,sx:{borderRadius:1}})]}),e.title&&(0,o.jsx)(er.Z,{mt:1,children:e.title})," "]})},e.number)})})})},tT=t(19504),tN=t(50108),tP=t(22927),tD=t(21023),tF=function(e){var n,t,a,i,s,c,d=e.expanded,u=e.handleOpen,h=e.locationId,v=(0,V.a)();(0,w.x)().hasRole;var x,f=(0,p.Z)("(max-width: 600px)"),g=(0,r.useMemo)(function(){return W()().toISOString()},[]),b=(0,l.a)(tS,{skip:!d,variables:{locationId:h,now:g}}).data,y=(void 0===b?{nextJob:[]}:b).nextJob,Z=(0,l.a)(tA,{skip:!d,variables:{locationId:h,now:g}}).data,j=void 0===Z?{}:Z,C=j.total,I=j.overdueTotal,S=(0,l.a)(tk,{skip:!d,variables:{locationId:h}}).data,A=(void 0===S?{totals:{ltmTotal:0,ytdTotal:0}}:S).totals,k=A.ltmTotal,_=A.ytdTotal,q=function(e,n){var t=n.id;e.stopPropagation(),v.show({content:(0,o.jsx)(n4.g,{jobId:t,toggleShow:v.close}),submit:!1,title:"Job details",xs3:"100vw",sm:"100vw",sm2:"100vw",sm3:"40vw",md2:"40vw",lg:"40vw",lg2:"40vw"})},R=((null==C?void 0:null===(n=C.aggregate)||void 0===n?void 0:n.count)||0)-((null==I?void 0:null===(t=I.aggregate)||void 0===t?void 0:t.count)||0),M=(0,tT.l)(R/((null==C?void 0:null===(a=C.aggregate)||void 0===a?void 0:a.count)||1)*100,2);return(0,o.jsxs)(tg,{icon:(0,o.jsx)(to.Z,{component:ti.Z,inheritViewBox:!0,sx:{"& path":{fill:"#82E1FF"}}}),expanded:d,onOpen:u,spacing:3,children:[(0,o.jsxs)(m.Z,{direction:"row",alignItems:"center",sx:tL.mobileItem(f),children:[(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:"Next Job:"}),(0,o.jsxs)(tZ,{popover:(0,o.jsx)(tM,{onItemClick:q,jobs:y,hasMore:!1}),children:[(null===(i=y[0])||void 0===i?void 0:i.title)||"N/A",(0,o.jsx)(ta.Z,{sx:{height:"14px"}})]})]}),(0,o.jsxs)(m.Z,{direction:"row",alignItems:"center",sx:tL.mobileItem(f),children:[(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:"Compliance items:"}),(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:(null==C?void 0:null===(s=C.aggregate)||void 0===s?void 0:s.count)||"N/A"})]}),(0,o.jsxs)(m.Z,{direction:"row",alignItems:"center",sx:tL.mobileItem(f),children:[(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:"Overdue items:"}),(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:(null==I?void 0:null===(c=I.aggregate)||void 0===c?void 0:c.count)||"N/A"})]}),(0,o.jsxs)(m.Z,{direction:"row",alignItems:"center",sx:tL.mobileItem(f),children:[(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:"Compliance score:"}),(0,o.jsxs)(er.Z,{fontWeight:700,mr:1,children:[M,"%"]}),(0,o.jsx)(tE,{bgcolor:"".concat(M>=80?"success":M<80&&M>=50?"info":"warning",".main")}),(0,o.jsx)(tD.Z,{title:"The compliance score represents the percentage of compliance items that are still valid,\n             calculated as the number of items for which the expiry date has not been reached divided\n             by the total number of compliance items for the location.",children:(0,o.jsx)(tP.Z,{})})]}),(0,o.jsxs)(m.Z,{direction:"row",alignItems:"center",sx:tL.mobileItem(f),children:[(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:"Compliance Spend (Net)(LTM):"}),(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:(0,tN.T)(k)}),(0,o.jsx)(tD.Z,{title:(0,o.jsxs)(o.Fragment,{children:["This amount reflects the amount that has been invoiced for compliance-related items in the last 12 months. If you require more detailed information use the"," ",(0,o.jsx)(ec.r,{href:"/dashboard/data/reports",color:"secondary",children:"Reports"})," ","functionality"]}),children:(0,o.jsx)(tP.Z,{})})]}),(0,o.jsxs)(m.Z,{direction:"row",alignItems:"center",sx:tL.mobileItem(f),children:[(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:"Compliance Spend (Net)(YTD):"}),(0,o.jsx)(er.Z,{fontWeight:700,mr:1,children:(0,tN.T)(_)}),(0,o.jsx)(tD.Z,{title:(0,o.jsxs)(o.Fragment,{children:["This amount reflects the amount that has been invoiced for compliance-related items in the year to date. If you require more detailed information use the"," ",(0,o.jsx)(ec.r,{href:"/dashboard/data/reports",color:"secondary",children:"Reports"})," ","functionality"]}),children:(0,o.jsx)(tP.Z,{})})]})]})},tL={mobileItem:function(e){return e?{width:"calc(100vw - 40px)",padding:"6px",borderBottom:"1px solid #FFFFFF"}:{}}},tE=(0,nt.ZP)(d.Z)(function(){return{width:"12px",height:"12px",borderRadius:"6px",marginRight:"8px"}}),t$=function(e){var n=e.locationId,t=e.defaultExpanded,a=(0,r.useState)(void 0===t?"info":t),i=a[0],l=a[1],s=(0,p.Z)("(max-width: 600px)"),c=function(e){l(e)};return(0,o.jsx)(tO,{direction:"row",justifyContent:s?"flex-start":"flex-end",width:"100%",spacing:1,children:(0,o.jsx)(tF,{expanded:"info"===i,handleOpen:function(){return c("info")},locationId:n})})},tO=(0,nt.ZP)(m.Z)(function(){return{position:"relative",color:"#BEEFFF"}}),tW=["compliance","items","calendar"],tB=function(e){var n,t=e.location,l=(0,p.Z)("(max-width:600px)"),d=(0,w.x)().hasRole,u=(0,s.useRouter)(),h=(0,r.useState)(Array.isArray(n=u.query.viewTab)||!n?"compliance":tW.includes(n)?n:"compliance"),v=h[0],x=h[1],f=function(e,n){x(n),c().push({query:(0,i.Z)((0,a.Z)({},u.query),{viewTab:n})})};return(0,o.jsxs)(m.Z,{children:[(0,o.jsx)(t$,{locationId:t.id}),(0,o.jsxs)(tV,{value:v,is600pxOrLess:l,children:[(0,o.jsxs)(tY,{value:v,onChange:f,"aria-label":"basic tabs example",children:[(0,o.jsx)(na.Z,{label:"Compliance",value:"compliance"}),(0,o.jsx)(na.Z,{label:"Items",value:"items"}),(0,o.jsx)(na.Z,{label:"Calendar",value:"calendar"})]}),(0,o.jsx)(Z.x,{value:v,index:"compliance",boxSx:tH.tabPanelBoxSx,children:(0,o.jsx)(te,{location:t,hideFilters:{supplier:!d("admin")},editable:d("admin")})}),(0,o.jsx)(Z.x,{value:v,index:"items",boxSx:tH.tabPanelBoxSx,children:(0,o.jsx)(tn.x,{hideAddAction:!0,hideCopyItems:!0,locationId:t.id,locationName:t.name,initialFilters:{locationId:t.id,complianceOnly:!0,filterType:"location_compliance_".concat(t.id)},hideFilters:["location","tags","allItems","allJobs","customerId","customerManagerId"],columnVisibilityModel:{invoicePeriod:!1,invoiceBasis:!1,invoiceAmount:!1,actions:!1},containerHeight:"calc(100vh - 120px)",tableHeight:"calc(100% - 180px)"})}),(0,o.jsx)(Z.x,{value:v,index:"calendar",boxSx:tH.tabPanelBoxSx,children:(0,o.jsx)(tt.w,{defaultFilters:["ppm","cppm"],locationId:t.id,hideFilters:["siteVisit","reactive","ppm","cppm","quote"],hideCreateWorkOrder:!0,complianceOnly:!0})})]})]})},tH={tabPanelBoxSx:{padding:"0px 0px 0px 0px"}},tY=(0,nt.ZP)(no.Z)(function(e){var n=e.theme;return{"&.MuiTabs-root":{paddingLeft:"16px",minHeight:"auto"},"& .MuiTabs-scroller":{minHeight:"auto"},"& .MuiTab-root":{fontSize:"18px",textTransform:"none",padding:"12px 0px",minWidth:"auto",minHeight:"auto",marginRight:"60px",color:n.palette.black.main},"& .MuiTab-root.Mui-selected":{color:n.palette.black.main},"& .MuiTabs-indicator":{bottom:"8px",backgroundColor:n.palette.black.main}}}),tV=(0,nt.ZP)(ei.Z)(function(){return{height:"calc(100vh - 120px)",marginTop:"25px"}}),tU=function(e){var n,t,h,v,x,f,C,I,S,A,_=e.propertyId,q=(0,p.Z)("(max-width:600px)"),R=(0,w.x)().hasRole,M=(0,s.useRouter)().query,T=(0,G.q)(),N=T.admin,P=T.hasUserModule,D=(0,r.useMemo)(function(){return M.tab||"details"},[M.tab]),F=null==N?void 0:null===(n=N.modules)||void 0===n?void 0:n.assets,L=R("admin"),E=R("tenant"),$=R("customer"),O=R("customer_user"),W=P("ppmSchedules"),B=P("finances"),H=P("quotes"),Y=(0,r.useState)(D),V=Y[0],U=Y[1],z=(0,r.useState)("slas-work-order"),Q=z[0],J=z[1],K=function(e,n){U(n)},en=function(e,n){J(n)},et=(0,l.a)(k,{variables:{id:_}}),eo=et.loading,ea=et.data,ei=(void 0===ea?{location:{}}:ea).location,er=et.refetch;if(eo)return(0,o.jsx)(m.Z,{height:"100%",width:"100%",justifyContent:"center",alignItems:"center",children:(0,o.jsx)(u.Z,{color:"secondary"})});if(!ei)return c().push("/404"),!1;var el=(0,i.Z)((0,a.Z)({marginTop:q?"20px":0,maxWidth:q?"100%":"calc(100vw - 280px)",height:"auto","& .MuiTabs-scroller":{height:"auto",overflowY:q?"visible":"auto"}},q&&{"& .MuiTabs-flexContainer>.MuiButtonBase-root":{marginBottom:"10px"}}),{"& .MuiTabs-flexContainer":q&&{flexWrap:"wrap"},"& .MuiTabs-flexContainer>.MuiTab-root:first-child":(0,a.Z)({},!q&&{borderTopLeftRadius:0,borderBottomLeftRadius:0})});return(0,o.jsxs)(d.Z,{sx:{width:"100%",height:"100%"},children:[(0,o.jsxs)(m.Z,{direction:q?"column":"row",width:"100%",children:[(0,o.jsx)(g.c,{withoutRightBorderRadius:!q,fullWidth:q,locationId:ei.id,locationName:ei.name,disabled:E}),(0,o.jsxs)(b.m,{value:V,onChange:K,changeQuery:!0,sx:el,children:[(0,o.jsx)(y.O,{value:"details",label:"Details",sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}),!(!B&&(E||O))&&(0,o.jsx)(y.O,{value:"finances",label:"Finances"}),!E&&(0,o.jsx)(y.O,{value:"sublocations",label:"Sublocations"}),F&&!E&&(0,o.jsx)(y.O,{value:"assets",label:"Assets"}),!E&&(0,o.jsx)(y.O,{value:"slas",label:"SLAs"}),!E&&(0,o.jsx)(y.O,{value:"services",label:"Services"}),(0,o.jsx)(y.O,{value:"work-orders",label:"Work Orders"}),!(!H&&(E||O))&&(0,o.jsx)(y.O,{value:"quotes",label:"Quotes"}),!E&&(0,o.jsx)(y.O,{value:"compliance",label:"Compliance"}),!E&&(0,o.jsx)(y.O,{value:"tenants",label:"Tenants"}),!(!W&&O)&&(0,o.jsx)(y.O,{value:"planned-maintenance",label:"Planned Maintenance"})]})]}),(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"details"},tz),{children:(0,o.jsx)(X,{location:ei,refetch:er})})),!(!B&&(E||O))&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"finances"},tz),{children:(0,o.jsx)(ee,{location:ei,refetch:er})})),!E&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"sublocations"},tz),{children:(0,o.jsx)(eT,{editable:!E&&!$,location:ei,customer:null===(t=ei.customer[0])||void 0===t?void 0:t.account})})),F&&!E&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"assets"},tz),{children:(0,o.jsx)(eN.E,{editable:L,hideLocationInfo:!0,hideCustomerInfo:!0,showHeader:!1,initialFilters:{locationId:ei.id,filterType:"location_assets"},createFormDefaultValues:{customer:{label:null===(h=ei.customer[0])||void 0===h?void 0:null===(v=h.account)||void 0===v?void 0:v.name,value:null===(x=ei.customer[0])||void 0===x?void 0:null===(f=x.account)||void 0===f?void 0:f.id},location:{label:ei.name,value:ei.id}}})})),(0,o.jsxs)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"slas"},tz),{children:[(0,o.jsxs)(b.m,{value:Q,onChange:en,children:[(0,o.jsx)(y.O,{value:"slas-work-order",label:"Details"}),(0,o.jsx)(y.O,{value:"slas-quote",label:"Finances"})]}),!E&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:Q,index:"slas-work-order"},tz),{children:(0,o.jsx)(eP.H,{title:"Work Order SLAs",subtype:"reactive",isEntity:!0,isLocation:!0,customerId:null===(C=ei.customer[0])||void 0===C?void 0:null===(I=C.account)||void 0===I?void 0:I.id,entity:"Location",entityId:ei.id,containerHeight:"calc(100vh - 180px)"})})),!E&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:Q,index:"slas-quote"},tz),{children:(0,o.jsx)(eP.H,{title:"Quote SLAs",subtype:"quote",isEntity:!0,isLocation:!0,customerId:null===(S=ei.customer[0])||void 0===S?void 0:null===(A=S.account)||void 0===A?void 0:A.id,entity:"Location",entityId:ei.id,containerHeight:"calc(100vh - 180px)"})}))]})),!E&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"services"},tz),{children:(0,o.jsx)(eD.J,{entity:"Location",entityId:ei.id})})),(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"work-orders"},tz),{children:(0,o.jsx)(eF.A,{columnVisibilityModel:{customerNet:(!O||E)&&B,amountOutstanding:(!O||E)&&B},filtersVisibilityModel:{customer:!1,user:R("customer"),supplier:R("admin"),location:!1,manager:!1,customerManager:!1,accountManager:!1},entityRelationToFetch:{locationId:ei.id},initialFilters:{startDate:null,endDate:null,status:null,locationId:null,supplierId:null,filterType:"locations_work_orders_tab"}})})),(!(!H&&O)||E&&H)&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"quotes"},tz),{children:(0,o.jsx)(eL.J,{FiltersComp:eE.r,initialFilters:{customerId:null,supplierId:null,status:null,id:null,locationId:ei.id,filterType:"location_quotes"},TableComp:e$.v})})),!E&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"compliance"},tz),{children:(0,o.jsx)(tB,{location:{id:ei.id,name:ei.name}})})),!E&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"tenants"},tz),{children:(0,o.jsx)(nn,{filters:{locationId:ei.id}})})),!(!W&&O)&&(0,o.jsx)(Z.x,(0,i.Z)((0,a.Z)({value:V,index:"planned-maintenance"},tz),{label:"Planned Maintenance",children:(0,o.jsx)(j.A,{locationId:ei.id,locationName:ei.name,hideItems:E,hideFinances:E,calendarInitialFilters:{filterType:"location_".concat(ei.id),locationId:ei.id},hideCalendarFilters:["location"],tableInitialFilters:{filterType:"location_".concat(ei.id),locationId:ei.id},hideTableFilters:["location"],itemsInitialFilters:{locationId:ei.id,filterType:"location_".concat(ei.id)},hideItemsFilters:["location","complianceCategory"]})}))]})},tz={sx:{height:"calc(100% - 44px)"},boxSx:{height:"100%"}},tQ=function(){var e=(0,w.x)().user,n=(0,s.useRouter)().query;return n.id?"supplier"===e.accountType?(0,o.jsx)(C,{propertyId:n.id}):(0,o.jsx)(tU,{propertyId:+n.id}):c().push("/404")},tG=tQ;tQ.getLayout=function(e){return(0,o.jsx)(S.Z,{children:e})}}},function(e){e.O(0,[3662,367,1069,6898,9809,2283,212,8890,9511,2583,6310,4599,4135,8579,4244,7645,3776,1564,2329,778,3054,1023,3911,1417,9957,6540,1870,5037,8062,1352,4043,2429,1207,5117,9313,4211,3704,1121,8495,2461,5926,4594,1050,6043,3977,4716,8359,6557,6937,5427,3762,4664,3057,1650,825,2619,9223,1913,9591,6257,8565,9774,2888,179],function(){return e(e.s=35576)}),_N_E=e.O()}]);