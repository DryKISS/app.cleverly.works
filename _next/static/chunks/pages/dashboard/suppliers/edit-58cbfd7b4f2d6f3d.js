(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6199],{22910:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/suppliers/edit",function(){return t(53670)}])},54577:function(e,n,t){"use strict";t.d(n,{C:function(){return u},w:function(){return a}});var r=t(26042),u=function(e){return e=(0,r.Z)({},e.supplierDetails,e)},a=function(e,n){var t=e.assignedUser,r=e.coverage,u=e.service,a=e.status,i=e.q,s={type:{_eq:"supplier"}};return t&&(s.managerId={_eq:n.id}),u&&(s.Services={Service:{id:{_eq:u.value}}}),r&&(s.PostcodeAreas={postcodeAreaId:{_eq:r.value}}),a&&(s.status={_eq:a.value}),i&&(s.name={_ilike:i}),s}},53670:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return S}});var r=t(85893),u=t(19076),a=t(47568),i=t(26042),s=t(69396),o=t(828),c=t(97582),l=t(67294),d=t(6812),p=t(50319),f=t(39710),v=t(11163),m=t.n(v),_=t(53767),h=t(73987),g=t(44666),y=t(54577),I=t(894),b=t(19192),C=t(67797),w=t(49010),x=t(45698),q=function(){var e=(0,_.q)(),n=(0,l.useContext)(h.Z).user,t=(0,v.useRouter)().query,u=(0,l.useState)(!1),q=u[0],S=u[1],E=(0,l.useState)([]),N=E[0],Z=E[1],k=(0,l.useState)(!1),A=k[0],D=k[1],O=(0,l.useState)(!1),R=O[0],j=O[1],X=(0,o.Z)((0,C.d)(),2),P=X[0],z=X[1],F=(0,b.RM)(n.id),T=(0,d.a)(f.R7,{variables:{id:t.id}}),B=T.loading,G=T.data,H=(void 0===G?{supplier:{}}:G).supplier,M=(0,b.BR)({adminId:n.id,xeroClientId:t.clientId||null},[e.admin]),U=M.onCallAuthorize,V=M.onGetXeroContacts;(0,l.useEffect)(function(){var e,n=(e=(0,a.Z)(function(e){var n,t;return(0,c.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,V(e)];case 1:return t=n.sent().map(function(e){return{label:"".concat(e.name," - ").concat(e.contactID),value:e.contactID}}),D(!1),Z(t),[3,3];case 2:return n.sent(),D(!0),[3,3];case 3:return[2]}})}),function(n){return e.apply(this,arguments)});(null==F?void 0:F.companyId)&&n(F.companyId)},[null==F?void 0:F.companyId]);var J,K=(0,o.Z)((0,p.D)(f.D7,{onCompleted:function(e){var n=e.update_Account_by_pk.id;m().push("".concat("/dashboard/suppliers/","view?id=").concat(n))}}),1)[0],L=(J=(0,a.Z)(function(e){var n,t;return(0,c.__generator)(this,function(u){switch(u.label){case 0:if(u.trys.push([0,,2,3]),!(0,w.b)(e.vatId)&&!R)return[2,z({content:function(e){var n=e.onClose;return(0,r.jsx)(x.F,{onCancel:n,onConfirm:function(){j(!0),n()}})}})];return S(!0),t={supplierId:H.id,supplier:{managerId:e.managerSelected.value,name:e.name,website:e.website||null,companyNumber:e.companyNumber||null,vatId:e.vatId||null,status:e.status},supplierDetails:{typeOfOrganisation:e.typeOfOrganisation||null,quotingEmail:e.quotingEmail||null,utrNumber:e.utrNumber||null,cisRegistered:e.cisRegistered||null}},(null===(n=e.xeroContact)||void 0===n?void 0:n.value)&&(t.supplier.meta=(0,s.Z)((0,i.Z)({},H.meta),{xeroContactId:e.xeroContact.value,xeroAssignedCompanyId:null==F?void 0:F.companyId})),[4,K({variables:t})];case 1:return u.sent(),[3,3];case 2:return S(!1),[7];case 3:return[2]}})}),function(e){return J.apply(this,arguments)}),Q=function(){U(window.location.href)};return(0,r.jsxs)(r.Fragment,{children:[P,!B&&(0,r.jsx)(g.P,{loading:q,account:(0,y.C)(H),onSubmit:L,schema:I.f,type:"supplier",displayXeroContacts:!!(null==F?void 0:F.clientId),xeroContacts:N,displaySignin:A,handleXeroAuthorize:Q})]})},S=function(){return(0,r.jsx)(u.Z,{pageHeading:{heading:"Suppliers - Edit"},View:(0,r.jsx)(q,{})})}}},function(e){e.O(0,[3662,2283,212,8890,9511,2583,6310,4599,7645,3776,3054,1417,4043,6210,7493,4666,3261,9774,2888,179],function(){return e(e.s=22910)}),_N_E=e.O()}]);