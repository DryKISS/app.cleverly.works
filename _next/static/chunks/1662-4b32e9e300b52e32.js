"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1662],{97637:function(n,e,t){t.d(e,{G:function(){return M}});var o=t(26042),r=t(69396),i=t(7297),a=t(85893),c=t(67294),s=t(45697),u=t(6812),d=t(92711),l=t(10367),m=t(78289),h=t(41564),p=t(34953),f=t(62466),g=t(68956),v=t(73373),Z=t(11585),x=t(18678),y=t(55377),I=t(16551),_=t(77439),b=t(74297),j=t(11013),w=t(3770),C=t(452),$=t(71072),A=t(87336),q=t(12632),U=t(74944);function P(){var n=(0,i.Z)(["\n  width: 24px;\n"]);return P=function(){return n},n}function S(){var n=(0,i.Z)(["\n  border: 1px solid #eee;\n"]);return S=function(){return n},n}var M=function(n){var e=n.carousel,t=n.category,i=n.children,s=n.data,l=(n.details,n.entity),P=n.entityId,S=n.filters,M=(n.limit,n.listView),T=n.mediaMeta,R=n.onMediaAdd,F=n.onMediaRemove,D=(n.pagination,n.showActionButtons),z=n.showEntityColumn,E=n.showItemActions,G=n.summary,O=n.type,H=(0,q.x)({filters:S}),B=H.initialData,N=H.ref,W=(0,U.x)(),Q=W.hasRole,V=W.user,J=(0,c.useContext)(m.Z),X=(0,u.a)(d.t,{variables:(0,r.Z)((0,o.Z)({},B),{entity:l,entityId:P,category:t,adminId:V.adminId,meta:T})}),Y=X.data,K=void 0===Y?{items:[],meta:{aggregate:{totalCount:0}}}:Y,nn=K.items,ne=K.meta,nt=X.loading,no=X.refetch,nr=function(n){J.close(),s.length||no(),R&&R(n)},ni=function(n){J.close(),s.length||no(),F&&F(n)},na=function(n){n.stopPropagation(),J.show({content:(0,a.jsx)(C.z,{accept:"image/*",adminId:V.adminId,category:t,entity:l,entityId:P,expiryShow:!1,mediaMeta:T,multiple:!0,onSuccess:nr,type:"image"}),title:"Upload Photos"})},nc=function(n){n.stopPropagation(),J.show({content:(0,a.jsx)(C.z,{accept:".pdf, .doc, .docx, .xlsx",adminId:V.adminId,category:t,entity:l,entityId:P,expiryShow:!1,mediaMeta:T,onSuccess:nr,type:"document"}),title:"Upload Documents"})},ns=function(n){J.show({content:(0,a.jsx)(j.d,{mediaId:n.data.id,onSuccess:ni}),submit:!1,title:"Delete Media"})},nu=function(n){J.show({content:(0,a.jsx)(w.z,{media:n.data,toggleShow:J.close}),submit:!1,title:"Media Details",width:"50%"})},nd=[{context:"primary",icon:["fas","info-circle"],onClick:function(n,e){return nu(e)},tooltip:"Details"}];Q("admin")&&nd.push({context:"danger",icon:["fas","trash"],onClick:function(n,e){return ns(e)},tooltip:"Delete"});var nl=[{hidden:!0},{hidden:!0},{hidden:!0,text:"Caption"},{hidden:!1,text:"File"},{hidden:!z,text:"Entity"},{formatter:function(n){var e,t=n.row;return(0,a.jsx)(k,{children:(null==t?void 0:null===(e=t.authority)||void 0===e?void 0:e.adminOnly)&&(0,a.jsx)(h.Z,{content:"Admin user only",children:(0,a.jsx)(p.Z,{alt:"Admin Only",src:"/messaging/admin-only.svg"})})})},text:"",tooltip:"Only Admin can see"},{formatter:(0,f.Z)("/dashboard/users/view","userId","uploaded"),text:"Uploaded by"},{hidden:!M,text:"Thumbnails"},{hidden:!E,formatter:g.Z,formatterData:nd,text:"Actions"}],nm=function(n,e){n.preventDefault(),window.open("".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(e))},nh=[],np=nn.map(function(n){var e=n.entity,t=n.entityId,o=n.id,r=n.item,i=r.caption,c=r.filename,s=r.meta,u=r.name,d=r.type,l=r.user;return{data:r,id:o,userId:null==l?void 0:l.id,file:function(){return(0,a.jsx)(v.Z,{onClick:function(n){return nm(n,c)},children:i||u||c})},entity:e&&"".concat(e,"#").concat(t),authority:s,uploaded:"".concat(null==l?void 0:l.nameFirst," ").concat(null==l?void 0:l.nameLast),thumbnails:(0,$.S)(d,s),actions:""}}),nf=(nn.forEach(function(n){var e=n.item,t=e.caption,o=e.filename;"image"===e.type&&nh.push({caption:t,filename:o})}),nh),ng=nf.length;return(0,a.jsxs)(Z.Z,{fitParentHeight:!0,open:!0,title:G,children:[i,e&&ng>0&&(0,a.jsx)(L,{children:(0,a.jsx)(x.Z,{fullWidth:!0,height:"200px",numberOfItems:1,showNavs:!1,showPagination:!0,slides:nf.map(function(n){var e=n.caption,t=n.filename;return{node:(0,a.jsx)(p.Z,{alt:e,src:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(t)}),text:" "}})})}),(0,a.jsx)(A.t,{columns:nl,loading:nt,fullHeight:!0,paginationSize:!1,meta:ne,ref:N,refetch:no,rows:np}),D&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{size:"sm"}),(0,a.jsxs)(I.Z,{align:"flex-end",children:[(!O||"document"===O)&&!Q("supplier")&&(0,a.jsx)(_.Z,{content:"Add Document",context:"secondary",onClick:nc,size:"sm"}),(!O||"image"===O||"avatar"===O)&&!Q("supplier")&&(0,a.jsx)(_.Z,{content:"Add ".concat((0,b.Z)(O||"Image")),context:"secondary",onClick:na,size:"sm"})]})]})]})},k=l.ZP.div.withConfig({displayName:"table__StyledIcon",componentId:"sc-fc77535-0"})(P()),L=l.ZP.div.withConfig({displayName:"table__StyledCarousel",componentId:"sc-fc77535-1"})(S());M.propTypes={carousel:s.bool,category:s.string,children:s.node,data:s.array,details:s.bool,entity:s.string,entityId:s.number,filters:s.object,limit:s.number,listView:s.bool,mediaMeta:s.object,onMediaAdd:s.func,onMediaRemove:s.func,pagination:s.object,showActionButtons:s.bool,showEntityColumn:s.bool,showItemActions:s.bool,summary:s.string,type:s.string},M.defaultProps={carousel:!0,category:null,data:[],details:!1,filters:{},limit:20,listView:!1,mediaMeta:null,showActionButtons:!0,showEntityColumn:!1,showItemActions:!0,summary:"Media",type:null}},45451:function(n,e,t){t.d(e,{i:function(){return w}});var o=t(14924),r=t(26042),i=t(69396),a=t(85893),c=t(67294),s=t(11163),u=t(45697),d=t.n(u),l=t(61870),m=t(5616),h=t(51233),p=t(15861),f=t(90948),g=t(41796),v=t(29217),Z=t(45111),x=t(98209),y=t(70872),I=t(58886),_=t(61730),b=function(n){var e=n.currentPage,t=n.totalCount,o=n.pageSize,i=n.onPageChange,c=(0,_.Z)("(max-width:400px)"),s=(0,_.Z)("(max-width:500px)");return(0,a.jsx)(j,{mb:2,page:e,count:Math.ceil(t/o),onChange:function(n,e){return i(e)},variant:"outlined",shape:"rounded",size:c?"small":"medium",hidePrevButton:1===e,hideNextButton:e===Math.ceil(t/o),siblingCount:s?0:1,renderItem:function(n){return(0,a.jsx)(I.Z,(0,r.Z)({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},n))}})};b.defaultProps={currentPage:1,totalCount:0,pageSize:50,onPageChange:function(){}},b.propTypes={currentPage:d().number,totalCount:d().number,pageSize:d().number,onPageChange:d().func};var j=(0,f.ZP)(y.Z)(function(n){var e,t=n.hidePrevButton,i=n.hideNextButton,a=n.theme;return e={},(0,o.Z)(e,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,o.Z)(e,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,o.Z)(e,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,o.Z)(e,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,o.Z)(e,"& button.Mui-selected",(0,r.Z)({color:a.palette.white.main,backgroundColor:a.palette.secondary.main},i?{borderRadius:"0 5px 5px 0"}:{},t?{borderRadius:"5px 0 0 5px"}:{})),e}),w=(0,c.forwardRef)(function(n,e){var t=n.columns,o=n.history,i=n.initialSort,u=n.meta,d=n.refetch,l=n.paginationSize,m=n.containerHeight,f=n.containerMaxHeight,g=n.noResultsMessage,y=n.autoHeight,I=(0,s.useRouter)(),_=I.query,j=void 0===_?{}:_,w=(0,c.useState)(parseInt(null==j?void 0:j.page,10)||1),A=w[0],q=w[1],U=(0,c.useState)(l||x.C1.paginationSize),P=U[0],S=U[1],M=i;M||(M={item:"createdAt",order:"desc"});var k=(0,c.useState)({item:M.item,order:M.order}),L=k[0],T=k[1],R=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=I.query,t=void 0===e?{}:e;if(n>1?t.page=n:delete t.page,!(Object.keys(t).length>0))return{};var o=Object.keys(t).map(function(e){return"page"===e?"".concat(e,"=").concat(n):"".concat(e,"=").concat(t[e])}).join("&");return"?".concat(o)},F=function(){T({item:M.item,order:M.order}),q(1);var n=R();I.push(n),S(l||x.C1.paginationSize)};(0,c.useImperativeHandle)(e,function(){return{currentPage:A,pageSize:P,sort:L,resetPagination:function(){F()}}});var D=function(n){var e=R(n);o&&I.push(e),q(n),!o&&d&&d()},z=function(n){n&&n.field&&n.sort?(T({item:t.find(function(e){return e.field===n.field}).sortName||n.field||n.item||M.item,order:n.sort||n.order||M.order}),d&&d()):(T({item:M.item,order:M.order}),d&&d())};return(0,a.jsxs)(C,{containerHeight:m,containerMaxHeight:f,children:[(0,a.jsx)($,(0,r.Z)({hideFooter:!0,disableColumnMenu:!0,disableSelectionOnClick:!0,autoHeight:y,sortingMode:"server",onSortModelChange:function(n){return z(n[0])},columns:t,pageSize:P,slots:{columnSortedAscendingIcon:function(){return(0,a.jsx)(v.Z,{})},columnSortedDescendingIcon:function(){return(0,a.jsx)(Z.Z,{})},columnUnsortedIcon:function(){return(0,a.jsxs)(h.Z,{alignItems:"center",sx:{width:"33px"},children:[(0,a.jsx)(v.Z,{sx:{marginBottom:"-15px"}}),(0,a.jsx)(Z.Z,{})]})},noResultsOverlay:function(){return(0,a.jsx)(h.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,a.jsx)(p.Z,{children:g})})},noRowsOverlay:function(){return(0,a.jsx)(h.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,a.jsx)(p.Z,{children:g})})}}},n)),u&&Math.ceil(u.aggregate.totalCount/P)>1&&(0,a.jsx)(b,{currentPage:A,totalCount:u.aggregate.totalCount,pageSize:P,onPageChange:D})]})});w.propTypes={history:d().bool,initialSort:d().object,loading:d().bool,meta:d().object,refetch:d().func,paginationSize:d().number,noResultsMessage:d().string,columns:d().array.isRequired,rows:d().array.isRequired,autoHeight:d().bool},w.defaultProps={columns:[],history:!1,loading:!1,rows:[],noResultsMessage:"There are no results.",autoHeight:!0};var C=(0,f.ZP)(m.Z)(function(n){var e;return{height:n.containerHeight,maxHeight:n.containerMaxHeight,display:"flex",flexDirection:"column"}}),$=(0,f.ZP)(l.s)(function(n){var e,t=n.theme,a=n.hideHeader,c=(n.rows,n.loading,n.rowHeight),s=n.isPdf;return e={"--DataGrid-overlayHeight":"40px"},(0,o.Z)(e,"&.MuiDataGrid-root",(0,r.Z)({color:t.palette.black.main,border:"none"},s&&{"@media print":{display:"block"}})),(0,o.Z)(e,"& .MuiDataGrid-main",(0,r.Z)({},s&&{"@media print":{overflow:"visible !important"}})),(0,o.Z)(e,"& .MuiDataGrid-columnHeaders",(0,i.Z)((0,r.Z)({},a&&{display:"none"}),{"& .MuiDataGrid-iconButtonContainer":{visibility:"visible","& .MuiButtonBase-root.MuiIconButton-root":{backgroundColor:"inherit",color:t.palette.black.main,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"}}}})),(0,o.Z)(e,"& .MuiDataGrid-virtualScroller",(0,r.Z)({},a&&{marginTop:"0 !important"},s&&{"@media print":{overflow:"visible !important"}})),(0,o.Z)(e,"& .MuiDataGrid-iconSeparator",{opacity:0}),(0,o.Z)(e,"& .MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,o.Z)(e,"& .MuiButtonBase-root.MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,o.Z)(e,"& .MuiDataGrid-virtualScrollerContent",(0,r.Z)({},s&&{height:"initial !important",minHeight:"initial !important"})),(0,o.Z)(e,"& .MuiDataGrid-virtualScrollerRenderZone",(0,r.Z)({},s&&{position:"relative"})),(0,o.Z)(e,"& .MuiDataGrid-overlayWrapper",(0,o.Z)({},"& .MuiCircularProgress-root",{color:t.palette.secondary.main})),(0,o.Z)(e,"& .MuiDataGrid-row",(0,r.Z)({},s&&{minHeight:"".concat(c,"cm !important"),maxHeight:"".concat(c,"cm !important")})),(0,o.Z)(e,"& .MuiDataGrid-row > .MuiDataGrid-cell",(0,r.Z)({},s&&{minHeight:"".concat(c,"cm !important"),maxHeight:"".concat(c,"cm !important")})),(0,o.Z)(e,"& .MuiDataGrid-columnHeaderCheckbox",(0,o.Z)({},"& .MuiButtonBase-root.MuiCheckbox-root > .MuiSvgIcon-root",(0,o.Z)({color:t.palette.secondary.main},'&[data-testid="CheckBoxOutlineBlankIcon"]',{color:"currentColor"}))),(0,o.Z)(e,"& .MuiDataGrid-row > .MuiDataGrid-cellCheckbox",(0,o.Z)({},"& .MuiButtonBase-root.MuiCheckbox-root > .MuiSvgIcon-root",(0,o.Z)({color:t.palette.secondary.main},'&[data-testid="CheckBoxOutlineBlankIcon"]',{color:"currentColor"}))),(0,o.Z)(e,"& .MuiDataGrid-row.even",{backgroundColor:t.palette.muiLightGray.main,"&:hover, &.Mui-hovered":{backgroundColor:(0,g.Fq)(t.palette.muiLightGray.main,.3),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,g.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,g.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,g.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity)}}}}),e})},87336:function(n,e,t){t.d(e,{t:function(){return u}});var o=t(85893),r=t(67294),i=t(45697),a=t(11163),c=t(98209),s=t(16540),u=(0,r.forwardRef)(function(n,e){var t=n.columns,i=n.history,u=n.initialSort,d=n.loading,l=n.meta,m=n.paginationSize,h=n.refetch,p=n.rowClick,f=n.rows,g=n.xeroPageSize,v=(0,a.useRouter)(),Z=v.query,x=void 0===Z?{}:Z,y=(0,r.useState)(parseInt(null==x?void 0:x.page,10)||1),I=y[0],_=y[1],b=(0,r.useState)(g||c.C1.paginationSize),j=b[0],w=b[1];u||(u={item:"createdAt",order:"desc"});var C=(0,r.useState)({item:u.item,order:u.order}),$=C[0],A=C[1],q=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=v.query,t=void 0===e?{}:e;if(n>1?t.page=n:delete t.page,!(Object.keys(t).length>0))return{};var o=Object.keys(t).map(function(e){return"page"===e?"".concat(e,"=").concat(n):"".concat(e,"=").concat(t[e])}).join("&");return"?".concat(o)},U=function(){A({item:u.item,order:u.order}),_(1);var n=q();v.push(n),w(g||c.C1.paginationSize)};(0,r.useImperativeHandle)(e,function(){return{currentPage:I,pageSize:j,sort:$,resetPagination:function(){U()}}});var P=function(n){var e=q(n);i&&v.push(e),_(n),!i&&h&&h()},S=function(n){n!==c.C1.paginationSize&&(w(n),h&&h())},M=function(n){var e;A({item:n.item,order:n.order}),h&&h()};return(0,o.jsx)(s.Z,{columns:t,loading:d,paginationSize:m,pagination:l&&!0,paginationProps:l&&{currentPage:I,onPageChange:P,onPageSizeChange:S,pageCount:Math.ceil(l.aggregate.totalCount/j),perPage:j},rowClick:p,rows:f,sort:$,setSort:M})});u.propTypes={columns:i.array.isRequired,history:i.bool,initialSort:i.object,loading:i.bool,meta:i.object,refetch:i.func,rowClick:i.func,rows:i.array.isRequired},u.defaultProps={history:!0,loading:!0,paginationSize:!1}},63047:function(n,e,t){t.d(e,{E:function(){return c}});var o,r=t(47568),i=t(97582),a=t(94885),c=(o=(0,r.Z)(function(n,e){var t,o,r,c=arguments;return(0,i.__generator)(this,function(o){switch(o.label){case 0:t=c.length>2&&void 0!==c[2]&&c[2],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.query({query:a.WF,variables:{email:e}})];case 2:if((r=o.sent().data.users)&&r.length>0)return[2,!!t&&r[0]];return[2,!t||null];case 3:return o.sent(),[2,!0];case 4:return[2]}})}),function(n,e){return o.apply(this,arguments)})},87407:function(n,e,t){t.d(e,{H:function(){return W}});var o=t(26042),r=t(69396),i=t(29815),a=t(85893),c=t(67294),s=t(45697),u=t(6812),d=t(42283),l=t(79665),m=t(5616),h=t(69368),p=t(98456),f=t(94054),g=t(56815),v=t(51233),Z=t(50135),x=t(15861),y=t(76600),I=t(49501),_=t(95103),b=t(55563),j=t(90951),w=t(43724),C=t(31765),$=t(828),A=t(16310),q=(0,A.Ry)().shape({nameFirst:(0,A.Z_)().required(),nameLast:(0,A.Z_)().required(),email:(0,A.Z_)().required().email(),phone:(0,A.Z_)().required(),status:(0,A.Z_)().when("$hasRole",function(n,e){return(0,$.Z)(n,1)[0]?e.oneOf(["active","inactive"]).required():e}),invoiceThreshold:(0,A.Rx)().nullable().transform(function(n){return isNaN(n)?null:n}),quoteThreshold:(0,A.Rx)().nullable().transform(function(n){return isNaN(n)?null:n}),role:(0,A.Z_)().when(["$hasRole","$hasOneOwner","accountId"],function(n,e){var t=(0,$.Z)(n,3),o=t[0],r=t[1],i=t[2];return o?r?e.oneOf(["owner"],"Each account must have a designated owner.\n          If you would like to change the account type on this user,\n          please create another user account and designate this new account as an owner."):i&&i.length>0&&e.required():e}),position:(0,A.Z_)().when("accountId",{is:function(n){return n&&n.length>0},then:function(){return(0,A.Z_)()}}),isContact:(0,A.Z_)().when("accountId",{is:function(n){return n&&n.length>0},then:function(){return(0,A.Z_)().oneOf(["yes","no"]).required()}}),location:(0,A.IX)().when("$hasLocation",function(n,e){return(0,$.Z)(n,1)[0]?e.of((0,A.Rx)().integer().required()).required():e})}),U=t(74944),P=t(94885),S=t(12632),M=t(83372),k=t(90878),L=t(50480),T=function(n){var e=n.name,t=n.control,o=n.permissions,r=n.styles;return(0,a.jsxs)(m.Z,{sx:r,children:[(0,a.jsx)(x.Z,{variant:"h6",color:"dark.main",sx:{fontFamily:"Arial, sans-serif, sans-serif",fontWeight:"normal"},children:"Permissions"}),(0,a.jsx)(v.Z,{spacing:1,direction:"row",children:o.map(function(n){return(0,a.jsx)(d.Qr,{name:"".concat(e?e+".":"").concat(n.name),control:t,render:function(e){var t=e.value,o=e.onChange;return(0,a.jsx)(L.Z,{color:"dark.main",control:(0,a.jsx)(h.Z,{color:"secondary",checked:t,onChange:function(n){return o(n.target.checked)}}),label:n.label})}})})})]})};T.defaultProps={permissions:[]},T.propTypes={name:s.string,control:s.object.isRequired,permissions:s.object,styles:s.object};var R={customer_user:[{label:"Job reports",name:"jobReports"},{label:"PPM Schedules",name:"ppmSchedules"},{label:"Quotes",name:"quotes"},{label:"Finances",name:"finances"}]},F=t(7297),D=t(75063);function z(){var n=(0,F.Z)(["\n  query GetUserEditOffCanvas($userId: Int!, $accountId: Int, $includeAccount: Boolean!) {\n    user: User_by_pk(id: $userId) {\n      id\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      accounts: Account_Users(where: { accountId: { _eq: $accountId } })\n        @include(if: $includeAccount) {\n        id\n        role\n        position\n        isContact\n        status\n        modules\n        account: Account {\n          id\n          name\n          type\n        }\n        userLocations: User_Account_Locations {\n          accountLocationId\n        }\n      }\n    }\n  }\n"]);return z=function(){return n},n}function E(){var n=(0,F.Z)(['\n  query FindOwnersByAccount($accountId: Int, $userId: Int) {\n    accountUsers: Account_User(\n      where: { role: { _eq: "owner" }, accountId: { _eq: $accountId }, userId: { _neq: $userId } }\n    ) {\n      id\n      role\n    }\n  }\n']);return E=function(){return n},n}var G=(0,D.Ps)(z()),O=(0,D.Ps)(E()),H=t(45451),B=["customer_user"],N=["customer_user","tenant_user"],W=function(n){var e,t=n.userId,s=n.accountId,$=n.accountType,A=n.submit,L=(0,U.x)(),F=L.hasRole,D=L.user,z=(0,S.x)({filters:{}}),E=z.initialData,W=z.ref,Q=(0,c.useState)(!0),V=Q[0],J=Q[1],X=(0,c.useState)(""),Y=X[0],K=X[1],nn=(0,c.useState)(null),ne=nn[0],nt=nn[1],no=(0,d.cI)({defaultValues:{id:t,accountId:s},resolver:(0,l.S)(q),context:{hasRole:(0,k.t4)($,F),hasLocation:!B.includes(D.role)&&B.includes(Y),hasOneOwner:V}}),nr=no.control,ni=no.errors,na=no.handleSubmit,nc=no.register,ns=no.watch,nu=no.reset,nd=no.setValue,nl=ns("role"),nm=ns("location");(0,c.useEffect)(function(){K("".concat($,"_").concat(nl))},[$,nl]);var nh=(0,u.a)(G,{skip:!t,variables:{userId:t,accountId:s,includeAccount:!!s},onCompleted:function(n){var e,t=n.user,o={id:t.id,accountId:t.accountId,nameFirst:t.nameFirst||"",nameLast:t.nameLast||"",email:t.email||"",phone:t.phone||"",invoiceThreshold:t.invoiceThreshold,quoteThreshold:t.quoteThreshold,role:"",position:"",isContact:"",status:"active",meta:t.meta},r=null===(e=t.accounts)||void 0===e?void 0:e.find(function(n){return n.account.id===s});r&&(o.accountUserId=r.id,o.accountId=r.account.id,o.role=r.role,o.position=r.position,o.isContact=!0===r.isContact?"yes":"no",o.status=r.status,o.location=r.userLocations.map(function(n){return n.accountLocationId}),o.modules=r.modules),nu(o),K("".concat($,"_").concat(o.role)),nt(o.accountUserId)}}),np=nh.data,nf=(void 0===np?{}:np).user,ng=nh.loading;(0,u.a)(O,{skip:!s,variables:{accountId:s,userId:t},onCompleted:function(n){J(!(n.accountUsers.length>0))}});var nv=(0,u.a)(P.ZA,{variables:(0,r.Z)((0,o.Z)({},E),{accountId:s})}),nZ=nv.data,nx=void 0===nZ?{location:[],meta:{aggregate:{totalCount:0}}}:nZ,ny=nx.location,nI=nx.meta,n_=nv.loading,nb=nv.refetch,nj=(0,i.Z)(C.I);switch($){case"supplier":nj.push({text:"Operative",value:"contractor"});break;case"admin":nj.push({text:"Helpdesk",value:"helpdesk"})}var nw={control:nr,errors:ni,register:nc},nC=function(n){A(n,null==nf?void 0:nf.meta)},n$=(0,c.useCallback)(function(n){return function(e){e.target.checked?nd("location",(0,i.Z)(null!=nm?nm:[]).concat([n])):nd("location",nm.filter(function(e){return e!==n}))}},[nm,nd]),nA=(0,c.useMemo)(function(){return[{sortable:!1,minWidth:10,field:"id",headerName:"",renderCell:function(n){var e=n.row;return(0,a.jsx)(h.Z,{color:"secondary",checked:null==nm?void 0:nm.includes(e.id),onChange:n$(e.id)})}},{sortable:!1,flex:1,field:"name",headerName:"Name"},{sortable:!1,flex:1,field:"address",headerName:"Address",renderCell:function(n){var e=n.row;return e.address?(0,a.jsxs)(v.Z,{children:[(0,a.jsx)(x.Z,{children:e.address.addressLine1}),(0,a.jsx)(x.Z,{children:e.address.postCode})]}):(0,a.jsx)(x.Z,{children:"Please add"})}}]},[nm,n$]);if(ng)return(0,a.jsx)(v.Z,{widht:"100%",alignItems:"center",children:(0,a.jsx)(p.Z,{color:"secondary"})});var nq={id:(0,k.t4)($,F)};return(0,a.jsxs)(y.Z,{id:"offCanvasForm",handleSubmit:na(nC),children:[(0,a.jsx)(w.q,(0,o.Z)({},nw)),s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(m.Z,{children:[(0,k.t4)($,F)&&(0,a.jsx)(f.Z,{fullWidth:!0,error:ni.role,children:(0,a.jsxs)(I.Z,{label:"Role",children:[(0,a.jsx)(_.Z,(0,r.Z)((0,o.Z)({},nw),{name:"role",options:nj})),(0,a.jsx)(g.Z,{sx:{margin:0},children:null===(e=ni.role)||void 0===e?void 0:e.message})]})}),(0,a.jsx)(I.Z,{label:"Position / Job title",children:(0,a.jsx)(b.Z,(0,r.Z)((0,o.Z)({},nw),{name:"position"}))}),(0,k.pP)({accountType:$,role:nl,hasRole:F})&&(null==nf?void 0:nf.id)!==D.id&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.Z,{label:"Threshold limit / Invoice",children:(0,a.jsx)(Z.Z,{inputRef:nc,inputProps:{min:0},size:"small",name:"invoiceThreshold",type:"number",sx:{width:"100%",fieldset:{border:"1px solid ".concat(M.Q.COLOUR.dark)}},InputProps:{sx:{input:{padding:"0 0.725rem",height:"2.25rem"}}}})}),(0,a.jsx)(I.Z,{label:"Threshold limit / Quote",children:(0,a.jsx)(Z.Z,{inputRef:nc,inputProps:{min:0},size:"small",name:"quoteThreshold",type:"number",sx:{width:"100%",fieldset:{border:"1px solid ".concat(M.Q.COLOUR.dark)}},InputProps:{sx:{input:{padding:"0 0.725rem",height:"2.25rem"}}}})})]}),(0,a.jsx)(j.Z,(0,r.Z)((0,o.Z)({},nw),{data:[{id:"yes",label:"Yes",value:"yes"},{id:"no",label:"No",value:"no"}],legend:"Contact User",name:"isContact",stacked:!0})),N.includes(Y)&&t!==D.id&&(0,a.jsx)(T,{name:"modules",control:nr,permissions:R[Y],styles:{mb:2}})]}),(0,a.jsx)(m.Z,{children:B.includes(Y)&&t!==D.id&&(0,a.jsxs)(I.Z,{label:"Locations",children:[(0,a.jsx)(H.i,{columnVisibilityModel:nq,columns:nA,loading:n_,meta:nI,ref:W,refetch:nb,rows:ny.map(function(n){var e;return{id:n.accountLocations[0].id,name:n.name,address:null===(e=n.addresses[0])||void 0===e?void 0:e.address}})}),(0,a.jsx)("input",(0,r.Z)((0,o.Z)({},nc("location")),{type:"hidden"}))]})})]}),t&&(0,a.jsx)(b.Z,(0,r.Z)((0,o.Z)({},nw),{name:"id",type:"hidden"})),s&&(0,a.jsx)(b.Z,(0,r.Z)((0,o.Z)({},nw),{name:"accountId",type:"hidden"})),ne&&(0,a.jsx)(b.Z,(0,r.Z)((0,o.Z)({},nw),{name:"accountUserId",type:"hidden"}))]})};W.propTypes={accountType:s.string,defaultValues:s.object,submit:s.func.isRequired}},90878:function(n,e,t){t.d(e,{pP:function(){return u},qF:function(){return c},t4:function(){return s},te:function(){return a}});var o=t(26042),r=t(29815),i=t(53625),a=function(n,e,t){var r={};return n.id?(r.id=parseInt(n.id),r.changes={nameFirst:n.nameFirst,nameLast:n.nameLast,email:n.email,phone:n.phone,meta:(0,o.Z)({},e),invoiceThreshold:n.invoiceThreshold||null,quoteThreshold:n.quoteThreshold||null},n.accountUserId?(r.updateAccountUser=!0,r.accountUserId=parseInt(n.accountUserId),r.accountUserChanges={role:n.role,position:n.position,isContact:"yes"===n.isContact,status:n.status,modules:n.modules}):(r.accountUserId=0,r.updateAccountUser=!1)):(r.role=n.role||"user",r.position=n.position,r.isContact="yes"===n.isContact,r.status=n.status,r.accountId=n.accountId,r.modules=n.modules,t?r.userId=t.id:r.User={data:{nameFirst:n.nameFirst,nameLast:n.nameLast,email:n.email,phone:n.phone,status:n.status,meta:{sendDefaultWelcomeEmail:!0},invoiceThreshold:n.invoiceThreshold||null,quoteThreshold:n.quoteThreshold||null}}),r},c=function(n){return{accountUserId:n.accountUserId,objects:n.location.map(function(e){return{accountUserId:n.accountUserId,accountLocationId:e}})}},s=function(n,e){return"customer"!==n&&"supplier"!==n||e((0,r.Z)(i.td).concat((0,r.Z)(i.Sf),(0,r.Z)(i.n),(0,r.Z)(i.nx)))},u=function(n){var e=n.accountType,t=n.role,o=n.hasRole;return o(["admin_owner","customer_owner","supplier_owner"])?!["admin_owner","customer_owner","supplier_owner"].includes("".concat(e,"_").concat(t)):o(["customer_manager","supplier_manager"])?["admin_user","customer_user","supplier_user"].includes("".concat(e,"_").concat(t)):!!o(["admin_manager"])&&["admin_user","customer_user","supplier_user","customer_manager","supplier_manager"].includes("".concat(e,"_").concat(t))}},39071:function(n,e,t){t.d(e,{P:function(){return L}});var o=t(47568),r=t(26042),i=t(828),a=t(29815),c=t(97582),s=t(85893),u=t(67294),d=t(45697),l=t(11163),m=t.n(l),h=t(66252),p=t(6812),f=t(50319),g=t(94885),v=t(78289),Z=t(73987),x=t(62466),y=t(68956),I=t(26186),_=t(16551),b=t(77439),j=t(11585),w=t(55843),C=t(15214),$=t(87336),A=t(97637),q=t(12632),U=t(87407),P=t(90878),S=t(14651),M=t(63047),k=t(53625),L=function(n){var e,t=n.accountType,d=n.filters,l=(0,h.x)(),L=(0,q.x)({filters:d}),T=L.initialData,R=L.ref,F=(0,u.useContext)(v.Z),D=(0,u.useContext)(Z.Z).user,z=null,E=(0,p.a)(g.fo,{variables:T}),G=E.data,O=void 0===G?{users:[],meta:{aggregate:{totalCount:0}}}:G,H=O.users,B=O.meta,N=E.loading,W=E.refetch,Q=(0,i.Z)((0,f.D)(g.I4,{onCompleted:function(n){F.close(),W()}}),2),V=Q[0],J=Q[1].error,X=(0,i.Z)((0,f.D)(g.AX,{onCompleted:function(n){F.close(),W()}}),2),Y=X[0],K=X[1].error,nn=(0,i.Z)((0,f.D)(g.tW,{onCompleted:function(n){W()}}),2),ne=nn[0],nt=nn[1].error;J&&J.graphQLErrors.forEach(function(n){var e;z=(null===(e=n.extensions)||void 0===e?void 0:e.code)==="constraint-violation"?"Error: a user with this e-mail address already exists":"Error creating user"}),K&&K.graphQLErrors.forEach(function(n){var e;z=(null===(e=n.extensions)||void 0===e?void 0:e.code)==="constraint-violation"?"Error, a user with this e-mail address already exists":"Error updating user"}),nt&&(z="Error getting user`s locations");var no,nr=(e=(0,o.Z)(function(n,e){var t,o,i,a,s;return(0,c.__generator)(this,function(i){switch(i.label){case 0:return[4,(0,M.E)(l,n.email,!0)];case 1:if(t=i.sent(),o=(0,P.te)(n,e,t),!n.id)return[3,2];return Y({variables:(0,r.Z)({},o)}),n.location&&ne({variables:(0,r.Z)({},(0,P.qF)(n))}),[3,4];case 2:return[4,V({variables:{objects:o}})];case 3:s=i.sent().data.insert_Account_User.returning,n.location&&ne({variables:(0,r.Z)({},(0,P.qF)({location:n.location,accountUserId:s[0].id}))}),i.label=4;case 4:return[2]}})}),function(n,t){return e.apply(this,arguments)}),ni=function(n,e){n.stopPropagation(),F.show({content:(0,s.jsx)(U.H,{userId:null==e?void 0:e.id,accountId:null==e?void 0:e.accountId,accountType:t,submit:nr,submitError:z}),title:"Edit user",width:"50%"})},na=function(n){n.stopPropagation(),F.show({content:(0,s.jsx)(U.H,{accountId:d.accountId,accountType:t,submit:nr,submitError:z}),title:"Add user",width:"50%"})},nc=function(n,e){n.stopPropagation(),F.show({content:(0,s.jsx)(A.G,{category:"avatar",entity:"User",entityId:e.id,limit:1,type:"image"}),submit:!1,title:"Upload avatar"})},ns=[{hidden:!0},{text:"Name"},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:d.accountId,formatter:(0,x.Z)("","accountId","account","url"),text:"Account"},{text:"Email Address"},{text:"Contact User",formatter:function(n){var e=n.row;if(n.data,e.accountUser.isContact)return(0,s.jsx)(S.Z,{color:"error"})}},{text:"Phone"},{text:"Position"},{hidden:!0},{hidden:!d.accountId,text:"Role"},{text:"Status"},{text:"Date Added",sortable:!0,sortName:"createdAt"},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{formatter:function(n){var e=n.row,o=n.data;if(("supplier"===t||"customer"===t)&&(D.email===e.email||(0,a.Z)(k.td).concat((0,a.Z)(k.Sf),(0,a.Z)(k.n),(0,a.Z)(k.nx)).includes(D.role))||(0,a.Z)(k.td).concat((0,a.Z)(k.Sf),(0,a.Z)(k.n),(0,a.Z)(k.nx)).includes(D.role))return(0,s.jsx)(y.Z,{row:e,data:o})},formatterData:[{context:"secondary",icon:["fas","edit"],onClick:ni,tooltip:"Edit"},{context:"info",icon:["fas","file-upload"],onClick:nc,tooltip:"Avatar"}],text:"Actions"}],nu=function(n){m().push("".concat("/dashboard/users/","view?id=").concat(n.id))},nd=function(){return(0,s.jsx)(_.Z,{children:(0,s.jsx)(b.Z,{context:"secondary",content:"Edit",onClick:na,size:"sm",children:"Create User"})})};return(0,s.jsxs)(j.Z,{toolbar:d.accountId&&(0,a.Z)(k.td).concat((0,a.Z)(k.Sf),(0,a.Z)(k.n),(0,a.Z)(k.nx)).includes(D.role)&&(0,s.jsx)(nd,{}),open:!0,title:"Users",children:[(0,s.jsx)($.t,{columns:ns,loading:N,meta:B,ref:R,refetch:W,rowClick:nu,rows:(no=[],H.forEach(function(n){var e=null;e=d.accountId?n.accounts.find(function(n){var e;return(null===(e=n.account)||void 0===e?void 0:e.id)===parseInt(d.accountId)}):n.accounts.find(function(n){return null!==n.account});var t={id:n.id,name:"".concat(n.nameFirst," ").concat(n.nameLast),nameFirst:n.nameFirst,nameLast:n.nameLast,accountId:e&&e.account.id,type:e&&e.account.type,email:n.email,account:e?"".concat(e.account.name," (").concat(e.account.type,")"):"-",phone:n.phone,position:(null==e?void 0:e.position)?e.position:"N/A",accountUser:e,role:null==e?void 0:e.role,status:e?e.status:n.status,createdAt:(0,I.Z)(n.createdAt),url:e&&!["admin","tenant"].includes(e.account.type.toLowerCase())?"/dashboard/".concat(null==e?void 0:e.account.type.toLowerCase(),"s/view"):"",invoiceThreshold:n.invoiceThreshold,quoteThreshold:n.quoteThreshold,meta:n.meta,actions:""};no.push(t)}),no)}),z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.Z,{}),(0,s.jsx)(C.Z,{content:z,context:"warning"})]})]})};L.propTypes={accountType:d.string,filters:d.object}},43724:function(n,e,t){t.d(e,{q:function(){return v}});var o=t(26042),r=t(69396),i=t(29815),a=t(85893),c=t(45697),s=t(9270),u=t(62140),d=t(49501),l=t(55563),m=t(70982),h=t(95103),p=t(15897),f=t(74944),g=t(53625),v=function(n){var e=n.errors,t=n.prefix,c=n.register,v=(0,f.x)().hasRole,Z={errors:e,register:c};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(u.Z,{md:6,children:(0,a.jsx)(d.Z,{label:"First name",children:(0,a.jsx)(l.Z,(0,r.Z)((0,o.Z)({},Z),{name:"".concat(t,"nameFirst")}))})}),(0,a.jsx)(u.Z,{md:6,children:(0,a.jsx)(d.Z,{label:"Last name",children:(0,a.jsx)(l.Z,(0,r.Z)((0,o.Z)({},Z),{name:"".concat(t,"nameLast")}))})}),(0,a.jsx)(u.Z,{md:6,children:(0,a.jsxs)(d.Z,{label:"Email",children:[(0,a.jsx)(l.Z,(0,r.Z)((0,o.Z)({},Z),{name:"".concat(t,"email"),type:"email"})),e["".concat(t,"email")]&&"duplicate"===e["".concat(t,"email")].type&&(0,a.jsx)(m.Z,{message:e["".concat(t,"email")].message})]})}),(0,a.jsx)(u.Z,{md:6,children:(0,a.jsx)(d.Z,{label:"Mobile",children:(0,a.jsx)(l.Z,(0,r.Z)((0,o.Z)({},Z),{name:"".concat(t,"phone")}))})})]}),v((0,i.Z)(g.td).concat((0,i.Z)(g.Sf),(0,i.Z)(g.n),(0,i.Z)(g.nx)))&&(0,a.jsx)(d.Z,{label:"Status",children:(0,a.jsx)(h.Z,(0,r.Z)((0,o.Z)({},Z),{name:"".concat(t,"status"),options:p.bg}))}),(0,a.jsx)(l.Z,(0,r.Z)((0,o.Z)({},Z),{name:"".concat(t,"userId"),type:"hidden"}))]})};v.propTypes={errors:c.object.isRequired,prefix:c.string,register:c.func.isRequired},v.defaultProps={prefix:""}},94885:function(n,e,t){t.d(e,{$E:function(){return T},AX:function(){return j},I4:function(){return b},JA:function(){return C},MT:function(){return P},Px:function(){return A},WF:function(){return $},ZA:function(){return D},a8:function(){return q},fA:function(){return L},fo:function(){return w},ge:function(){return F},iM:function(){return k},nE:function(){return S},nh:function(){return M},r1:function(){return U},tW:function(){return z},uz:function(){return R}});var o=t(7297),r=t(75063);function i(){var n=(0,o.Z)(["\n  mutation InsertAccountUser($objects: [Account_User_insert_input!]!) {\n    insert_Account_User(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return i=function(){return n},n}function a(){var n=(0,o.Z)(["\n  mutation UpdateUser(\n    $id: Int!\n    $accountUserId: Int!\n    $accountUserChanges: Account_User_set_input\n    $changes: User_set_input\n    $updateAccountUser: Boolean!\n  ) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _set: $accountUserChanges)\n      @include(if: $updateAccountUser) {\n      id\n    }\n    update_User_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]);return a=function(){return n},n}function c(){var n=(0,o.Z)(["\n  query GetUsers(\n    $accountId: Int\n    $accountType: String\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: User_order_by!\n    $status: String\n  ) {\n    users: User(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [\n          { email: { _ilike: $q } }\n          { nameFirst: { _ilike: $q } }\n          { nameLast: { _ilike: $q } }\n        ]\n        status: { _eq: $status }\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n        userLocations: User_Account_Locations {\n          accountLocationId\n        }\n      }\n    }\n    meta: User_aggregate(\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]);return c=function(){return n},n}function s(){var n=(0,o.Z)(["\n  query GetUser($id: Int!) {\n    user: User_by_pk(id: $id) {\n      id\n      fullName\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]);return s=function(){return n},n}function u(){var n=(0,o.Z)(["\n  query CheckDuplicateEmail($email: String!) {\n    users: User_public(where: { email: { _eq: $email } }) {\n      id\n      nameFirst\n      nameLast\n      email\n      phone\n    }\n  }\n"]);return u=function(){return n},n}function d(){var n=(0,o.Z)(["\n  fragment UserFields on User {\n    id\n    email\n    nameFirst\n    nameLast\n    fullName\n    phone\n    status\n  }\n"]);return d=function(){return n},n}function l(){var n=(0,o.Z)(["\n  mutation SendGoogleAuthCode($code: String!, $id: Int!, $type: String!) {\n    createGoogleToken(code: $code, id: $id, type: $type) {\n      success\n      tokens\n      error\n    }\n  }\n"]);return l=function(){return n},n}function m(){var n=(0,o.Z)(["\n  mutation GenerateMSURL($type: String!, $id: Int!) {\n    genenrateMSURL(id: $id, type: $type) {\n      url\n    }\n  }\n"]);return m=function(){return n},n}function h(){var n=(0,o.Z)(["\n  mutation signoutMS($id: Int!, $type: String!, $email: String!) {\n    signoutMS(id: $id, type: $type, email: $email) {\n      error\n      msId\n      success\n    }\n  }\n"]);return h=function(){return n},n}function p(){var n=(0,o.Z)(["\n  query getAccountMeta($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      meta\n    }\n  }\n"]);return p=function(){return n},n}function f(){var n=(0,o.Z)(["\n  query user($id: Int!) {\n    user: User_by_pk(id: $id) {\n      meta\n      invoiceThreshold\n      quoteThreshold\n    }\n  }\n"]);return f=function(){return n},n}function g(){var n=(0,o.Z)(["\n  query GetAccountUserMeta($userId: Int!, $accountId: Int!) {\n    accountUser: Account_User(where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }) {\n      meta\n    }\n  }\n"]);return g=function(){return n},n}function v(){var n=(0,o.Z)(["\n  mutation UpdateAccountUserByUserIdAccoutId(\n    $userId: Int!\n    $accountId: Int!\n    $changes: Account_User_set_input!\n  ) {\n    update_Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n      _set: $changes\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return v=function(){return n},n}function Z(){var n=(0,o.Z)(["\n  mutation updateAccount($accountId: Int!, $set: Account_set_input!) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $set) {\n      id\n    }\n  }\n"]);return Z=function(){return n},n}function x(){var n=(0,o.Z)(["\n  mutation updateUserMeta($userId: Int!, $meta: jsonb!) {\n    update_User_by_pk(pk_columns: { id: $userId }, _set: { meta: $meta }) {\n      id\n      meta\n    }\n  }\n"]);return x=function(){return n},n}function y(){var n=(0,o.Z)(['\n  query userDevices($accountId: Int!) {\n    users: User(\n      where: {\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        UserDevices: { status: { _eq: "active" } }\n        status: { _eq: "active" }\n      }\n    ) {\n      id\n      fullName\n      devices: UserDevices(\n        order_by: { updatedAt: desc_nulls_last }\n        where: { status: { _eq: "active" } }\n        limit: 1\n      ) {\n        id\n        playerId\n      }\n    }\n  }\n']);return y=function(){return n},n}function I(){var n=(0,o.Z)(['\n  query GetAccountLocations($accountId: Int, $limit: Int, $offset: Int) {\n    location: Location(\n      offset: $offset\n      limit: $limit\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      id\n      name\n      accountLocations: Account_Locations {\n        id\n      }\n      addresses: Addresses(where: { entity: { _eq: "Location" }, registered: { _eq: true } }) {\n        id\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          postCode\n        }\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']);return I=function(){return n},n}function _(){var n=(0,o.Z)(["\n  mutation InsertUserAccountLocations(\n    $accountUserId: Int!\n    $objects: [User_Account_Location_insert_input!]!\n  ) {\n    delete_User_Account_Location(where: { accountUserId: { _eq: $accountUserId } }) {\n      affected_rows\n    }\n    insert_User_Account_Location(objects: $objects) {\n      affected_rows\n      returning {\n        id\n      }\n    }\n  }\n"]);return _=function(){return n},n}var b=(0,r.Ps)(i()),j=(0,r.Ps)(a()),w=(0,r.Ps)(c()),C=(0,r.Ps)(s()),$=(0,r.Ps)(u()),A=(0,r.Ps)(d()),q=(0,r.Ps)(l()),U=(0,r.Ps)(m()),P=(0,r.Ps)(h()),S=(0,r.Ps)(p()),M=(0,r.Ps)(f()),k=(0,r.Ps)(g()),L=(0,r.Ps)(v()),T=(0,r.Ps)(Z()),R=(0,r.Ps)(x()),F=(0,r.Ps)(y()),D=(0,r.Ps)(I()),z=(0,r.Ps)(_())},22378:function(n,e,t){t.d(e,{Y:function(){return r},l:function(){return o}});var o=[{text:"Account Type",value:""},{text:"Admin",value:"admin"},{text:"Customer",value:"customer"},{text:"Supplier",value:"supplier"},{text:"Tenant",value:"tenant"}],r=function(n){return[{icon:"edit",tooltip:"Edit",to:"/dashboard/".concat(n.type,"s/").concat("supplier"===n.type?"edit":"manage","?id=").concat(n.id)}]}},15897:function(n,e,t){t.d(e,{bg:function(){return o}});var o=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}]},31765:function(n,e,t){t.d(e,{I:function(){return o}});var o=[{text:"Select Role",value:""},{text:"Owner",value:"owner"},{text:"Manager",value:"manager"},{text:"User",value:"user"}]}}]);