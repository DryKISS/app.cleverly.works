"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4666],{44666:function(e,n,t){t.d(n,{P:function(){return B}});var a=t(26042),r=t(69396),o=t(85893),i=t(67294),l=t(45697),s=t(42283),u=t(79665),c=t(76600),d=t(11585),m=t(9270),p=t(62140),v=t(49501),b=t(55563),y=t(95103),h=t(84043),x=t(58594),g=t(18531),f=t(31113),Z=t(59379),T=t(536),C=t(19664),j=function(e){var n,t={errors:e.errors,register:e.register};return(0,o.jsxs)(m.Z,{children:[(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"Type Of organisation",children:(0,o.jsx)(y.Z,(0,r.Z)((0,a.Z)({},t),{name:"typeOfOrganisation",options:C.E}))})}),(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"Quoting Email",children:(0,o.jsx)(b.Z,(0,r.Z)((0,a.Z)({},t),{name:"quotingEmail",type:"email"}))})}),(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"UTR Number",children:(0,o.jsx)(b.Z,(0,r.Z)((0,a.Z)({},t),{name:"utrNumber"}))})}),(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"CIS registration number",children:(0,o.jsx)(b.Z,(0,r.Z)((0,a.Z)({},t),{name:"cisRegistered"}))})})]})};j.propTypes={errors:l.object.isRequired,register:l.func.isRequired};var I=t(43724),A=t(85568),q=t(15897),S=t(74944),_=t(20390),R=t(11057),O=t(5616),E=t(98456),P=t(49010),$=t(73583),L=t(69368),N=t(96486),B=function(e){var n=e.account,t=e.displayXeroContacts,l=void 0!==t&&t,C=e.xeroContacts,B=e.displaySignin,U=e.handleXeroAuthorize,w=e.onSubmit,k=e.schema,M=e.type,D=e.loading,J=(0,S.x)(),V=J.hasRole,F=J.user,Q=(0,i.useState)(!1);Q[0],Q[1];var G=(0,i.useState)(""),z=G[0],W=G[1],H=null==C?void 0:C.find(function(e){var t;return e.value===(null==n?void 0:null===(t=n.meta)||void 0===t?void 0:t.xeroContactId)}),X=(0,r.Z)((0,a.Z)({},n),{availableCharts:null!==(et=null==n?void 0:null===(ee=n.meta)||void 0===ee?void 0:ee.availableCharts)&&void 0!==et?et:[],xeroContact:H}),Y="Assign",K="Assigned To";if(("customer"===M||"admin"===M)&&(X.contactUsernameFirst=null===(ea=null==n?void 0:n.contactUsers[0])||void 0===ea?void 0:null===(er=ea.user)||void 0===er?void 0:er.nameFirst,X.contactUsernameLast=null===(eo=null==n?void 0:n.contactUsers[0])||void 0===eo?void 0:null===(ei=eo.user)||void 0===ei?void 0:ei.nameLast,X.contactUseremail=null===(el=null==n?void 0:n.contactUsers[0])||void 0===el?void 0:null===(es=el.user)||void 0===es?void 0:es.email,X.contactUserphone=null===(eu=null==n?void 0:n.contactUsers[0])||void 0===eu?void 0:null===(ec=eu.user)||void 0===ec?void 0:ec.phone,X.contactUserstatus=null===(ed=null==n?void 0:n.contactUsers[0])||void 0===ed?void 0:null===(em=ed.user)||void 0===em?void 0:em.status,X.contactUseruserId=null===(ep=null==n?void 0:n.contactUsers[0])||void 0===ep?void 0:null===(ev=ep.user)||void 0===ev?void 0:ev.id,Y="Manager",K="Account manager"),"admin"===M){var ee,en,et,ea,er,eo,ei,el,es,eu,ec,ed,em,ep,ev,eb,ey,eh,ex,eg,ef,eZ,eT=null==n?void 0:null===(eb=n.meta)||void 0===eb?void 0:eb.timeZone;X.timeZone=eT||{value:"Europe/London",label:"Europe/London +00:00"},X.modules=[],(null==n?void 0:null===(ey=n.meta)||void 0===ey?void 0:ey.modules)&&Object.keys(n.meta.modules).forEach(function(e){!0===n.meta.modules[e]&&X.modules.push(e)}),X.mediaVisibility={},(null==n?void 0:null===(eh=n.meta)||void 0===eh?void 0:eh.mediaVisibility)&&(X.mediaVisibility={admin:null===(ex=n.meta.mediaVisibility)||void 0===ex?void 0:ex.admin,customer:null===(eg=n.meta.mediaVisibility)||void 0===eg?void 0:eg.customer,supplier:null===(ef=n.meta.mediaVisibility)||void 0===ef?void 0:ef.supplier,tenant:null===(eZ=n.meta.mediaVisibility)||void 0===eZ?void 0:eZ.tenant})}var eC=(0,s.cI)({defaultValues:X,resolver:(0,u.S)(k())}),ej=eC.control,eI=eC.errors,eA=eC.setValue,eq=eC.handleSubmit,eS=eC.register,e_=eC.watch,eR=e_("vatId");(0,P.b)(eR);var eO=e_("modules"),eE={control:ej,errors:eI,register:eS};return((0,i.useEffect)(function(){l&&C.length&&eA("xeroContact",null==C?void 0:C.find(function(e){var t;return e.value===(null==n?void 0:null===(t=n.meta)||void 0===t?void 0:t.xeroContactId)}))},[null==n?void 0:null===(en=n.meta)||void 0===en?void 0:en.xeroContactId,l,eA,C]),D)?(0,o.jsx)(O.Z,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,o.jsx)(E.Z,{})}):(0,o.jsxs)(c.Z,{handleSubmit:eq(w),children:[(null==n?void 0:n.type)!=="superadmin"&&(0,o.jsx)(d.Z,{open:!0,title:Y,children:(0,o.jsx)(m.Z,{children:(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(T.P,(0,r.Z)((0,a.Z)({},eE),{accountId:F.accountId,errors:(0,a.Z)({},eI),label:K,name:"managerSelected",type:"user"}))})})}),(0,o.jsx)(d.Z,{open:!0,title:"Company",children:(0,o.jsxs)(m.Z,{children:[(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"Name",children:(0,o.jsx)(b.Z,(0,r.Z)((0,a.Z)({},eE),{name:"name"}))})}),(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"Website",children:(0,o.jsx)(b.Z,(0,r.Z)((0,a.Z)({},eE),{name:"website"}))})}),(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"Company Number",children:(0,o.jsx)(b.Z,(0,r.Z)((0,a.Z)({},eE),{name:"companyNumber"}))})}),(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"VAT ID",children:(0,o.jsx)(b.Z,(0,r.Z)((0,a.Z)({},eE),{name:"vatId"}))})}),(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"Status",children:(0,o.jsx)(y.Z,(0,r.Z)((0,a.Z)({},eE),{name:"status",options:q.bg}))})})]})}),"admin"===M&&(0,o.jsxs)(d.Z,{open:!0,title:"Admin Settings",children:[(0,o.jsx)(m.Z,{children:(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(v.Z,{label:"Client Type",children:(0,o.jsx)(h.Z,(0,r.Z)((0,a.Z)({options:(0,Z.r)()},eE),{name:"timeZone"}))})})}),V("superadmin")&&(0,o.jsx)(m.Z,{children:(0,o.jsx)(p.Z,{md:12,children:(0,o.jsx)(x.Z,(0,r.Z)((0,a.Z)({},eE),{data:A.o,legend:"Modules",name:"modules"}))})}),V("superadmin")&&eO.includes("dataCharts")&&(0,o.jsx)(O.Z,{sx:{width:"300px"},children:(0,o.jsx)(s.Qr,{name:"availableCharts",control:ej,render:function(e){var n,t=e.value,a=e.onChange;return(0,o.jsx)(g.q,{value:t||[],onChange:function(e,n){return a(n)},multiple:!0,limitTags:1,setSearch:W,textFieldProps:{color:"secondary",variant:"standard",label:"Select available charts",error:!!eI.availableCharts,helperText:null===(n=eI.availableCharts)||void 0===n?void 0:n.message},options:A.O.filter(function(e){return e.label.toLowerCase().includes(z.toLowerCase())})})}})})]}),"admin"===M&&V("superadmin")&&(0,o.jsx)(d.Z,{open:!0,title:"Media Visibility",children:(0,o.jsxs)(m.Z,{children:[(0,o.jsx)(p.Z,{md:3,children:(0,o.jsx)(s.Qr,{name:"mediaVisibility.admin",control:ej,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(g.q,{multiple:!0,limitTags:1,value:n||[],onChange:function(e,n){return t(n)},options:$.d.admin,size:"small",textFieldProps:{label:"Admin media visibility",color:"secondary"},isOptionEqualToValue:function(e,n){return N.isEqual(e.value,n.value)},renderOption:function(e,n,t){var l=t.selected;return(0,i.createElement)("li",(0,r.Z)((0,a.Z)({},e),{key:n.value,children:[(0,o.jsx)(L.Z,{color:"secondary",style:{height:10,marginRight:8},checked:l}),n.label]}))}})}})}),(0,o.jsx)(p.Z,{md:3,children:(0,o.jsx)(s.Qr,{name:"mediaVisibility.customer",control:ej,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(g.q,{multiple:!0,limitTags:1,value:n||[],onChange:function(e,n){return t(n)},options:$.d.customer,size:"small",textFieldProps:{label:"Customer media visibility",color:"secondary"},isOptionEqualToValue:function(e,n){return N.isEqual(e.value,n.value)},renderOption:function(e,n,t){var l=t.selected;return(0,i.createElement)("li",(0,r.Z)((0,a.Z)({},e),{key:n.value,children:[(0,o.jsx)(L.Z,{color:"secondary",style:{height:10,marginRight:8},checked:l}),n.label]}))}})}})}),(0,o.jsx)(p.Z,{md:3,children:(0,o.jsx)(s.Qr,{name:"mediaVisibility.supplier",control:ej,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(g.q,{multiple:!0,limitTags:1,value:n||[],onChange:function(e,n){return t(n)},options:$.d.supplier,size:"small",textFieldProps:{label:"Supplier media visibility",color:"secondary"},isOptionEqualToValue:function(e,n){return N.isEqual(e.value,n.value)},renderOption:function(e,n,t){var l=t.selected;return(0,i.createElement)("li",(0,r.Z)((0,a.Z)({},e),{key:n.value,children:[(0,o.jsx)(L.Z,{color:"secondary",style:{height:10,marginRight:8},checked:l}),n.label]}))}})}})}),(0,o.jsx)(p.Z,{md:3,children:(0,o.jsx)(s.Qr,{name:"mediaVisibility.tenant",control:ej,render:function(e){var n=e.value,t=e.onChange;return(0,o.jsx)(g.q,{multiple:!0,limitTags:1,value:n||[],onChange:function(e,n){return t(n)},options:$.d.tenant,size:"small",textFieldProps:{label:"Tenant media visibility",color:"secondary"},isOptionEqualToValue:function(e,n){return N.isEqual(e.value,n.value)},renderOption:function(e,n,t){var l=t.selected;return(0,i.createElement)("li",(0,r.Z)((0,a.Z)({},e),{key:n.value,children:[(0,o.jsx)(L.Z,{color:"secondary",style:{height:10,marginRight:8},checked:l}),n.label]}))}})}})})]})}),"customer"===M&&(0,o.jsx)(d.Z,{open:!0,title:"Customer",children:(0,o.jsx)(m.Z,{children:(0,o.jsx)(p.Z,{md:6,children:(0,o.jsx)(_.l,(0,r.Z)((0,a.Z)({},eE),{label:"Customer Type",name:"clientType",type:"clientType"}))})})}),"supplier"===M&&(0,o.jsx)(d.Z,{open:!0,title:"Supplier",children:(0,o.jsx)(j,(0,a.Z)({},eE))}),l&&(0,o.jsx)(d.Z,{open:!0,title:"Xero User Sync",children:(0,o.jsx)(p.Z,{md:12,children:(0,o.jsx)(v.Z,{label:"Xero Contact",children:B?(0,o.jsx)(R.Z,{variant:"contained",onClick:function(){U()},children:"Connect to Xero to select Contact"}):(0,o.jsx)(h.Z,(0,r.Z)((0,a.Z)({options:C},eE),{name:"xeroContact"}))})})}),(!n||"customer"===M||"admin"===M)&&(0,o.jsxs)(d.Z,{open:!0,title:"Contact User",children:[(0,o.jsx)(I.q,(0,r.Z)((0,a.Z)({},eE),{prefix:"contactUser"})),(0,o.jsx)(b.Z,(0,r.Z)((0,a.Z)({},eE),{defaultValue:"true",name:"contactUser",type:"hidden"}))]}),(0,o.jsx)(f.H,{content:"Submit",type:"submit"})]})};B.propTypes={account:l.object,onSubmit:l.func.isRequired,schema:l.func.isRequired,type:l.string.isRequired,loading:l.bool,xeroContacts:l.array,displaySignin:l.bool,handleXeroAuthorize:l.func}},18531:function(e,n,t){t.d(n,{q:function(){return v}});var a=t(26042),r=t(69396),o=t(99534),i=t(85893),l=t(87918),s=t(98456),u=t(23776),c=t(50135),d=t(67294),m=t(45697),p=t.n(m),v=function(e){var n=e.loading,t=e.setSearch,m=e.textFieldProps,p=(e.disableClearable,(0,o.Z)(e,["loading","setSearch","textFieldProps","disableClearable"])),v=(0,d.useState)(""),b=v[0],y=v[1];return(0,d.useEffect)(function(){var e=setTimeout(function(){t(b)},500);return function(){return clearTimeout(e)}},[b,t]),(0,i.jsx)(u.Z,(0,r.Z)((0,a.Z)({isOptionEqualToValue:function(e,n){return e.value===n.value}},p),{loading:n,onInputChange:function(e,n){y(n)},getOptionLabel:function(e){return"".concat(e.label)},renderTags:function(e,n){return e.map(function(e,t){return(0,i.jsx)(l.Z,(0,a.Z)({size:"small",label:e.label},n({index:t})))})},renderInput:function(e){return(0,i.jsx)(c.Z,(0,r.Z)((0,a.Z)({},e,m),{InputProps:(0,r.Z)((0,a.Z)({},e.InputProps,m.InputProps||{}),{endAdornment:(0,i.jsxs)(i.Fragment,{children:[n?(0,i.jsx)(s.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}}))};v.defaultProps={color:"secondary",onChange:function(){},options:[],onOpen:function(){},setSearch:function(){},textFieldProps:{}},v.propTypes={multiple:p().bool,limitTags:p().number,filterSelectedOptions:p().bool,color:p().string,loading:p().bool,value:p().oneOf([p().array,p().object]),onChange:p().func,options:p().arrayOf(p().shape({value:p().any.isRequired,label:p().string.isRequired})).isRequired,onOpen:p().func,setSearch:p().func,textFieldProps:p().shape({label:p().string,variant:p().oneOf(["standard"]),color:p().string,error:p().bool,helperText:p().string})}},31113:function(e,n,t){t.d(n,{H:function(){return u}});var a=t(26042),r=t(85893),o=t(45697),i=t(55377),l=t(16551),s=t(77439),u=function(e){var n=e.children,t=e.content,o=e.context,u=e.data,c=e.disabled,d=e.handleClick,m=e.size,p=e.type;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{size:"sm"}),(0,r.jsxs)(l.Z,{align:"flex-end",children:[n,(0,r.jsx)(s.Z,(0,a.Z)({content:t,context:o,disabled:c,onClick:d,size:m,type:p},u))]})]})};u.propTypes={children:o.node,content:o.string,context:o.string,data:o.object,disabled:o.bool,handleClick:o.func,size:o.string,type:o.string},u.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},59379:function(e,n,t){t.d(n,{r:function(){return o}});var a=t(22091).ZP.getAllTimezones(),r=Object.keys(a).map(function(e){return a[e]}),o=function(){return r.map(function(e){return{label:"".concat(e.name," ").concat(e.utcOffsetStr),value:e.name}})}},536:function(e,n,t){t.d(n,{P:function(){return I}});var a=t(47568),r=t(26042),o=t(69396),i=t(99534),l=t(7297),s=t(97582),u=t(85893),c=t(67294),d=t(45697),m=t(10367),p=t(66252),v=t(57493),b=t(78289),y=t(52019),h=t(49501),x=t(9270),g=t(62140),f=t(84043),Z=t(77439);function T(){var e=(0,l.Z)(["\n  position: relative;\n  right: 25px;\n  top: 2px;\n"]);return T=function(){return e},e}var C=function(e,n){var t,a,r,o=!0;return(null===(t=e.errors[e.name])||void 0===t?void 0:t.message)!==(null===(a=n.errors[n.name])||void 0===a?void 0:a.message)&&(o=!1),["accountId","assetCategoryId","entity","entityId","locationId","serviceId","type","value","customerId","customerRole"].forEach(function(t){e[t]!==n[t]&&(o=!1)}),o},j=function(e){var n=e.accountId,t=e.area,a=e.assetCategoryId,r=e.entity,o=e.entityId,i=(e.hasRole,e.id),l=e.locationId,s=e.serviceId,u=e.taxonomyGroupType,c=e.customerId,d=e.customerRole,m=e.type,p=e.userId,b=e.invoiceThreshold,y=e.quoteThreshold,h=m;switch(d&&(h="".concat(m,"_").concat(d)),h){case"address":return{query:v.cz,variables:{entity:r,entityId:o}};case"asset":return{query:v.UH,variables:{categoryId:a,locationId:l}};case"assetBookable":return{query:v.UH,variables:{categoryId:a,locationId:l,bookable:"yes"}};case"assetCategory":return{query:v.nD,variables:{id:i}};case"assetSublocation":return{query:v.UH,variables:{category:"sublocation",adminId:n,locationId:l}};case"coverage":return{query:v.j$};case"customer":return{query:v.SW};case"job":return{query:v.Qn,variables:{locationId:l}};case"manager":return{query:v.he,variables:{accountId:n,userId:p}};case"thresholdManagers":return{query:v.Ak,variables:{accountId:n,userId:p,invoiceThreshold:b,quoteThreshold:y}};case"product":return{query:v.UH,variables:{category:"product",locationId:l}};case"property":return{query:v._d,variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:n}}}}};case"property_user":return{query:v._d,variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:n},Account:{type:{_eq:"customer"},Account_Users:{role:{_eq:"user"},userId:{_eq:c}}},User_Account_Locations:{Account_User:{userId:{_eq:c},accountId:{_eq:n}}}}}}};case"sensor":return{query:v.UH,variables:{category:"sensor",locationId:l}};case"service":return{query:v.kx};case"sla":return{query:v.t1,variables:{type:"priority",adminId:n}};case"sublocation":return{query:v.zR,variables:{locationId:l}};case"supplier":var x={type:{_eq:"supplier"}};return t&&(x.PostcodeAreas={PostcodeArea:{area:{_eq:t}},entity:{_eq:"Account"},status:{_eq:"active"}}),s&&(x.ServiceSchedule={status:{_eq:"active"},entity:{_eq:"Supplier"},serviceId:{_eq:s}},t&&(x.ServiceSchedule.PostcodeAreas={PostcodeArea:{area:{_eq:t}}})),{query:v.by,variables:{where:x}};case"user":return{query:v.yR,variables:{accountId:n}};case"usersForBookings":return{query:v.yR,variables:{accountId:p}};case"tenant":return{query:v.RJ};case"taxonomyGroup":return{query:v.Cj,variables:{type:u}};case"expenseCategory":return{query:v.Ve};default:return{query:v.qd}}},I=(0,c.memo)(function(e){var n,t=e.AddForm,l=e.accountId,d=e.area,m=e.assetCategoryId,v=e.control,T=e.entity,C=e.entityId,I=e.errors,q=e.id,S=e.isClearable,_=e.isDisabled,R=e.label,O=e.locationId,E=e.name,P=e.serviceId,$=e.taxonomyGroupType,L=e.customerId,N=e.customerRole,B=e.type,U=e.userId,w=e.invoiceThreshold,k=e.quoteThreshold,M=(0,i.Z)(e,["AddForm","accountId","area","assetCategoryId","control","entity","entityId","errors","id","isClearable","isDisabled","label","locationId","name","serviceId","taxonomyGroupType","customerId","customerRole","type","userId","invoiceThreshold","quoteThreshold"]),D=(0,p.x)(),J=(0,c.useState)(!1),V=J[0],F=J[1],Q=(0,c.useState)(),G=Q[0],z=Q[1],W=(0,c.useState)(!1),H=W[0],X=W[1],Y=(0,c.useContext)(b.Z),K=(0,c.useContext)(y.Z).hasRole,ee=(0,c.useState)(!1),en=ee[0],et=ee[1];(0,c.useEffect)(function(){return et(!1),X(!1),function(){}},[l,m,T,C,O,P,B,L,N,U]);var ea=(n=(0,a.Z)(function(){var e,n,t,a,i,u,c,p;return(0,s.__generator)(this,function(i){switch(i.label){case 0:if(H)return et(!0),[2,null];return F(!0),n=(e=j({accountId:l,area:d,assetCategoryId:m,entity:T,entityId:C,hasRole:K,id:q,locationId:O,serviceId:P,taxonomyGroupType:$,customerId:L,customerRole:N,type:B,userId:U,invoiceThreshold:w,quoteThreshold:k})).query,a=void 0===(t=e.variables)?{}:t,[4,D.query({query:n,variables:(0,r.Z)({},a)})];case 1:var s,c;return s=(void 0===(u=i.sent().data)?{items:[]}:u).items,p="asset"===(c=B)?s.map(function(e){return(0,o.Z)((0,r.Z)({},e),{label:"".concat(e.label," ").concat(e.sublocation?"- ".concat(e.sublocation.name):"")})}):s,z(p),F(!1),X(!0),et(!0),[2]}})}),function(){return n.apply(this,arguments)}),er=function(){Y.show({content:(0,u.jsx)("div",{children:(0,u.jsx)(t,{})}),title:"Add form"})};return(0,u.jsx)(h.Z,{id:E,label:R,children:(0,u.jsxs)(x.Z,{children:[(0,u.jsx)(g.Z,{md:t?11:12,children:(0,u.jsx)(f.Z,(0,r.Z)({autoload:!1,blurInputOnSelect:!0,cacheOptions:!0,control:v,errors:I,isDisabled:_,isClearable:S,isLoading:V,menuIsOpen:en,options:G,onFocus:ea,onBlur:function(){et(!1)},name:E,searchable:!0},M),M.defaultValue)}),t&&(0,u.jsx)(g.Z,{md:1,children:(0,u.jsx)(A,{children:(0,u.jsx)(Z.Z,{content:null,startIcon:"plus",size:"sm",onClick:er})})})]})})},C),A=m.ZP.div.withConfig({displayName:"select__ButtonWrapper",componentId:"sc-f7921e38-0"})(T());I.propTypes={AddForm:d.object,area:d.string,accountId:d.number,assetCategoryId:d.number,control:d.object.isRequired,errors:d.object.isRequired,entity:d.string,entityId:d.number,id:d.number,isClearable:d.bool,label:d.string.isRequired,locationId:d.number,name:d.string.isRequired,serviceId:d.number,taxonomyGroupType:(0,d.oneOf)(["expenseCategory","costCategory","jobTags"]),type:d.string},I.defaultProps={isClearable:!0,label:"Account",name:"account",type:"account"}},14990:function(e,n,t){t.d(n,{Im:function(){return m},RQ:function(){return b},X4:function(){return h},fC:function(){return y},mW:function(){return p},ze:function(){return v}});var a=t(7297),r=t(75063);function o(){var e=(0,a.Z)(['\n  query GetTaxonomys(\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: Taxonomy_order_by!\n    $status: String = "active"\n    $type: String\n    $typeGroup: String\n    $parentId: Int\n    $fetchGroup: Boolean! = true\n    $id: Int\n    $isGroup: Boolean = false\n  ) {\n    taxonomy: Taxonomy(\n      limit: $limit\n      offset: $offset\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: $status }\n        type: { _eq: $type }\n        parentId: { _eq: $parentId }\n        id: { _eq: $id }\n        isGroup: { _eq: $isGroup }\n      }\n      order_by: [$orderBy]\n    ) {\n      options: Taxonomies(\n        where: {\n          type: { _eq: $type }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n\n        childs: Taxonomies(order_by: { id: asc }, where: { status: { _eq: "active" } }) {\n          taxonomyId: id\n          name\n          type\n          meta\n          status\n        }\n      }\n      id\n      name\n      type\n      status\n      parentId\n      createdAt\n      meta\n      parent: Parent {\n        id\n        name\n        type\n      }\n      childs: Taxonomies(order_by: { id: asc }, where: { status: { _eq: "active" } }) {\n        taxonomyId: id\n        name\n        type\n        meta\n        status\n      }\n      jobs: Taxonomy_Entities_aggregate(\n        where: { Taxonomy: { type: { _eq: "jobTags" } }, entity: { _eq: "Job" } }\n      ) {\n        aggregate {\n          count\n        }\n      }\n    }\n    meta: Taxonomy_aggregate(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: $status }\n        type: { _eq: $type }\n        parentId: { _eq: $parentId }\n        id: { _eq: $id }\n        isGroup: { _eq: $isGroup }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n    taxonomyGroup: Taxonomy(where: { isGroup: { _eq: true }, type: { _eq: $typeGroup } })\n      @include(if: $fetchGroup) {\n      value: id\n      text: name\n    }\n  }\n']);return o=function(){return e},e}function i(){var e=(0,a.Z)(["\n  query GetTaxonomy($id: Int!) {\n    taxonomy: Taxonomy_by_pk(id: $id) {\n      id\n      name\n      type\n      status\n      parentId\n      createdAt\n      meta\n    }\n  }\n"]);return i=function(){return e},e}function l(){var e=(0,a.Z)(["\n  mutation AddTaxonomy($objects: [Taxonomy_insert_input!]!) {\n    insert_Taxonomy(objects: $objects) {\n      returning {\n        id\n        type\n      }\n    }\n  }\n"]);return l=function(){return e},e}function s(){var e=(0,a.Z)(["\n  mutation UpdateTaxonomy($id: Int!, $changes: Taxonomy_set_input) {\n    update_Taxonomy_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n      type\n    }\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,a.Z)(["\n  query GeTaxonomyWithEntities($type: String!, $entity: String!, $entityId: Int!) {\n    questions: Taxonomy(where: { type: { _eq: $type } }) {\n      id\n      meta\n      name\n      status\n      taxonomy_entity: Taxonomy_Entities(\n        where: { entityId: { _eq: $entityId }, entity: { _eq: $entity } }\n      ) {\n        comments\n      }\n    }\n  }\n"]);return u=function(){return e},e}function c(){var e=(0,a.Z)(["\n  mutation InsertTaxonomyEntity(\n    $entity: String!\n    $entityId: Int!\n    $questions: [Taxonomy_Entity_insert_input!]!\n    $objectStatusLog: [StatusLog_insert_input!]!\n    $hasStatusLog: Boolean!\n  ) {\n    delete_Taxonomy_Entity(where: { entityId: { _eq: $entityId }, entity: { _eq: $entity } }) {\n      returning {\n        id\n      }\n    }\n    insert_Taxonomy_Entity(objects: $questions) {\n      returning {\n        id\n      }\n    }\n\n    insert_StatusLog(objects: $objectStatusLog) @include(if: $hasStatusLog) {\n      returning {\n        id\n      }\n    }\n  }\n"]);return c=function(){return e},e}function d(){var e=(0,a.Z)(["\n  query GetSlasForTemplate($where: SLA_bool_exp, $limit: Int, $offset: Int) {\n    slas: SLA(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      id\n      label: name\n      subtype\n      notes\n      onSite\n      onSiteUnit\n      quoteReturned\n      quoteReturnedUnit\n    }\n  }\n"]);return d=function(){return e},e}var m=(0,r.Ps)(o());(0,r.Ps)(i());var p=(0,r.Ps)(l()),v=(0,r.Ps)(s()),b=(0,r.Ps)(u()),y=(0,r.Ps)(c()),h=(0,r.Ps)(d())},20390:function(e,n,t){t.d(n,{l:function(){return v}});var a=t(26042),r=t(69396),o=t(99534),i=t(85893),l=t(67294),s=t(45697),u=t(6812),c=t(14990),d=t(49501),m=t(84043),p=function(e,n){var t,a,r,o=!0;return(null===(t=e.errors[e.name])||void 0===t?void 0:t.message)!==(null===(a=n.errors[n.name])||void 0===a?void 0:a.message)&&(o=!1),["name","type"].forEach(function(t){e[t]!==n[t]&&(o=!1)}),o},v=(0,l.memo)(function(e){var n,t,l,s=e.control,p=e.errors,v=e.label,b=e.name,y=e.register,h=e.type,x=e.filters,g=(0,o.Z)(e,["control","errors","label","name","register","type","filters"]),f=(l=(void 0===(t=(0,u.a)(c.Im,{variables:(0,r.Z)((0,a.Z)({isGroup:"assetCategory"===h},x),{orderBy:{name:"asc"},type:h})}).data)?{taxonomy:[]}:t).taxonomy,"assetCategory"===h?l.map(function(e){return{label:e.name,options:e.options,childs:e.childs,meta:e.meta}}):l.map(function(e){return{label:e.name,value:e.id,childs:e.childs,meta:e.meta}}));return(0,i.jsx)(d.Z,{id:b,label:void 0===v?"":v,children:(0,i.jsx)(m.Z,(0,a.Z)((0,r.Z)((0,a.Z)({},{control:s,errors:p,register:y}),{cacheOptions:!0,isClearable:!0,options:f,name:b}),g))})},p);v.propTypes={control:s.object.isRequired,errors:s.object.isRequired,label:s.string.isRequired,filters:s.object,type:(0,s.oneOf)(["assetCategory","expenseCategory","jobTags","costCategory","clientType","tags"])},v.defaultProps={filters:{}}},43724:function(e,n,t){t.d(n,{q:function(){return h}});var a=t(26042),r=t(69396),o=t(29815),i=t(85893),l=t(45697),s=t(9270),u=t(62140),c=t(49501),d=t(55563),m=t(70982),p=t(95103),v=t(15897),b=t(74944),y=t(53625),h=function(e){var n=e.errors,t=e.prefix,l=e.register,h=(0,b.x)().hasRole,x={errors:n,register:l};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(u.Z,{md:6,children:(0,i.jsx)(c.Z,{label:"First name",children:(0,i.jsx)(d.Z,(0,r.Z)((0,a.Z)({},x),{name:"".concat(t,"nameFirst")}))})}),(0,i.jsx)(u.Z,{md:6,children:(0,i.jsx)(c.Z,{label:"Last name",children:(0,i.jsx)(d.Z,(0,r.Z)((0,a.Z)({},x),{name:"".concat(t,"nameLast")}))})}),(0,i.jsx)(u.Z,{md:6,children:(0,i.jsxs)(c.Z,{label:"Email",children:[(0,i.jsx)(d.Z,(0,r.Z)((0,a.Z)({},x),{name:"".concat(t,"email"),type:"email"})),n["".concat(t,"email")]&&"duplicate"===n["".concat(t,"email")].type&&(0,i.jsx)(m.Z,{message:n["".concat(t,"email")].message})]})}),(0,i.jsx)(u.Z,{md:6,children:(0,i.jsx)(c.Z,{label:"Mobile",children:(0,i.jsx)(d.Z,(0,r.Z)((0,a.Z)({},x),{name:"".concat(t,"phone")}))})})]}),h((0,o.Z)(y.td).concat((0,o.Z)(y.Sf),(0,o.Z)(y.n),(0,o.Z)(y.nx)))&&(0,i.jsx)(c.Z,{label:"Status",children:(0,i.jsx)(p.Z,(0,r.Z)((0,a.Z)({},x),{name:"".concat(t,"status"),options:v.bg}))}),(0,i.jsx)(d.Z,(0,r.Z)((0,a.Z)({},x),{name:"".concat(t,"userId"),type:"hidden"}))]})};h.propTypes={errors:l.object.isRequired,prefix:l.string,register:l.func.isRequired},h.defaultProps={prefix:""}},49010:function(e,n,t){t.d(n,{b:function(){return a}});var a=function(e){return String(e).toLowerCase().replace("gb","").length>=9}},85568:function(e,n,t){t.d(n,{O:function(){return r},o:function(){return a}});var a=[{id:"quotes",label:"Quotes",value:"quotes"},{id:"cleverCalendar",label:"Planned Maintenance",value:"cleverCalendar"},{id:"assets",label:"Assets",value:"assets"},{id:"sensors",label:"IoT/Sensors",value:"sensors"},{id:"tasks",label:"Tasks",value:"tasks"},{id:"workflows",label:"Automated Workflows",value:"workflows"},{id:"sageIntegration",label:"Sage Integration",value:"sageIntegration"},{id:"dataReports",label:"Data Reports",value:"dataReports"},{id:"dataCharts",label:"Data Charts",value:"dataCharts"},{id:"nonLoggedUser",label:"Non logged user",value:"nonLoggedUser"}],r=[{value:"AverageDaysOutstandingChart",label:"Average Days Outstanding"},{value:"AverageJobLengthChart",label:"Average Job Length"},{value:"AverageJobRevenueChart",label:"Average Job Revenue"},{value:"SlaBreachCountChart",label:"SLA Breach (Count)"},{value:"SlaBreachPercentageChart",label:"SLA Breach (Percentage)"},{value:"AverageToCloseByHourChart",label:"Average Time To Close Job"},{value:"AvgPriceChart",label:"Average Price"},{value:"AverageProfitChart",label:"Average Profit"},{value:"AverageQuoteValueChart",label:"Average Quote Value"},{value:"AverageTimeToAcceptByMinuteChart",label:"Average Time To Accept Job"},{value:"AverageTimeToAttendanceChart",label:"Average Time To Attendance"},{value:"AverageTimeToSubmitJobReportChart",label:"Average Time To Submit Job Report"},{value:"CountByActiveAccountChart",label:"Count By Active Account"},{value:"CountJobsEngagementRateChart",label:"Count Jobs Engagement Rate"},{value:"CountOpenJobsByDateChart",label:"Count Open Jobs By Date"},{value:"CustomerAndSupplierAmounts",label:"Customer And Supplier Amounts"},{value:"JobsByDayLineChart",label:"Jobs By Day Line"},{value:"JobsByMonth",label:"Jobs By Month"},{value:"JobsFinancialByDayLineChart",label:"Jobs Financial By Day Line"},{value:"NewCustomerAccountsChart",label:"New Customer Accounts"},{value:"NewSupplierAccountsChart",label:"New Supplier Accounts"},{value:"PercentageOfWorkOrdersByServiceLineTable",label:"Percentage Of Work Orders By Service Line "},{value:"QuoteAcceptanceRateChart",label:"Quote Acceptance Rate"},{value:"SpendByCoverageAreaTable",label:"Spend By Coverage Area "},{value:"SpendFromNewCustomerAccountsChart",label:"Spend From New Customer Accounts"},{value:"SumQuoteAccepted",label:"Value of Quotes Accepted "},{value:"SumQuoteSent",label:"Value of quotations sent"},{value:"TopAssetsByNumberOfJobsTable",label:"Top Assets By Number Of Jobs"},{value:"TopAssetsBySpendTable",label:"Top Assets By Spend "},{value:"TopAssetTypesBySpendTable",label:"Top Asset Types By Spend "},{value:"TopCustomersByNumberOfPropertiesTable",label:"Top Customers By Number Of Properties"},{value:"TopCustomersByProfitChart",label:"Top Customers By Profit"},{value:"TopPropertiesBySpendTable",label:"Top Properties By Spend "},{value:"TopSuppliersByNumberOfJobsTable",label:"Top Suppliers By Number Of Jobs"},{value:"TopSuppliersByQuoteReturnTable",label:"Top Suppliers By Quote Return"},{value:"TopSuppliersByTimeToSubmitJobReportTable",label:"Top Suppliers By Time To Submit Job Report"},{value:"TotalJobRevenueChart",label:"Total Job Revenue"},{value:"TotalQuoteInvoiceSent",label:"Total Quote Invoice Sent"},{value:"TotalQuoteSentChart",label:"Number Of Quotes"},{value:"TotalQuoteReportSent",label:"Total Quote Report Sent"},{value:"TotalQuoteSent",label:"Total Quotes Sent"},{value:"WorstCustomersByAgedReceivablesTable",label:"Worst Customers By Aged Receivables"}]},73583:function(e,n,t){t.d(n,{d:function(){return l}});var a,r={ALL:["admin","customer","supplier","tenant"],ADMIN_ONLY:["admin"],CUSTOMER_ONLY:["customer"],SUPPLIER_ONLY:["supplier"],TENANT_ONLY:["tenant"],ADMIN_CUSTOMER:["admin","customer"],ADMIN_SUPPLIER:["admin","supplier"],ADMIN_TENANT:["admin","tenant"],ADMIN_CUSTOMER_TENANT:["admin","customer","tenant"],CUSTOMER_TENANT:["customer","tenant"]},o=[{label:"All",value:r.ALL},{label:"Admin + Supplier",value:r.ADMIN_SUPPLIER},{label:"Admin + Customer",value:r.ADMIN_CUSTOMER},{label:"Admin + Customer + Tenant",value:r.ADMIN_CUSTOMER_TENANT},{label:"Internal",value:r.ADMIN_ONLY}],i=[{label:"All",value:r.ALL},{label:"Admin + Customer",value:r.ADMIN_CUSTOMER},{label:"Admin + Customer + Tenant",value:r.ADMIN_CUSTOMER_TENANT},{label:"Customer + Tenant",value:r.CUSTOMER_TENANT},{label:"Internal",value:r.CUSTOMER_ONLY}],l={admin:o,customer:i,supplier:[{label:"All",value:r.ALL},{label:"Admin + Supplier",value:r.ADMIN_SUPPLIER},{label:"Internal",value:r.SUPPLIER_ONLY}],tenant:[{label:"All",value:r.ALL},{label:"Admin + Customer + Tenant",value:r.ADMIN_CUSTOMER_TENANT},{label:"Customer + Tenant",value:r.CUSTOMER_TENANT}]}},19664:function(e,n,t){t.d(n,{E:function(){return a}});var a=[{text:"Select Type Of Organisation",value:""},{text:"Sole trader",value:"soleTrader"},{text:"Limited company",value:"limitedCompany"},{text:"Partnership",value:"partnership"},{text:"LLP",value:"llp"},{text:"PLC",value:"plc"}]},15897:function(e,n,t){t.d(n,{bg:function(){return a}});var a=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}]}}]);